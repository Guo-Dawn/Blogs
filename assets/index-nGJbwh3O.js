const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BlogList-JSHCovhm.js","assets/mermaid-JKgtJoW5.js","assets/BlogList-BP85BDJD.css","assets/BlogPost-pkj7PhA8.js","assets/BlogPost-BriCYJkB.css","assets/About-fMsidJYd.js","assets/About-CY0gonp7.css"])))=>i.map(i=>d[i]);
import{am as vo,bC as Ru}from"./mermaid-JKgtJoW5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function eh(i){const e=Object.create(null);for(const t of i.split(","))e[t]=1;return t=>t in e}const Fe={},bs=[],Ei=()=>{},Gf=()=>!1,Al=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),th=i=>i.startsWith("onUpdate:"),it=Object.assign,ih=(i,e)=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)},sp=Object.prototype.hasOwnProperty,Ae=(i,e)=>sp.call(i,e),he=Array.isArray,As=i=>Ll(i)==="[object Map]",Vf=i=>Ll(i)==="[object Set]",ue=i=>typeof i=="function",Ze=i=>typeof i=="string",Qi=i=>typeof i=="symbol",Ge=i=>i!==null&&typeof i=="object",jf=i=>(Ge(i)||ue(i))&&ue(i.then)&&ue(i.catch),zf=Object.prototype.toString,Ll=i=>zf.call(i),rp=i=>Ll(i).slice(8,-1),Bf=i=>Ll(i)==="[object Object]",nh=i=>Ze(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,xr=eh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Pl=i=>{const e=Object.create(null);return(t=>e[t]||(e[t]=i(t)))},op=/-\w/g,Zt=Pl(i=>i.replace(op,e=>e.slice(1).toUpperCase())),lp=/\B([A-Z])/g,os=Pl(i=>i.replace(lp,"-$1").toLowerCase()),Ml=Pl(i=>i.charAt(0).toUpperCase()+i.slice(1)),Ca=Pl(i=>i?`on${Ml(i)}`:""),wn=(i,e)=>!Object.is(i,e),Uo=(i,...e)=>{for(let t=0;t<i.length;t++)i[t](...e)},Wf=(i,e,t,n=!1)=>{Object.defineProperty(i,e,{configurable:!0,enumerable:!1,writable:n,value:t})},sh=i=>{const e=parseFloat(i);return isNaN(e)?i:e},ap=i=>{const e=Ze(i)?Number(i):NaN;return isNaN(e)?i:e};let Tu;const Ol=()=>Tu||(Tu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Fl(i){if(he(i)){const e={};for(let t=0;t<i.length;t++){const n=i[t],s=Ze(n)?dp(n):Fl(n);if(s)for(const r in s)e[r]=s[r]}return e}else if(Ze(i)||Ge(i))return i}const cp=/;(?![^(]*\))/g,hp=/:([^]+)/,up=/\/\*[^]*?\*\//g;function dp(i){const e={};return i.replace(up,"").split(cp).forEach(t=>{if(t){const n=t.split(hp);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Qn(i){let e="";if(Ze(i))e=i;else if(he(i))for(let t=0;t<i.length;t++){const n=Qn(i[t]);n&&(e+=n+" ")}else if(Ge(i))for(const t in i)i[t]&&(e+=t+" ");return e.trim()}const fp="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gp=eh(fp);function Uf(i){return!!i||i===""}const Kf=i=>!!(i&&i.__v_isRef===!0),ji=i=>Ze(i)?i:i==null?"":he(i)||Ge(i)&&(i.toString===zf||!ue(i.toString))?Kf(i)?ji(i.value):JSON.stringify(i,Xf,2):String(i),Xf=(i,e)=>Kf(e)?Xf(i,e.value):As(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,s],r)=>(t[va(n,r)+" =>"]=s,t),{})}:Vf(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>va(t))}:Qi(e)?va(e):Ge(e)&&!he(e)&&!Bf(e)?String(e):e,va=(i,e="")=>{var t;return Qi(i)?`Symbol(${(t=i.description)!=null?t:e})`:i};let St;class mp{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=St,!e&&St&&(this.index=(St.scopes||(St.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=St;try{return St=this,e()}finally{St=t}}}on(){++this._on===1&&(this.prevScope=St,St=this)}off(){this._on>0&&--this._on===0&&(St=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function _p(){return St}let ke;const Ea=new WeakSet;class Hf{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,St&&St.active&&St.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ea.has(this)&&(Ea.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Zf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Su(this),$f(this);const e=ke,t=ti;ke=this,ti=!0;try{return this.fn()}finally{qf(this),ke=e,ti=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)lh(e);this.deps=this.depsTail=void 0,Su(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ea.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){fc(this)&&this.run()}get dirty(){return fc(this)}}let Yf=0,wr,Rr;function Zf(i,e=!1){if(i.flags|=8,e){i.next=Rr,Rr=i;return}i.next=wr,wr=i}function rh(){Yf++}function oh(){if(--Yf>0)return;if(Rr){let e=Rr;for(Rr=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let i;for(;wr;){let e=wr;for(wr=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){i||(i=n)}e=t}}if(i)throw i}function $f(i){for(let e=i.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function qf(i){let e,t=i.depsTail,n=t;for(;n;){const s=n.prevDep;n.version===-1?(n===t&&(t=s),lh(n),pp(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}i.deps=e,i.depsTail=t}function fc(i){for(let e=i.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Jf(e.dep.computed)||e.dep.version!==e.version))return!0;return!!i._dirty}function Jf(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===Mr)||(i.globalVersion=Mr,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!fc(i))))return;i.flags|=2;const e=i.dep,t=ke,n=ti;ke=i,ti=!0;try{$f(i);const s=i.fn(i._value);(e.version===0||wn(s,i._value))&&(i.flags|=128,i._value=s,e.version++)}catch(s){throw e.version++,s}finally{ke=t,ti=n,qf(i),i.flags&=-3}}function lh(i,e=!1){const{dep:t,prevSub:n,nextSub:s}=i;if(n&&(n.nextSub=s,i.prevSub=void 0),s&&(s.prevSub=n,i.nextSub=void 0),t.subs===i&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let r=t.computed.deps;r;r=r.nextDep)lh(r,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function pp(i){const{prevDep:e,nextDep:t}=i;e&&(e.nextDep=t,i.prevDep=void 0),t&&(t.prevDep=e,i.nextDep=void 0)}let ti=!0;const Qf=[];function Hi(){Qf.push(ti),ti=!1}function Yi(){const i=Qf.pop();ti=i===void 0?!0:i}function Su(i){const{cleanup:e}=i;if(i.cleanup=void 0,e){const t=ke;ke=void 0;try{e()}finally{ke=t}}}let Mr=0;class yp{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ah{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ke||!ti||ke===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==ke)t=this.activeLink=new yp(ke,this),ke.deps?(t.prevDep=ke.depsTail,ke.depsTail.nextDep=t,ke.depsTail=t):ke.deps=ke.depsTail=t,eg(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=ke.depsTail,t.nextDep=void 0,ke.depsTail.nextDep=t,ke.depsTail=t,ke.deps===t&&(ke.deps=n)}return t}trigger(e){this.version++,Mr++,this.notify(e)}notify(e){rh();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{oh()}}}function eg(i){if(i.dep.sc++,i.sub.flags&4){const e=i.dep.computed;if(e&&!i.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)eg(n)}const t=i.dep.subs;t!==i&&(i.prevSub=t,t&&(t.nextSub=i)),i.dep.subs=i}}const gc=new WeakMap,Zn=Symbol(""),mc=Symbol(""),Or=Symbol("");function dt(i,e,t){if(ti&&ke){let n=gc.get(i);n||gc.set(i,n=new Map);let s=n.get(t);s||(n.set(t,s=new ah),s.map=n,s.key=t),s.track()}}function Wi(i,e,t,n,s,r){const o=gc.get(i);if(!o){Mr++;return}const l=a=>{a&&a.trigger()};if(rh(),e==="clear")o.forEach(l);else{const a=he(i),h=a&&nh(t);if(a&&t==="length"){const c=Number(n);o.forEach((u,d)=>{(d==="length"||d===Or||!Qi(d)&&d>=c)&&l(u)})}else switch((t!==void 0||o.has(void 0))&&l(o.get(t)),h&&l(o.get(Or)),e){case"add":a?h&&l(o.get("length")):(l(o.get(Zn)),As(i)&&l(o.get(mc)));break;case"delete":a||(l(o.get(Zn)),As(i)&&l(o.get(mc)));break;case"set":As(i)&&l(o.get(Zn));break}}oh()}function cs(i){const e=Ie(i);return e===i?e:(dt(e,"iterate",Or),Ht(i)?e:e.map(ai))}function Dl(i){return dt(i=Ie(i),"iterate",Or),i}function dn(i,e){return Zi(i)?$n(i)?Ns(ai(e)):Ns(e):ai(e)}const Cp={__proto__:null,[Symbol.iterator](){return xa(this,Symbol.iterator,i=>dn(this,i))},concat(...i){return cs(this).concat(...i.map(e=>he(e)?cs(e):e))},entries(){return xa(this,"entries",i=>(i[1]=dn(this,i[1]),i))},every(i,e){return Mi(this,"every",i,e,void 0,arguments)},filter(i,e){return Mi(this,"filter",i,e,t=>t.map(n=>dn(this,n)),arguments)},find(i,e){return Mi(this,"find",i,e,t=>dn(this,t),arguments)},findIndex(i,e){return Mi(this,"findIndex",i,e,void 0,arguments)},findLast(i,e){return Mi(this,"findLast",i,e,t=>dn(this,t),arguments)},findLastIndex(i,e){return Mi(this,"findLastIndex",i,e,void 0,arguments)},forEach(i,e){return Mi(this,"forEach",i,e,void 0,arguments)},includes(...i){return wa(this,"includes",i)},indexOf(...i){return wa(this,"indexOf",i)},join(i){return cs(this).join(i)},lastIndexOf(...i){return wa(this,"lastIndexOf",i)},map(i,e){return Mi(this,"map",i,e,void 0,arguments)},pop(){return sr(this,"pop")},push(...i){return sr(this,"push",i)},reduce(i,...e){return Iu(this,"reduce",i,e)},reduceRight(i,...e){return Iu(this,"reduceRight",i,e)},shift(){return sr(this,"shift")},some(i,e){return Mi(this,"some",i,e,void 0,arguments)},splice(...i){return sr(this,"splice",i)},toReversed(){return cs(this).toReversed()},toSorted(i){return cs(this).toSorted(i)},toSpliced(...i){return cs(this).toSpliced(...i)},unshift(...i){return sr(this,"unshift",i)},values(){return xa(this,"values",i=>dn(this,i))}};function xa(i,e,t){const n=Dl(i),s=n[e]();return n!==i&&!Ht(i)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.done||(r.value=t(r.value)),r}),s}const vp=Array.prototype;function Mi(i,e,t,n,s,r){const o=Dl(i),l=o!==i&&!Ht(i),a=o[e];if(a!==vp[e]){const u=a.apply(i,r);return l?ai(u):u}let h=t;o!==i&&(l?h=function(u,d){return t.call(this,dn(i,u),d,i)}:t.length>2&&(h=function(u,d){return t.call(this,u,d,i)}));const c=a.call(o,h,n);return l&&s?s(c):c}function Iu(i,e,t,n){const s=Dl(i);let r=t;return s!==i&&(Ht(i)?t.length>3&&(r=function(o,l,a){return t.call(this,o,l,a,i)}):r=function(o,l,a){return t.call(this,o,dn(i,l),a,i)}),s[e](r,...n)}function wa(i,e,t){const n=Ie(i);dt(n,"iterate",Or);const s=n[e](...t);return(s===-1||s===!1)&&uh(t[0])?(t[0]=Ie(t[0]),n[e](...t)):s}function sr(i,e,t=[]){Hi(),rh();const n=Ie(i)[e].apply(i,t);return oh(),Yi(),n}const Ep=eh("__proto__,__v_isRef,__isVue"),tg=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(Qi));function xp(i){Qi(i)||(i=String(i));const e=Ie(this);return dt(e,"has",i),e.hasOwnProperty(i)}class ig{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,r=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return r;if(t==="__v_raw")return n===(s?r?Mp:og:r?rg:sg).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=he(e);if(!s){let a;if(o&&(a=Cp[t]))return a;if(t==="hasOwnProperty")return xp}const l=Reflect.get(e,t,mt(e)?e:n);if((Qi(t)?tg.has(t):Ep(t))||(s||dt(e,"get",t),r))return l;if(mt(l)){const a=o&&nh(t)?l:l.value;return s&&Ge(a)?pc(a):a}return Ge(l)?s?pc(l):kl(l):l}}class ng extends ig{constructor(e=!1){super(!1,e)}set(e,t,n,s){let r=e[t];const o=he(e)&&nh(t);if(!this._isShallow){const h=Zi(r);if(!Ht(n)&&!Zi(n)&&(r=Ie(r),n=Ie(n)),!o&&mt(r)&&!mt(n))return h||(r.value=n),!0}const l=o?Number(t)<e.length:Ae(e,t),a=Reflect.set(e,t,n,mt(e)?e:s);return e===Ie(s)&&(l?wn(n,r)&&Wi(e,"set",t,n):Wi(e,"add",t,n)),a}deleteProperty(e,t){const n=Ae(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&n&&Wi(e,"delete",t,void 0),s}has(e,t){const n=Reflect.has(e,t);return(!Qi(t)||!tg.has(t))&&dt(e,"has",t),n}ownKeys(e){return dt(e,"iterate",he(e)?"length":Zn),Reflect.ownKeys(e)}}class wp extends ig{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Rp=new ng,Tp=new wp,Sp=new ng(!0);const _c=i=>i,Eo=i=>Reflect.getPrototypeOf(i);function Ip(i,e,t){return function(...n){const s=this.__v_raw,r=Ie(s),o=As(r),l=i==="entries"||i===Symbol.iterator&&o,a=i==="keys"&&o,h=s[i](...n),c=t?_c:e?Ns:ai;return!e&&dt(r,"iterate",a?mc:Zn),{next(){const{value:u,done:d}=h.next();return d?{value:u,done:d}:{value:l?[c(u[0]),c(u[1])]:c(u),done:d}},[Symbol.iterator](){return this}}}}function xo(i){return function(...e){return i==="delete"?!1:i==="clear"?void 0:this}}function bp(i,e){const t={get(s){const r=this.__v_raw,o=Ie(r),l=Ie(s);i||(wn(s,l)&&dt(o,"get",s),dt(o,"get",l));const{has:a}=Eo(o),h=e?_c:i?Ns:ai;if(a.call(o,s))return h(r.get(s));if(a.call(o,l))return h(r.get(l));r!==o&&r.get(s)},get size(){const s=this.__v_raw;return!i&&dt(Ie(s),"iterate",Zn),s.size},has(s){const r=this.__v_raw,o=Ie(r),l=Ie(s);return i||(wn(s,l)&&dt(o,"has",s),dt(o,"has",l)),s===l?r.has(s):r.has(s)||r.has(l)},forEach(s,r){const o=this,l=o.__v_raw,a=Ie(l),h=e?_c:i?Ns:ai;return!i&&dt(a,"iterate",Zn),l.forEach((c,u)=>s.call(r,h(c),h(u),o))}};return it(t,i?{add:xo("add"),set:xo("set"),delete:xo("delete"),clear:xo("clear")}:{add(s){!e&&!Ht(s)&&!Zi(s)&&(s=Ie(s));const r=Ie(this);return Eo(r).has.call(r,s)||(r.add(s),Wi(r,"add",s,s)),this},set(s,r){!e&&!Ht(r)&&!Zi(r)&&(r=Ie(r));const o=Ie(this),{has:l,get:a}=Eo(o);let h=l.call(o,s);h||(s=Ie(s),h=l.call(o,s));const c=a.call(o,s);return o.set(s,r),h?wn(r,c)&&Wi(o,"set",s,r):Wi(o,"add",s,r),this},delete(s){const r=Ie(this),{has:o,get:l}=Eo(r);let a=o.call(r,s);a||(s=Ie(s),a=o.call(r,s)),l&&l.call(r,s);const h=r.delete(s);return a&&Wi(r,"delete",s,void 0),h},clear(){const s=Ie(this),r=s.size!==0,o=s.clear();return r&&Wi(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Ip(s,i,e)}),t}function ch(i,e){const t=bp(i,e);return(n,s,r)=>s==="__v_isReactive"?!i:s==="__v_isReadonly"?i:s==="__v_raw"?n:Reflect.get(Ae(t,s)&&s in n?t:n,s,r)}const Ap={get:ch(!1,!1)},Lp={get:ch(!1,!0)},Pp={get:ch(!0,!1)};const sg=new WeakMap,rg=new WeakMap,og=new WeakMap,Mp=new WeakMap;function Op(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Fp(i){return i.__v_skip||!Object.isExtensible(i)?0:Op(rp(i))}function kl(i){return Zi(i)?i:hh(i,!1,Rp,Ap,sg)}function lg(i){return hh(i,!1,Sp,Lp,rg)}function pc(i){return hh(i,!0,Tp,Pp,og)}function hh(i,e,t,n,s){if(!Ge(i)||i.__v_raw&&!(e&&i.__v_isReactive))return i;const r=Fp(i);if(r===0)return i;const o=s.get(i);if(o)return o;const l=new Proxy(i,r===2?n:t);return s.set(i,l),l}function $n(i){return Zi(i)?$n(i.__v_raw):!!(i&&i.__v_isReactive)}function Zi(i){return!!(i&&i.__v_isReadonly)}function Ht(i){return!!(i&&i.__v_isShallow)}function uh(i){return i?!!i.__v_raw:!1}function Ie(i){const e=i&&i.__v_raw;return e?Ie(e):i}function Dp(i){return!Ae(i,"__v_skip")&&Object.isExtensible(i)&&Wf(i,"__v_skip",!0),i}const ai=i=>Ge(i)?kl(i):i,Ns=i=>Ge(i)?pc(i):i;function mt(i){return i?i.__v_isRef===!0:!1}function rt(i){return ag(i,!1)}function kp(i){return ag(i,!0)}function ag(i,e){return mt(i)?i:new Np(i,e)}class Np{constructor(e,t){this.dep=new ah,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Ie(e),this._value=t?e:ai(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||Ht(e)||Zi(e);e=n?e:Ie(e),wn(e,t)&&(this._rawValue=e,this._value=n?e:ai(e),this.dep.trigger())}}function Xe(i){return mt(i)?i.value:i}const Gp={get:(i,e,t)=>e==="__v_raw"?i:Xe(Reflect.get(i,e,t)),set:(i,e,t,n)=>{const s=i[e];return mt(s)&&!mt(t)?(s.value=t,!0):Reflect.set(i,e,t,n)}};function cg(i){return $n(i)?i:new Proxy(i,Gp)}class Vp{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new ah(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Mr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&ke!==this)return Zf(this,!0),!0}get value(){const e=this.dep.track();return Jf(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function jp(i,e,t=!1){let n,s;return ue(i)?n=i:(n=i.get,s=i.set),new Vp(n,s,t)}const wo={},Jo=new WeakMap;let Vn;function zp(i,e=!1,t=Vn){if(t){let n=Jo.get(t);n||Jo.set(t,n=[]),n.push(i)}}function Bp(i,e,t=Fe){const{immediate:n,deep:s,once:r,scheduler:o,augmentJob:l,call:a}=t,h=C=>s?C:Ht(C)||s===!1||s===0?Ui(C,1):Ui(C);let c,u,d,f,g=!1,m=!1;if(mt(i)?(u=()=>i.value,g=Ht(i)):$n(i)?(u=()=>h(i),g=!0):he(i)?(m=!0,g=i.some(C=>$n(C)||Ht(C)),u=()=>i.map(C=>{if(mt(C))return C.value;if($n(C))return h(C);if(ue(C))return a?a(C,2):C()})):ue(i)?e?u=a?()=>a(i,2):i:u=()=>{if(d){Hi();try{d()}finally{Yi()}}const C=Vn;Vn=c;try{return a?a(i,3,[f]):i(f)}finally{Vn=C}}:u=Ei,e&&s){const C=u,x=s===!0?1/0:s;u=()=>Ui(C(),x)}const _=_p(),p=()=>{c.stop(),_&&_.active&&ih(_.effects,c)};if(r&&e){const C=e;e=(...x)=>{C(...x),p()}}let y=m?new Array(i.length).fill(wo):wo;const v=C=>{if(!(!(c.flags&1)||!c.dirty&&!C))if(e){const x=c.run();if(s||g||(m?x.some((T,I)=>wn(T,y[I])):wn(x,y))){d&&d();const T=Vn;Vn=c;try{const I=[x,y===wo?void 0:m&&y[0]===wo?[]:y,f];y=x,a?a(e,3,I):e(...I)}finally{Vn=T}}}else c.run()};return l&&l(v),c=new Hf(u),c.scheduler=o?()=>o(v,!1):v,f=C=>zp(C,!1,c),d=c.onStop=()=>{const C=Jo.get(c);if(C){if(a)a(C,4);else for(const x of C)x();Jo.delete(c)}},e?n?v(!0):y=c.run():o?o(v.bind(null,!0),!0):c.run(),p.pause=c.pause.bind(c),p.resume=c.resume.bind(c),p.stop=p,p}function Ui(i,e=1/0,t){if(e<=0||!Ge(i)||i.__v_skip||(t=t||new Map,(t.get(i)||0)>=e))return i;if(t.set(i,e),e--,mt(i))Ui(i.value,e,t);else if(he(i))for(let n=0;n<i.length;n++)Ui(i[n],e,t);else if(Vf(i)||As(i))i.forEach(n=>{Ui(n,e,t)});else if(Bf(i)){for(const n in i)Ui(i[n],e,t);for(const n of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,n)&&Ui(i[n],e,t)}return i}function to(i,e,t,n){try{return n?i(...n):i()}catch(s){io(s,e,t)}}function ci(i,e,t,n){if(ue(i)){const s=to(i,e,t,n);return s&&jf(s)&&s.catch(r=>{io(r,e,t)}),s}if(he(i)){const s=[];for(let r=0;r<i.length;r++)s.push(ci(i[r],e,t,n));return s}}function io(i,e,t,n=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Fe;if(e){let l=e.parent;const a=e.proxy,h=`https://vuejs.org/error-reference/#runtime-${t}`;for(;l;){const c=l.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](i,a,h)===!1)return}l=l.parent}if(r){Hi(),to(r,null,10,[i,a,h]),Yi();return}}Wp(i,t,s,n,o)}function Wp(i,e,t,n=!0,s=!1){if(s)throw i;console.error(i)}const Ct=[];let mi=-1;const Ls=[];let fn=null,ys=0;const hg=Promise.resolve();let Qo=null;function ug(i){const e=Qo||hg;return i?e.then(this?i.bind(this):i):e}function Up(i){let e=mi+1,t=Ct.length;for(;e<t;){const n=e+t>>>1,s=Ct[n],r=Fr(s);r<i||r===i&&s.flags&2?e=n+1:t=n}return e}function dh(i){if(!(i.flags&1)){const e=Fr(i),t=Ct[Ct.length-1];!t||!(i.flags&2)&&e>=Fr(t)?Ct.push(i):Ct.splice(Up(e),0,i),i.flags|=1,dg()}}function dg(){Qo||(Qo=hg.then(gg))}function Kp(i){he(i)?Ls.push(...i):fn&&i.id===-1?fn.splice(ys+1,0,i):i.flags&1||(Ls.push(i),i.flags|=1),dg()}function bu(i,e,t=mi+1){for(;t<Ct.length;t++){const n=Ct[t];if(n&&n.flags&2){if(i&&n.id!==i.uid)continue;Ct.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function fg(i){if(Ls.length){const e=[...new Set(Ls)].sort((t,n)=>Fr(t)-Fr(n));if(Ls.length=0,fn){fn.push(...e);return}for(fn=e,ys=0;ys<fn.length;ys++){const t=fn[ys];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}fn=null,ys=0}}const Fr=i=>i.id==null?i.flags&2?-1:1/0:i.id;function gg(i){try{for(mi=0;mi<Ct.length;mi++){const e=Ct[mi];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),to(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;mi<Ct.length;mi++){const e=Ct[mi];e&&(e.flags&=-2)}mi=-1,Ct.length=0,fg(),Qo=null,(Ct.length||Ls.length)&&gg()}}let lt=null,mg=null;function el(i){const e=lt;return lt=i,mg=i&&i.type.__scopeId||null,e}function Jt(i,e=lt,t){if(!e||i._n)return i;const n=(...s)=>{n._d&&nl(-1);const r=el(e);let o;try{o=i(...s)}finally{el(r),n._d&&nl(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Xp(i,e){if(lt===null)return i;const t=Bl(lt),n=i.dirs||(i.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,l,a=Fe]=e[s];r&&(ue(r)&&(r={mounted:r,updated:r}),r.deep&&Ui(o),n.push({dir:r,instance:t,value:o,oldValue:void 0,arg:l,modifiers:a}))}return i}function On(i,e,t,n){const s=i.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const l=s[o];r&&(l.oldValue=r[o].value);let a=l.dir[n];a&&(Hi(),ci(a,t,8,[i.el,l,i,e]),Yi())}}function Ko(i,e){if(ot){let t=ot.provides;const n=ot.parent&&ot.parent.provides;n===t&&(t=ot.provides=Object.create(n)),t[i]=e}}function ii(i,e,t=!1){const n=Xg();if(n||Ms){let s=Ms?Ms._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&i in s)return s[i];if(arguments.length>1)return t&&ue(e)?e.call(n&&n.proxy):e}}const Hp=Symbol.for("v-scx"),Yp=()=>ii(Hp);function ni(i,e,t){return _g(i,e,t)}function _g(i,e,t=Fe){const{immediate:n,deep:s,flush:r,once:o}=t,l=it({},t),a=e&&n||!e&&r!=="post";let h;if(Vs){if(r==="sync"){const f=Yp();h=f.__watcherHandles||(f.__watcherHandles=[])}else if(!a){const f=()=>{};return f.stop=Ei,f.resume=Ei,f.pause=Ei,f}}const c=ot;l.call=(f,g,m)=>ci(f,c,g,m);let u=!1;r==="post"?l.scheduler=f=>{Mt(f,c&&c.suspense)}:r!=="sync"&&(u=!0,l.scheduler=(f,g)=>{g?f():dh(f)}),l.augmentJob=f=>{e&&(f.flags|=4),u&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const d=Bp(i,e,l);return Vs&&(h?h.push(d):a&&d()),d}function Zp(i,e,t){const n=this.proxy,s=Ze(i)?i.includes(".")?pg(n,i):()=>n[i]:i.bind(n,n);let r;ue(e)?r=e:(r=e.handler,t=e);const o=so(this),l=_g(s,r.bind(n),t);return o(),l}function pg(i,e){const t=e.split(".");return()=>{let n=i;for(let s=0;s<t.length&&n;s++)n=n[t[s]];return n}}const $p=Symbol("_vte"),yg=i=>i.__isTeleport,zi=Symbol("_leaveCb"),Ro=Symbol("_enterCb");function qp(){const i={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Gl(()=>{i.isMounted=!0}),Tg(()=>{i.isUnmounting=!0}),i}const zt=[Function,Array],Cg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:zt,onEnter:zt,onAfterEnter:zt,onEnterCancelled:zt,onBeforeLeave:zt,onLeave:zt,onAfterLeave:zt,onLeaveCancelled:zt,onBeforeAppear:zt,onAppear:zt,onAfterAppear:zt,onAppearCancelled:zt},vg=i=>{const e=i.subTree;return e.component?vg(e.component):e},Jp={name:"BaseTransition",props:Cg,setup(i,{slots:e}){const t=Xg(),n=qp();return()=>{const s=e.default&&wg(e.default(),!0);if(!s||!s.length)return;const r=Eg(s),o=Ie(i),{mode:l}=o;if(n.isLeaving)return Ra(r);const a=Au(r);if(!a)return Ra(r);let h=yc(a,o,n,t,u=>h=u);a.type!==ft&&Dr(a,h);let c=t.subTree&&Au(t.subTree);if(c&&c.type!==ft&&!zn(c,a)&&vg(t).type!==ft){let u=yc(c,o,n,t);if(Dr(c,u),l==="out-in"&&a.type!==ft)return n.isLeaving=!0,u.afterLeave=()=>{n.isLeaving=!1,t.job.flags&8||t.update(),delete u.afterLeave,c=void 0},Ra(r);l==="in-out"&&a.type!==ft?u.delayLeave=(d,f,g)=>{const m=xg(n,c);m[String(c.key)]=c,d[zi]=()=>{f(),d[zi]=void 0,delete h.delayedLeave,c=void 0},h.delayedLeave=()=>{g(),delete h.delayedLeave,c=void 0}}:c=void 0}else c&&(c=void 0);return r}}};function Eg(i){let e=i[0];if(i.length>1){for(const t of i)if(t.type!==ft){e=t;break}}return e}const Qp=Jp;function xg(i,e){const{leavingVNodes:t}=i;let n=t.get(e.type);return n||(n=Object.create(null),t.set(e.type,n)),n}function yc(i,e,t,n,s){const{appear:r,mode:o,persisted:l=!1,onBeforeEnter:a,onEnter:h,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:f,onAfterLeave:g,onLeaveCancelled:m,onBeforeAppear:_,onAppear:p,onAfterAppear:y,onAppearCancelled:v}=e,C=String(i.key),x=xg(t,i),T=(b,G)=>{b&&ci(b,n,9,G)},I=(b,G)=>{const W=G[1];T(b,G),he(b)?b.every(A=>A.length<=1)&&W():b.length<=1&&W()},L={mode:o,persisted:l,beforeEnter(b){let G=a;if(!t.isMounted)if(r)G=_||a;else return;b[zi]&&b[zi](!0);const W=x[C];W&&zn(i,W)&&W.el[zi]&&W.el[zi](),T(G,[b])},enter(b){let G=h,W=c,A=u;if(!t.isMounted)if(r)G=p||h,W=y||c,A=v||u;else return;let S=!1;const O=b[Ro]=U=>{S||(S=!0,U?T(A,[b]):T(W,[b]),L.delayedLeave&&L.delayedLeave(),b[Ro]=void 0)};G?I(G,[b,O]):O()},leave(b,G){const W=String(i.key);if(b[Ro]&&b[Ro](!0),t.isUnmounting)return G();T(d,[b]);let A=!1;const S=b[zi]=O=>{A||(A=!0,G(),O?T(m,[b]):T(g,[b]),b[zi]=void 0,x[W]===i&&delete x[W])};x[W]=i,f?I(f,[b,S]):S()},clone(b){const G=yc(b,e,t,n,s);return s&&s(G),G}};return L}function Ra(i){if(no(i))return i=Tn(i),i.children=null,i}function Au(i){if(!no(i))return yg(i.type)&&i.children?Eg(i.children):i;if(i.component)return i.component.subTree;const{shapeFlag:e,children:t}=i;if(t){if(e&16)return t[0];if(e&32&&ue(t.default))return t.default()}}function Dr(i,e){i.shapeFlag&6&&i.component?(i.transition=e,Dr(i.component.subTree,e)):i.shapeFlag&128?(i.ssContent.transition=e.clone(i.ssContent),i.ssFallback.transition=e.clone(i.ssFallback)):i.transition=e}function wg(i,e=!1,t){let n=[],s=0;for(let r=0;r<i.length;r++){let o=i[r];const l=t==null?o.key:String(t)+String(o.key!=null?o.key:r);o.type===He?(o.patchFlag&128&&s++,n=n.concat(wg(o.children,e,l))):(e||o.type!==ft)&&n.push(l!=null?Tn(o,{key:l}):o)}if(s>1)for(let r=0;r<n.length;r++)n[r].patchFlag=-2;return n}function fh(i,e){return ue(i)?it({name:i.name},e,{setup:i}):i}function gh(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const tl=new WeakMap;function Tr(i,e,t,n,s=!1){if(he(i)){i.forEach((g,m)=>Tr(g,e&&(he(e)?e[m]:e),t,n,s));return}if(Ps(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Tr(i,e,t,n.component.subTree);return}const r=n.shapeFlag&4?Bl(n.component):n.el,o=s?null:r,{i:l,r:a}=i,h=e&&e.r,c=l.refs===Fe?l.refs={}:l.refs,u=l.setupState,d=Ie(u),f=u===Fe?Gf:g=>Ae(d,g);if(h!=null&&h!==a){if(Lu(e),Ze(h))c[h]=null,f(h)&&(u[h]=null);else if(mt(h)){h.value=null;const g=e;g.k&&(c[g.k]=null)}}if(ue(a))to(a,l,12,[o,c]);else{const g=Ze(a),m=mt(a);if(g||m){const _=()=>{if(i.f){const p=g?f(a)?u[a]:c[a]:a.value;if(s)he(p)&&ih(p,r);else if(he(p))p.includes(r)||p.push(r);else if(g)c[a]=[r],f(a)&&(u[a]=c[a]);else{const y=[r];a.value=y,i.k&&(c[i.k]=y)}}else g?(c[a]=o,f(a)&&(u[a]=o)):m&&(a.value=o,i.k&&(c[i.k]=o))};if(o){const p=()=>{_(),tl.delete(i)};p.id=-1,tl.set(i,p),Mt(p,t)}else Lu(i),_()}}}function Lu(i){const e=tl.get(i);e&&(e.flags|=8,tl.delete(i))}const Pu=i=>i.nodeType===8;Ol().requestIdleCallback;Ol().cancelIdleCallback;function ey(i,e){if(Pu(i)&&i.data==="["){let t=1,n=i.nextSibling;for(;n;){if(n.nodeType===1){if(e(n)===!1)break}else if(Pu(n))if(n.data==="]"){if(--t===0)break}else n.data==="["&&t++;n=n.nextSibling}}else e(i)}const Ps=i=>!!i.type.__asyncLoader;function bT(i){ue(i)&&(i={loader:i});const{loader:e,loadingComponent:t,errorComponent:n,delay:s=200,hydrate:r,timeout:o,suspensible:l=!0,onError:a}=i;let h=null,c,u=0;const d=()=>(u++,h=null,f()),f=()=>{let g;return h||(g=h=e().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),a)return new Promise((_,p)=>{a(m,()=>_(d()),()=>p(m),u+1)});throw m}).then(m=>g!==h&&h?h:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return fh({name:"AsyncComponentWrapper",__asyncLoader:f,__asyncHydrate(g,m,_){let p=!1;(m.bu||(m.bu=[])).push(()=>p=!0);const y=()=>{p||_()},v=r?()=>{const C=r(y,x=>ey(g,x));C&&(m.bum||(m.bum=[])).push(C)}:y;c?v():f().then(()=>!m.isUnmounted&&v())},get __asyncResolved(){return c},setup(){const g=ot;if(gh(g),c)return()=>To(c,g);const m=v=>{h=null,io(v,g,13,!n)};if(l&&g.suspense||Vs)return f().then(v=>()=>To(v,g)).catch(v=>(m(v),()=>n?Ve(n,{error:v}):null));const _=rt(!1),p=rt(),y=rt(!!s);return s&&setTimeout(()=>{y.value=!1},s),o!=null&&setTimeout(()=>{if(!_.value&&!p.value){const v=new Error(`Async component timed out after ${o}ms.`);m(v),p.value=v}},o),f().then(()=>{_.value=!0,g.parent&&no(g.parent.vnode)&&g.parent.update()}).catch(v=>{m(v),p.value=v}),()=>{if(_.value&&c)return To(c,g);if(p.value&&n)return Ve(n,{error:p.value});if(t&&!y.value)return To(t,g)}}})}function To(i,e){const{ref:t,props:n,children:s,ce:r}=e.vnode,o=Ve(i,n,s);return o.ref=t,o.ce=r,delete e.vnode.ce,o}const no=i=>i.type.__isKeepAlive;function ty(i,e){Rg(i,"a",e)}function iy(i,e){Rg(i,"da",e)}function Rg(i,e,t=ot){const n=i.__wdc||(i.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return i()});if(Nl(e,n,t),t){let s=t.parent;for(;s&&s.parent;)no(s.parent.vnode)&&ny(n,e,t,s),s=s.parent}}function ny(i,e,t,n){const s=Nl(e,i,n,!0);Vl(()=>{ih(n[e],s)},t)}function Nl(i,e,t=ot,n=!1){if(t){const s=t[i]||(t[i]=[]),r=e.__weh||(e.__weh=(...o)=>{Hi();const l=so(t),a=ci(e,t,i,o);return l(),Yi(),a});return n?s.unshift(r):s.push(r),r}}const en=i=>(e,t=ot)=>{(!Vs||i==="sp")&&Nl(i,(...n)=>e(...n),t)},sy=en("bm"),Gl=en("m"),ry=en("bu"),oy=en("u"),Tg=en("bum"),Vl=en("um"),ly=en("sp"),ay=en("rtg"),cy=en("rtc");function hy(i,e=ot){Nl("ec",i,e)}const uy="components";function mh(i,e){return fy(uy,i,!0,e)||i}const dy=Symbol.for("v-ndc");function fy(i,e,t=!0,n=!1){const s=lt||ot;if(s){const r=s.type;{const l=Jy(r,!1);if(l&&(l===e||l===Zt(e)||l===Ml(Zt(e))))return r}const o=Mu(s[i]||r[i],e)||Mu(s.appContext[i],e);return!o&&n?r:o}}function Mu(i,e){return i&&(i[e]||i[Zt(e)]||i[Ml(Zt(e))])}function So(i,e,t,n){let s;const r=t,o=he(i);if(o||Ze(i)){const l=o&&$n(i);let a=!1,h=!1;l&&(a=!Ht(i),h=Zi(i),i=Dl(i)),s=new Array(i.length);for(let c=0,u=i.length;c<u;c++)s[c]=e(a?h?Ns(ai(i[c])):ai(i[c]):i[c],c,void 0,r)}else if(typeof i=="number"){s=new Array(i);for(let l=0;l<i;l++)s[l]=e(l+1,l,void 0,r)}else if(Ge(i))if(i[Symbol.iterator])s=Array.from(i,(l,a)=>e(l,a,void 0,r));else{const l=Object.keys(i);s=new Array(l.length);for(let a=0,h=l.length;a<h;a++){const c=l[a];s[a]=e(i[c],c,a,r)}}else s=[];return s}function gy(i,e,t={},n,s){if(lt.ce||lt.parent&&Ps(lt.parent)&&lt.parent.ce){const h=Object.keys(t).length>0;return t.name=e,pe(),si(He,null,[Ve("slot",t,n&&n())],h?-2:64)}let r=i[e];r&&r._c&&(r._d=!1),pe();const o=r&&Sg(r(t)),l=t.key||o&&o.key,a=si(He,{key:(l&&!Qi(l)?l:`_${e}`)+(!o&&n?"_fb":"")},o||(n?n():[]),o&&i._===1?64:-2);return r&&r._c&&(r._d=!0),a}function Sg(i){return i.some(e=>Nr(e)?!(e.type===ft||e.type===He&&!Sg(e.children)):!0)?i:null}const Cc=i=>i?Hg(i)?Bl(i):Cc(i.parent):null,Sr=it(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Cc(i.parent),$root:i=>Cc(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>bg(i),$forceUpdate:i=>i.f||(i.f=()=>{dh(i.update)}),$nextTick:i=>i.n||(i.n=ug.bind(i.proxy)),$watch:i=>Zp.bind(i)}),Ta=(i,e)=>i!==Fe&&!i.__isScriptSetup&&Ae(i,e),my={get({_:i},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:s,props:r,accessCache:o,type:l,appContext:a}=i;if(e[0]!=="$"){const d=o[e];if(d!==void 0)switch(d){case 1:return n[e];case 2:return s[e];case 4:return t[e];case 3:return r[e]}else{if(Ta(n,e))return o[e]=1,n[e];if(s!==Fe&&Ae(s,e))return o[e]=2,s[e];if(Ae(r,e))return o[e]=3,r[e];if(t!==Fe&&Ae(t,e))return o[e]=4,t[e];vc&&(o[e]=0)}}const h=Sr[e];let c,u;if(h)return e==="$attrs"&&dt(i.attrs,"get",""),h(i);if((c=l.__cssModules)&&(c=c[e]))return c;if(t!==Fe&&Ae(t,e))return o[e]=4,t[e];if(u=a.config.globalProperties,Ae(u,e))return u[e]},set({_:i},e,t){const{data:n,setupState:s,ctx:r}=i;return Ta(s,e)?(s[e]=t,!0):n!==Fe&&Ae(n,e)?(n[e]=t,!0):Ae(i.props,e)||e[0]==="$"&&e.slice(1)in i?!1:(r[e]=t,!0)},has({_:{data:i,setupState:e,accessCache:t,ctx:n,appContext:s,props:r,type:o}},l){let a;return!!(t[l]||i!==Fe&&l[0]!=="$"&&Ae(i,l)||Ta(e,l)||Ae(r,l)||Ae(n,l)||Ae(Sr,l)||Ae(s.config.globalProperties,l)||(a=o.__cssModules)&&a[l])},defineProperty(i,e,t){return t.get!=null?i._.accessCache[e]=0:Ae(t,"value")&&this.set(i,e,t.value,null),Reflect.defineProperty(i,e,t)}};function Ou(i){return he(i)?i.reduce((e,t)=>(e[t]=null,e),{}):i}let vc=!0;function _y(i){const e=bg(i),t=i.proxy,n=i.ctx;vc=!1,e.beforeCreate&&Fu(e.beforeCreate,i,"bc");const{data:s,computed:r,methods:o,watch:l,provide:a,inject:h,created:c,beforeMount:u,mounted:d,beforeUpdate:f,updated:g,activated:m,deactivated:_,beforeDestroy:p,beforeUnmount:y,destroyed:v,unmounted:C,render:x,renderTracked:T,renderTriggered:I,errorCaptured:L,serverPrefetch:b,expose:G,inheritAttrs:W,components:A,directives:S,filters:O}=e;if(h&&py(h,n,null),o)for(const z in o){const V=o[z];ue(V)&&(n[z]=V.bind(t))}if(s){const z=s.call(t,t);Ge(z)&&(i.data=kl(z))}if(vc=!0,r)for(const z in r){const V=r[z],J=ue(V)?V.bind(t,t):ue(V.get)?V.get.bind(t,t):Ei,se=!ue(V)&&ue(V.set)?V.set.bind(t):Ei,ae=xt({get:J,set:se});Object.defineProperty(n,z,{enumerable:!0,configurable:!0,get:()=>ae.value,set:j=>ae.value=j})}if(l)for(const z in l)Ig(l[z],n,t,z);if(a){const z=ue(a)?a.call(t):a;Reflect.ownKeys(z).forEach(V=>{Ko(V,z[V])})}c&&Fu(c,i,"c");function N(z,V){he(V)?V.forEach(J=>z(J.bind(t))):V&&z(V.bind(t))}if(N(sy,u),N(Gl,d),N(ry,f),N(oy,g),N(ty,m),N(iy,_),N(hy,L),N(cy,T),N(ay,I),N(Tg,y),N(Vl,C),N(ly,b),he(G))if(G.length){const z=i.exposed||(i.exposed={});G.forEach(V=>{Object.defineProperty(z,V,{get:()=>t[V],set:J=>t[V]=J,enumerable:!0})})}else i.exposed||(i.exposed={});x&&i.render===Ei&&(i.render=x),W!=null&&(i.inheritAttrs=W),A&&(i.components=A),S&&(i.directives=S),b&&gh(i)}function py(i,e,t=Ei){he(i)&&(i=Ec(i));for(const n in i){const s=i[n];let r;Ge(s)?"default"in s?r=ii(s.from||n,s.default,!0):r=ii(s.from||n):r=ii(s),mt(r)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[n]=r}}function Fu(i,e,t){ci(he(i)?i.map(n=>n.bind(e.proxy)):i.bind(e.proxy),e,t)}function Ig(i,e,t,n){let s=n.includes(".")?pg(t,n):()=>t[n];if(Ze(i)){const r=e[i];ue(r)&&ni(s,r)}else if(ue(i))ni(s,i.bind(t));else if(Ge(i))if(he(i))i.forEach(r=>Ig(r,e,t,n));else{const r=ue(i.handler)?i.handler.bind(t):e[i.handler];ue(r)&&ni(s,r,i)}}function bg(i){const e=i.type,{mixins:t,extends:n}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=i.appContext,l=r.get(e);let a;return l?a=l:!s.length&&!t&&!n?a=e:(a={},s.length&&s.forEach(h=>il(a,h,o,!0)),il(a,e,o)),Ge(e)&&r.set(e,a),a}function il(i,e,t,n=!1){const{mixins:s,extends:r}=e;r&&il(i,r,t,!0),s&&s.forEach(o=>il(i,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const l=yy[o]||t&&t[o];i[o]=l?l(i[o],e[o]):e[o]}return i}const yy={data:Du,props:ku,emits:ku,methods:mr,computed:mr,beforeCreate:pt,created:pt,beforeMount:pt,mounted:pt,beforeUpdate:pt,updated:pt,beforeDestroy:pt,beforeUnmount:pt,destroyed:pt,unmounted:pt,activated:pt,deactivated:pt,errorCaptured:pt,serverPrefetch:pt,components:mr,directives:mr,watch:vy,provide:Du,inject:Cy};function Du(i,e){return e?i?function(){return it(ue(i)?i.call(this,this):i,ue(e)?e.call(this,this):e)}:e:i}function Cy(i,e){return mr(Ec(i),Ec(e))}function Ec(i){if(he(i)){const e={};for(let t=0;t<i.length;t++)e[i[t]]=i[t];return e}return i}function pt(i,e){return i?[...new Set([].concat(i,e))]:e}function mr(i,e){return i?it(Object.create(null),i,e):e}function ku(i,e){return i?he(i)&&he(e)?[...new Set([...i,...e])]:it(Object.create(null),Ou(i),Ou(e??{})):e}function vy(i,e){if(!i)return e;if(!e)return i;const t=it(Object.create(null),i);for(const n in e)t[n]=pt(i[n],e[n]);return t}function Ag(){return{app:null,config:{isNativeTag:Gf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ey=0;function xy(i,e){return function(n,s=null){ue(n)||(n=it({},n)),s!=null&&!Ge(s)&&(s=null);const r=Ag(),o=new WeakSet,l=[];let a=!1;const h=r.app={_uid:Ey++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:e0,get config(){return r.config},set config(c){},use(c,...u){return o.has(c)||(c&&ue(c.install)?(o.add(c),c.install(h,...u)):ue(c)&&(o.add(c),c(h,...u))),h},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),h},component(c,u){return u?(r.components[c]=u,h):r.components[c]},directive(c,u){return u?(r.directives[c]=u,h):r.directives[c]},mount(c,u,d){if(!a){const f=h._ceVNode||Ve(n,s);return f.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),i(f,c,d),a=!0,h._container=c,c.__vue_app__=h,Bl(f.component)}},onUnmount(c){l.push(c)},unmount(){a&&(ci(l,h._instance,16),i(null,h._container),delete h._container.__vue_app__)},provide(c,u){return r.provides[c]=u,h},runWithContext(c){const u=Ms;Ms=h;try{return c()}finally{Ms=u}}};return h}}let Ms=null;const wy=(i,e)=>e==="modelValue"||e==="model-value"?i.modelModifiers:i[`${e}Modifiers`]||i[`${Zt(e)}Modifiers`]||i[`${os(e)}Modifiers`];function Ry(i,e,...t){if(i.isUnmounted)return;const n=i.vnode.props||Fe;let s=t;const r=e.startsWith("update:"),o=r&&wy(n,e.slice(7));o&&(o.trim&&(s=t.map(c=>Ze(c)?c.trim():c)),o.number&&(s=t.map(sh)));let l,a=n[l=Ca(e)]||n[l=Ca(Zt(e))];!a&&r&&(a=n[l=Ca(os(e))]),a&&ci(a,i,6,s);const h=n[l+"Once"];if(h){if(!i.emitted)i.emitted={};else if(i.emitted[l])return;i.emitted[l]=!0,ci(h,i,6,s)}}const Ty=new WeakMap;function Lg(i,e,t=!1){const n=t?Ty:e.emitsCache,s=n.get(i);if(s!==void 0)return s;const r=i.emits;let o={},l=!1;if(!ue(i)){const a=h=>{const c=Lg(h,e,!0);c&&(l=!0,it(o,c))};!t&&e.mixins.length&&e.mixins.forEach(a),i.extends&&a(i.extends),i.mixins&&i.mixins.forEach(a)}return!r&&!l?(Ge(i)&&n.set(i,null),null):(he(r)?r.forEach(a=>o[a]=null):it(o,r),Ge(i)&&n.set(i,o),o)}function jl(i,e){return!i||!Al(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ae(i,e[0].toLowerCase()+e.slice(1))||Ae(i,os(e))||Ae(i,e))}function Nu(i){const{type:e,vnode:t,proxy:n,withProxy:s,propsOptions:[r],slots:o,attrs:l,emit:a,render:h,renderCache:c,props:u,data:d,setupState:f,ctx:g,inheritAttrs:m}=i,_=el(i);let p,y;try{if(t.shapeFlag&4){const C=s||n,x=C;p=_i(h.call(x,C,c,u,f,d,g)),y=l}else{const C=e;p=_i(C.length>1?C(u,{attrs:l,slots:o,emit:a}):C(u,null)),y=e.props?l:Sy(l)}}catch(C){Ir.length=0,io(C,i,1),p=Ve(ft)}let v=p;if(y&&m!==!1){const C=Object.keys(y),{shapeFlag:x}=v;C.length&&x&7&&(r&&C.some(th)&&(y=Iy(y,r)),v=Tn(v,y,!1,!0))}return t.dirs&&(v=Tn(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(t.dirs):t.dirs),t.transition&&Dr(v,t.transition),p=v,el(_),p}const Sy=i=>{let e;for(const t in i)(t==="class"||t==="style"||Al(t))&&((e||(e={}))[t]=i[t]);return e},Iy=(i,e)=>{const t={};for(const n in i)(!th(n)||!(n.slice(9)in e))&&(t[n]=i[n]);return t};function by(i,e,t){const{props:n,children:s,component:r}=i,{props:o,children:l,patchFlag:a}=e,h=r.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&a>=0){if(a&1024)return!0;if(a&16)return n?Gu(n,o,h):!!o;if(a&8){const c=e.dynamicProps;for(let u=0;u<c.length;u++){const d=c[u];if(o[d]!==n[d]&&!jl(h,d))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:n===o?!1:n?o?Gu(n,o,h):!0:!!o;return!1}function Gu(i,e,t){const n=Object.keys(e);if(n.length!==Object.keys(i).length)return!0;for(let s=0;s<n.length;s++){const r=n[s];if(e[r]!==i[r]&&!jl(t,r))return!0}return!1}function Ay({vnode:i,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===i&&(n.el=i.el),n===i)(i=e.vnode).el=t,e=e.parent;else break}}const Pg={},Mg=()=>Object.create(Pg),Og=i=>Object.getPrototypeOf(i)===Pg;function Ly(i,e,t,n=!1){const s={},r=Mg();i.propsDefaults=Object.create(null),Fg(i,e,s,r);for(const o in i.propsOptions[0])o in s||(s[o]=void 0);t?i.props=n?s:lg(s):i.type.props?i.props=s:i.props=r,i.attrs=r}function Py(i,e,t,n){const{props:s,attrs:r,vnode:{patchFlag:o}}=i,l=Ie(s),[a]=i.propsOptions;let h=!1;if((n||o>0)&&!(o&16)){if(o&8){const c=i.vnode.dynamicProps;for(let u=0;u<c.length;u++){let d=c[u];if(jl(i.emitsOptions,d))continue;const f=e[d];if(a)if(Ae(r,d))f!==r[d]&&(r[d]=f,h=!0);else{const g=Zt(d);s[g]=xc(a,l,g,f,i,!1)}else f!==r[d]&&(r[d]=f,h=!0)}}}else{Fg(i,e,s,r)&&(h=!0);let c;for(const u in l)(!e||!Ae(e,u)&&((c=os(u))===u||!Ae(e,c)))&&(a?t&&(t[u]!==void 0||t[c]!==void 0)&&(s[u]=xc(a,l,u,void 0,i,!0)):delete s[u]);if(r!==l)for(const u in r)(!e||!Ae(e,u))&&(delete r[u],h=!0)}h&&Wi(i.attrs,"set","")}function Fg(i,e,t,n){const[s,r]=i.propsOptions;let o=!1,l;if(e)for(let a in e){if(xr(a))continue;const h=e[a];let c;s&&Ae(s,c=Zt(a))?!r||!r.includes(c)?t[c]=h:(l||(l={}))[c]=h:jl(i.emitsOptions,a)||(!(a in n)||h!==n[a])&&(n[a]=h,o=!0)}if(r){const a=Ie(t),h=l||Fe;for(let c=0;c<r.length;c++){const u=r[c];t[u]=xc(s,a,u,h[u],i,!Ae(h,u))}}return o}function xc(i,e,t,n,s,r){const o=i[t];if(o!=null){const l=Ae(o,"default");if(l&&n===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&ue(a)){const{propsDefaults:h}=s;if(t in h)n=h[t];else{const c=so(s);n=h[t]=a.call(null,e),c()}}else n=a;s.ce&&s.ce._setProp(t,n)}o[0]&&(r&&!l?n=!1:o[1]&&(n===""||n===os(t))&&(n=!0))}return n}const My=new WeakMap;function Dg(i,e,t=!1){const n=t?My:e.propsCache,s=n.get(i);if(s)return s;const r=i.props,o={},l=[];let a=!1;if(!ue(i)){const c=u=>{a=!0;const[d,f]=Dg(u,e,!0);it(o,d),f&&l.push(...f)};!t&&e.mixins.length&&e.mixins.forEach(c),i.extends&&c(i.extends),i.mixins&&i.mixins.forEach(c)}if(!r&&!a)return Ge(i)&&n.set(i,bs),bs;if(he(r))for(let c=0;c<r.length;c++){const u=Zt(r[c]);Vu(u)&&(o[u]=Fe)}else if(r)for(const c in r){const u=Zt(c);if(Vu(u)){const d=r[c],f=o[u]=he(d)||ue(d)?{type:d}:it({},d),g=f.type;let m=!1,_=!0;if(he(g))for(let p=0;p<g.length;++p){const y=g[p],v=ue(y)&&y.name;if(v==="Boolean"){m=!0;break}else v==="String"&&(_=!1)}else m=ue(g)&&g.name==="Boolean";f[0]=m,f[1]=_,(m||Ae(f,"default"))&&l.push(u)}}const h=[o,l];return Ge(i)&&n.set(i,h),h}function Vu(i){return i[0]!=="$"&&!xr(i)}const _h=i=>i==="_"||i==="_ctx"||i==="$stable",ph=i=>he(i)?i.map(_i):[_i(i)],Oy=(i,e,t)=>{if(e._n)return e;const n=Jt((...s)=>ph(e(...s)),t);return n._c=!1,n},kg=(i,e,t)=>{const n=i._ctx;for(const s in i){if(_h(s))continue;const r=i[s];if(ue(r))e[s]=Oy(s,r,n);else if(r!=null){const o=ph(r);e[s]=()=>o}}},Ng=(i,e)=>{const t=ph(e);i.slots.default=()=>t},Gg=(i,e,t)=>{for(const n in e)(t||!_h(n))&&(i[n]=e[n])},Fy=(i,e,t)=>{const n=i.slots=Mg();if(i.vnode.shapeFlag&32){const s=e._;s?(Gg(n,e,t),t&&Wf(n,"_",s,!0)):kg(e,n)}else e&&Ng(i,e)},Dy=(i,e,t)=>{const{vnode:n,slots:s}=i;let r=!0,o=Fe;if(n.shapeFlag&32){const l=e._;l?t&&l===1?r=!1:Gg(s,e,t):(r=!e.$stable,kg(e,s)),o=e}else e&&(Ng(i,e),o={default:1});if(r)for(const l in s)!_h(l)&&o[l]==null&&delete s[l]},Mt=jy;function ky(i){return Ny(i)}function Ny(i,e){const t=Ol();t.__VUE__=!0;const{insert:n,remove:s,patchProp:r,createElement:o,createText:l,createComment:a,setText:h,setElementText:c,parentNode:u,nextSibling:d,setScopeId:f=Ei,insertStaticContent:g}=i,m=(E,w,R,M=null,k=null,F=null,Z=void 0,H=null,K=!!w.dynamicChildren)=>{if(E===w)return;E&&!zn(E,w)&&(M=P(E),j(E,k,F,!0),E=null),w.patchFlag===-2&&(K=!1,w.dynamicChildren=null);const{type:B,ref:ie,shapeFlag:X}=w;switch(B){case zl:_(E,w,R,M);break;case ft:p(E,w,R,M);break;case Xo:E==null&&y(w,R,M,Z);break;case He:A(E,w,R,M,k,F,Z,H,K);break;default:X&1?x(E,w,R,M,k,F,Z,H,K):X&6?S(E,w,R,M,k,F,Z,H,K):(X&64||X&128)&&B.process(E,w,R,M,k,F,Z,H,K,Q)}ie!=null&&k?Tr(ie,E&&E.ref,F,w||E,!w):ie==null&&E&&E.ref!=null&&Tr(E.ref,null,F,E,!0)},_=(E,w,R,M)=>{if(E==null)n(w.el=l(w.children),R,M);else{const k=w.el=E.el;w.children!==E.children&&h(k,w.children)}},p=(E,w,R,M)=>{E==null?n(w.el=a(w.children||""),R,M):w.el=E.el},y=(E,w,R,M)=>{[E.el,E.anchor]=g(E.children,w,R,M,E.el,E.anchor)},v=({el:E,anchor:w},R,M)=>{let k;for(;E&&E!==w;)k=d(E),n(E,R,M),E=k;n(w,R,M)},C=({el:E,anchor:w})=>{let R;for(;E&&E!==w;)R=d(E),s(E),E=R;s(w)},x=(E,w,R,M,k,F,Z,H,K)=>{if(w.type==="svg"?Z="svg":w.type==="math"&&(Z="mathml"),E==null)T(w,R,M,k,F,Z,H,K);else{const B=E.el&&E.el._isVueCE?E.el:null;try{B&&B._beginPatch(),b(E,w,k,F,Z,H,K)}finally{B&&B._endPatch()}}},T=(E,w,R,M,k,F,Z,H)=>{let K,B;const{props:ie,shapeFlag:X,transition:ne,dirs:oe}=E;if(K=E.el=o(E.type,F,ie&&ie.is,ie),X&8?c(K,E.children):X&16&&L(E.children,K,null,M,k,Sa(E,F),Z,H),oe&&On(E,null,M,"created"),I(K,E,E.scopeId,Z,M),ie){for(const Re in ie)Re!=="value"&&!xr(Re)&&r(K,Re,null,ie[Re],F,M);"value"in ie&&r(K,"value",null,ie.value,F),(B=ie.onVnodeBeforeMount)&&gi(B,M,E)}oe&&On(E,null,M,"beforeMount");const _e=Gy(k,ne);_e&&ne.beforeEnter(K),n(K,w,R),((B=ie&&ie.onVnodeMounted)||_e||oe)&&Mt(()=>{B&&gi(B,M,E),_e&&ne.enter(K),oe&&On(E,null,M,"mounted")},k)},I=(E,w,R,M,k)=>{if(R&&f(E,R),M)for(let F=0;F<M.length;F++)f(E,M[F]);if(k){let F=k.subTree;if(w===F||Bg(F.type)&&(F.ssContent===w||F.ssFallback===w)){const Z=k.vnode;I(E,Z,Z.scopeId,Z.slotScopeIds,k.parent)}}},L=(E,w,R,M,k,F,Z,H,K=0)=>{for(let B=K;B<E.length;B++){const ie=E[B]=H?gn(E[B]):_i(E[B]);m(null,ie,w,R,M,k,F,Z,H)}},b=(E,w,R,M,k,F,Z)=>{const H=w.el=E.el;let{patchFlag:K,dynamicChildren:B,dirs:ie}=w;K|=E.patchFlag&16;const X=E.props||Fe,ne=w.props||Fe;let oe;if(R&&Fn(R,!1),(oe=ne.onVnodeBeforeUpdate)&&gi(oe,R,w,E),ie&&On(w,E,R,"beforeUpdate"),R&&Fn(R,!0),(X.innerHTML&&ne.innerHTML==null||X.textContent&&ne.textContent==null)&&c(H,""),B?G(E.dynamicChildren,B,H,R,M,Sa(w,k),F):Z||V(E,w,H,null,R,M,Sa(w,k),F,!1),K>0){if(K&16)W(H,X,ne,R,k);else if(K&2&&X.class!==ne.class&&r(H,"class",null,ne.class,k),K&4&&r(H,"style",X.style,ne.style,k),K&8){const _e=w.dynamicProps;for(let Re=0;Re<_e.length;Re++){const Te=_e[Re],nt=X[Te],st=ne[Te];(st!==nt||Te==="value")&&r(H,Te,nt,st,k,R)}}K&1&&E.children!==w.children&&c(H,w.children)}else!Z&&B==null&&W(H,X,ne,R,k);((oe=ne.onVnodeUpdated)||ie)&&Mt(()=>{oe&&gi(oe,R,w,E),ie&&On(w,E,R,"updated")},M)},G=(E,w,R,M,k,F,Z)=>{for(let H=0;H<w.length;H++){const K=E[H],B=w[H],ie=K.el&&(K.type===He||!zn(K,B)||K.shapeFlag&198)?u(K.el):R;m(K,B,ie,null,M,k,F,Z,!0)}},W=(E,w,R,M,k)=>{if(w!==R){if(w!==Fe)for(const F in w)!xr(F)&&!(F in R)&&r(E,F,w[F],null,k,M);for(const F in R){if(xr(F))continue;const Z=R[F],H=w[F];Z!==H&&F!=="value"&&r(E,F,H,Z,k,M)}"value"in R&&r(E,"value",w.value,R.value,k)}},A=(E,w,R,M,k,F,Z,H,K)=>{const B=w.el=E?E.el:l(""),ie=w.anchor=E?E.anchor:l("");let{patchFlag:X,dynamicChildren:ne,slotScopeIds:oe}=w;oe&&(H=H?H.concat(oe):oe),E==null?(n(B,R,M),n(ie,R,M),L(w.children||[],R,ie,k,F,Z,H,K)):X>0&&X&64&&ne&&E.dynamicChildren&&E.dynamicChildren.length===ne.length?(G(E.dynamicChildren,ne,R,k,F,Z,H),(w.key!=null||k&&w===k.subTree)&&Vg(E,w,!0)):V(E,w,R,ie,k,F,Z,H,K)},S=(E,w,R,M,k,F,Z,H,K)=>{w.slotScopeIds=H,E==null?w.shapeFlag&512?k.ctx.activate(w,R,M,Z,K):O(w,R,M,k,F,Z,K):U(E,w,K)},O=(E,w,R,M,k,F,Z)=>{const H=E.component=Hy(E,M,k);if(no(E)&&(H.ctx.renderer=Q),Yy(H,!1,Z),H.asyncDep){if(k&&k.registerDep(H,N,Z),!E.el){const K=H.subTree=Ve(ft);p(null,K,w,R),E.placeholder=K.el}}else N(H,E,w,R,k,F,Z)},U=(E,w,R)=>{const M=w.component=E.component;if(by(E,w,R))if(M.asyncDep&&!M.asyncResolved){z(M,w,R);return}else M.next=w,M.update();else w.el=E.el,M.vnode=w},N=(E,w,R,M,k,F,Z)=>{const H=()=>{if(E.isMounted){let{next:X,bu:ne,u:oe,parent:_e,vnode:Re}=E;{const Nt=jg(E);if(Nt){X&&(X.el=Re.el,z(E,X,Z)),Nt.asyncDep.then(()=>{E.isUnmounted||H()});return}}let Te=X,nt;Fn(E,!1),X?(X.el=Re.el,z(E,X,Z)):X=Re,ne&&Uo(ne),(nt=X.props&&X.props.onVnodeBeforeUpdate)&&gi(nt,_e,X,Re),Fn(E,!0);const st=Nu(E),Rt=E.subTree;E.subTree=st,m(Rt,st,u(Rt.el),P(Rt),E,k,F),X.el=st.el,Te===null&&Ay(E,st.el),oe&&Mt(oe,k),(nt=X.props&&X.props.onVnodeUpdated)&&Mt(()=>gi(nt,_e,X,Re),k)}else{let X;const{el:ne,props:oe}=w,{bm:_e,m:Re,parent:Te,root:nt,type:st}=E,Rt=Ps(w);Fn(E,!1),_e&&Uo(_e),!Rt&&(X=oe&&oe.onVnodeBeforeMount)&&gi(X,Te,w),Fn(E,!0);{nt.ce&&nt.ce._def.shadowRoot!==!1&&nt.ce._injectChildStyle(st);const Nt=E.subTree=Nu(E);m(null,Nt,R,M,E,k,F),w.el=Nt.el}if(Re&&Mt(Re,k),!Rt&&(X=oe&&oe.onVnodeMounted)){const Nt=w;Mt(()=>gi(X,Te,Nt),k)}(w.shapeFlag&256||Te&&Ps(Te.vnode)&&Te.vnode.shapeFlag&256)&&E.a&&Mt(E.a,k),E.isMounted=!0,w=R=M=null}};E.scope.on();const K=E.effect=new Hf(H);E.scope.off();const B=E.update=K.run.bind(K),ie=E.job=K.runIfDirty.bind(K);ie.i=E,ie.id=E.uid,K.scheduler=()=>dh(ie),Fn(E,!0),B()},z=(E,w,R)=>{w.component=E;const M=E.vnode.props;E.vnode=w,E.next=null,Py(E,w.props,M,R),Dy(E,w.children,R),Hi(),bu(E),Yi()},V=(E,w,R,M,k,F,Z,H,K=!1)=>{const B=E&&E.children,ie=E?E.shapeFlag:0,X=w.children,{patchFlag:ne,shapeFlag:oe}=w;if(ne>0){if(ne&128){se(B,X,R,M,k,F,Z,H,K);return}else if(ne&256){J(B,X,R,M,k,F,Z,H,K);return}}oe&8?(ie&16&&De(B,k,F),X!==B&&c(R,X)):ie&16?oe&16?se(B,X,R,M,k,F,Z,H,K):De(B,k,F,!0):(ie&8&&c(R,""),oe&16&&L(X,R,M,k,F,Z,H,K))},J=(E,w,R,M,k,F,Z,H,K)=>{E=E||bs,w=w||bs;const B=E.length,ie=w.length,X=Math.min(B,ie);let ne;for(ne=0;ne<X;ne++){const oe=w[ne]=K?gn(w[ne]):_i(w[ne]);m(E[ne],oe,R,null,k,F,Z,H,K)}B>ie?De(E,k,F,!0,!1,X):L(w,R,M,k,F,Z,H,K,X)},se=(E,w,R,M,k,F,Z,H,K)=>{let B=0;const ie=w.length;let X=E.length-1,ne=ie-1;for(;B<=X&&B<=ne;){const oe=E[B],_e=w[B]=K?gn(w[B]):_i(w[B]);if(zn(oe,_e))m(oe,_e,R,null,k,F,Z,H,K);else break;B++}for(;B<=X&&B<=ne;){const oe=E[X],_e=w[ne]=K?gn(w[ne]):_i(w[ne]);if(zn(oe,_e))m(oe,_e,R,null,k,F,Z,H,K);else break;X--,ne--}if(B>X){if(B<=ne){const oe=ne+1,_e=oe<ie?w[oe].el:M;for(;B<=ne;)m(null,w[B]=K?gn(w[B]):_i(w[B]),R,_e,k,F,Z,H,K),B++}}else if(B>ne)for(;B<=X;)j(E[B],k,F,!0),B++;else{const oe=B,_e=B,Re=new Map;for(B=_e;B<=ne;B++){const ct=w[B]=K?gn(w[B]):_i(w[B]);ct.key!=null&&Re.set(ct.key,B)}let Te,nt=0;const st=ne-_e+1;let Rt=!1,Nt=0;const Pn=new Array(st);for(B=0;B<st;B++)Pn[B]=0;for(B=oe;B<=X;B++){const ct=E[B];if(nt>=st){j(ct,k,F,!0);continue}let Tt;if(ct.key!=null)Tt=Re.get(ct.key);else for(Te=_e;Te<=ne;Te++)if(Pn[Te-_e]===0&&zn(ct,w[Te])){Tt=Te;break}Tt===void 0?j(ct,k,F,!0):(Pn[Tt-_e]=B+1,Tt>=Nt?Nt=Tt:Rt=!0,m(ct,w[Tt],R,null,k,F,Z,H,K),nt++)}const Qs=Rt?Vy(Pn):bs;for(Te=Qs.length-1,B=st-1;B>=0;B--){const ct=_e+B,Tt=w[ct],er=w[ct+1],Co=ct+1<ie?er.el||zg(er):M;Pn[B]===0?m(null,Tt,R,Co,k,F,Z,H,K):Rt&&(Te<0||B!==Qs[Te]?ae(Tt,R,Co,2):Te--)}}},ae=(E,w,R,M,k=null)=>{const{el:F,type:Z,transition:H,children:K,shapeFlag:B}=E;if(B&6){ae(E.component.subTree,w,R,M);return}if(B&128){E.suspense.move(w,R,M);return}if(B&64){Z.move(E,w,R,Q);return}if(Z===He){n(F,w,R);for(let X=0;X<K.length;X++)ae(K[X],w,R,M);n(E.anchor,w,R);return}if(Z===Xo){v(E,w,R);return}if(M!==2&&B&1&&H)if(M===0)H.beforeEnter(F),n(F,w,R),Mt(()=>H.enter(F),k);else{const{leave:X,delayLeave:ne,afterLeave:oe}=H,_e=()=>{E.ctx.isUnmounted?s(F):n(F,w,R)},Re=()=>{F._isLeaving&&F[zi](!0),X(F,()=>{_e(),oe&&oe()})};ne?ne(F,_e,Re):Re()}else n(F,w,R)},j=(E,w,R,M=!1,k=!1)=>{const{type:F,props:Z,ref:H,children:K,dynamicChildren:B,shapeFlag:ie,patchFlag:X,dirs:ne,cacheIndex:oe}=E;if(X===-2&&(k=!1),H!=null&&(Hi(),Tr(H,null,R,E,!0),Yi()),oe!=null&&(w.renderCache[oe]=void 0),ie&256){w.ctx.deactivate(E);return}const _e=ie&1&&ne,Re=!Ps(E);let Te;if(Re&&(Te=Z&&Z.onVnodeBeforeUnmount)&&gi(Te,w,E),ie&6)Le(E.component,R,M);else{if(ie&128){E.suspense.unmount(R,M);return}_e&&On(E,null,w,"beforeUnmount"),ie&64?E.type.remove(E,w,R,Q,M):B&&!B.hasOnce&&(F!==He||X>0&&X&64)?De(B,w,R,!1,!0):(F===He&&X&384||!k&&ie&16)&&De(K,w,R),M&&xe(E)}(Re&&(Te=Z&&Z.onVnodeUnmounted)||_e)&&Mt(()=>{Te&&gi(Te,w,E),_e&&On(E,null,w,"unmounted")},R)},xe=E=>{const{type:w,el:R,anchor:M,transition:k}=E;if(w===He){ye(R,M);return}if(w===Xo){C(E);return}const F=()=>{s(R),k&&!k.persisted&&k.afterLeave&&k.afterLeave()};if(E.shapeFlag&1&&k&&!k.persisted){const{leave:Z,delayLeave:H}=k,K=()=>Z(R,F);H?H(E.el,F,K):K()}else F()},ye=(E,w)=>{let R;for(;E!==w;)R=d(E),s(E),E=R;s(w)},Le=(E,w,R)=>{const{bum:M,scope:k,job:F,subTree:Z,um:H,m:K,a:B}=E;ju(K),ju(B),M&&Uo(M),k.stop(),F&&(F.flags|=8,j(Z,E,w,R)),H&&Mt(H,w),Mt(()=>{E.isUnmounted=!0},w)},De=(E,w,R,M=!1,k=!1,F=0)=>{for(let Z=F;Z<E.length;Z++)j(E[Z],w,R,M,k)},P=E=>{if(E.shapeFlag&6)return P(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const w=d(E.anchor||E.el),R=w&&w[$p];return R?d(R):w};let q=!1;const Y=(E,w,R)=>{let M;E==null?w._vnode&&(j(w._vnode,null,null,!0),M=w._vnode.component):m(w._vnode||null,E,w,null,null,null,R),w._vnode=E,q||(q=!0,bu(M),fg(),q=!1)},Q={p:m,um:j,m:ae,r:xe,mt:O,mc:L,pc:V,pbc:G,n:P,o:i};return{render:Y,hydrate:void 0,createApp:xy(Y)}}function Sa({type:i,props:e},t){return t==="svg"&&i==="foreignObject"||t==="mathml"&&i==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Fn({effect:i,job:e},t){t?(i.flags|=32,e.flags|=4):(i.flags&=-33,e.flags&=-5)}function Gy(i,e){return(!i||i&&!i.pendingBranch)&&e&&!e.persisted}function Vg(i,e,t=!1){const n=i.children,s=e.children;if(he(n)&&he(s))for(let r=0;r<n.length;r++){const o=n[r];let l=s[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[r]=gn(s[r]),l.el=o.el),!t&&l.patchFlag!==-2&&Vg(o,l)),l.type===zl&&(l.patchFlag!==-1?l.el=o.el:l.__elIndex=r+(i.type===He?1:0)),l.type===ft&&!l.el&&(l.el=o.el)}}function Vy(i){const e=i.slice(),t=[0];let n,s,r,o,l;const a=i.length;for(n=0;n<a;n++){const h=i[n];if(h!==0){if(s=t[t.length-1],i[s]<h){e[n]=s,t.push(n);continue}for(r=0,o=t.length-1;r<o;)l=r+o>>1,i[t[l]]<h?r=l+1:o=l;h<i[t[r]]&&(r>0&&(e[n]=t[r-1]),t[r]=n)}}for(r=t.length,o=t[r-1];r-- >0;)t[r]=o,o=e[o];return t}function jg(i){const e=i.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:jg(e)}function ju(i){if(i)for(let e=0;e<i.length;e++)i[e].flags|=8}function zg(i){if(i.placeholder)return i.placeholder;const e=i.component;return e?zg(e.subTree):null}const Bg=i=>i.__isSuspense;function jy(i,e){e&&e.pendingBranch?he(i)?e.effects.push(...i):e.effects.push(i):Kp(i)}const He=Symbol.for("v-fgt"),zl=Symbol.for("v-txt"),ft=Symbol.for("v-cmt"),Xo=Symbol.for("v-stc"),Ir=[];let Dt=null;function pe(i=!1){Ir.push(Dt=i?null:[])}function zy(){Ir.pop(),Dt=Ir[Ir.length-1]||null}let kr=1;function nl(i,e=!1){kr+=i,i<0&&Dt&&e&&(Dt.hasOnce=!0)}function Wg(i){return i.dynamicChildren=kr>0?Dt||bs:null,zy(),kr>0&&Dt&&Dt.push(i),i}function Me(i,e,t,n,s,r){return Wg(ee(i,e,t,n,s,r,!0))}function si(i,e,t,n,s){return Wg(Ve(i,e,t,n,s,!0))}function Nr(i){return i?i.__v_isVNode===!0:!1}function zn(i,e){return i.type===e.type&&i.key===e.key}const Ug=({key:i})=>i??null,Ho=({ref:i,ref_key:e,ref_for:t})=>(typeof i=="number"&&(i=""+i),i!=null?Ze(i)||mt(i)||ue(i)?{i:lt,r:i,k:e,f:!!t}:i:null);function ee(i,e=null,t=null,n=0,s=null,r=i===He?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:i,props:e,key:e&&Ug(e),ref:e&&Ho(e),scopeId:mg,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:lt};return l?(yh(a,t),r&128&&i.normalize(a)):t&&(a.shapeFlag|=Ze(t)?8:16),kr>0&&!o&&Dt&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&Dt.push(a),a}const Ve=By;function By(i,e=null,t=null,n=0,s=null,r=!1){if((!i||i===dy)&&(i=ft),Nr(i)){const l=Tn(i,e,!0);return t&&yh(l,t),kr>0&&!r&&Dt&&(l.shapeFlag&6?Dt[Dt.indexOf(i)]=l:Dt.push(l)),l.patchFlag=-2,l}if(Qy(i)&&(i=i.__vccOpts),e){e=Wy(e);let{class:l,style:a}=e;l&&!Ze(l)&&(e.class=Qn(l)),Ge(a)&&(uh(a)&&!he(a)&&(a=it({},a)),e.style=Fl(a))}const o=Ze(i)?1:Bg(i)?128:yg(i)?64:Ge(i)?4:ue(i)?2:0;return ee(i,e,t,n,s,o,r,!0)}function Wy(i){return i?uh(i)||Og(i)?it({},i):i:null}function Tn(i,e,t=!1,n=!1){const{props:s,ref:r,patchFlag:o,children:l,transition:a}=i,h=e?Uy(s||{},e):s,c={__v_isVNode:!0,__v_skip:!0,type:i.type,props:h,key:h&&Ug(h),ref:e&&e.ref?t&&r?he(r)?r.concat(Ho(e)):[r,Ho(e)]:Ho(e):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:l,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:e&&i.type!==He?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:a,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&Tn(i.ssContent),ssFallback:i.ssFallback&&Tn(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return a&&n&&Dr(c,a.clone(c)),c}function Bn(i=" ",e=0){return Ve(zl,null,i,e)}function Kg(i,e){const t=Ve(Xo,null,i);return t.staticCount=e,t}function Gs(i="",e=!1){return e?(pe(),si(ft,null,i)):Ve(ft,null,i)}function _i(i){return i==null||typeof i=="boolean"?Ve(ft):he(i)?Ve(He,null,i.slice()):Nr(i)?gn(i):Ve(zl,null,String(i))}function gn(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:Tn(i)}function yh(i,e){let t=0;const{shapeFlag:n}=i;if(e==null)e=null;else if(he(e))t=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),yh(i,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Og(e)?e._ctx=lt:s===3&&lt&&(lt.slots._===1?e._=1:(e._=2,i.patchFlag|=1024))}else ue(e)?(e={default:e,_ctx:lt},t=32):(e=String(e),n&64?(t=16,e=[Bn(e)]):t=8);i.children=e,i.shapeFlag|=t}function Uy(...i){const e={};for(let t=0;t<i.length;t++){const n=i[t];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Qn([e.class,n.class]));else if(s==="style")e.style=Fl([e.style,n.style]);else if(Al(s)){const r=e[s],o=n[s];o&&r!==o&&!(he(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=n[s])}return e}function gi(i,e,t,n=null){ci(i,e,7,[t,n])}const Ky=Ag();let Xy=0;function Hy(i,e,t){const n=i.type,s=(e?e.appContext:i.appContext)||Ky,r={uid:Xy++,vnode:i,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new mp(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Dg(n,s),emitsOptions:Lg(n,s),emit:null,emitted:null,propsDefaults:Fe,inheritAttrs:n.inheritAttrs,ctx:Fe,data:Fe,props:Fe,attrs:Fe,slots:Fe,refs:Fe,setupState:Fe,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Ry.bind(null,r),i.ce&&i.ce(r),r}let ot=null;const Xg=()=>ot||lt;let sl,wc;{const i=Ol(),e=(t,n)=>{let s;return(s=i[t])||(s=i[t]=[]),s.push(n),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};sl=e("__VUE_INSTANCE_SETTERS__",t=>ot=t),wc=e("__VUE_SSR_SETTERS__",t=>Vs=t)}const so=i=>{const e=ot;return sl(i),i.scope.on(),()=>{i.scope.off(),sl(e)}},zu=()=>{ot&&ot.scope.off(),sl(null)};function Hg(i){return i.vnode.shapeFlag&4}let Vs=!1;function Yy(i,e=!1,t=!1){e&&wc(e);const{props:n,children:s}=i.vnode,r=Hg(i);Ly(i,n,r,e),Fy(i,s,t||e);const o=r?Zy(i,e):void 0;return e&&wc(!1),o}function Zy(i,e){const t=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,my);const{setup:n}=t;if(n){Hi();const s=i.setupContext=n.length>1?qy(i):null,r=so(i),o=to(n,i,0,[i.props,s]),l=jf(o);if(Yi(),r(),(l||i.sp)&&!Ps(i)&&gh(i),l){if(o.then(zu,zu),e)return o.then(a=>{Bu(i,a)}).catch(a=>{io(a,i,0)});i.asyncDep=o}else Bu(i,o)}else Yg(i)}function Bu(i,e,t){ue(e)?i.type.__ssrInlineRender?i.ssrRender=e:i.render=e:Ge(e)&&(i.setupState=cg(e)),Yg(i)}function Yg(i,e,t){const n=i.type;i.render||(i.render=n.render||Ei);{const s=so(i);Hi();try{_y(i)}finally{Yi(),s()}}}const $y={get(i,e){return dt(i,"get",""),i[e]}};function qy(i){const e=t=>{i.exposed=t||{}};return{attrs:new Proxy(i.attrs,$y),slots:i.slots,emit:i.emit,expose:e}}function Bl(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(cg(Dp(i.exposed)),{get(e,t){if(t in e)return e[t];if(t in Sr)return Sr[t](i)},has(e,t){return t in e||t in Sr}})):i.proxy}function Jy(i,e=!0){return ue(i)?i.displayName||i.name:i.name||e&&i.__name}function Qy(i){return ue(i)&&"__vccOpts"in i}const xt=(i,e)=>jp(i,e,Vs);function Ch(i,e,t){try{nl(-1);const n=arguments.length;return n===2?Ge(e)&&!he(e)?Nr(e)?Ve(i,null,[e]):Ve(i,e):Ve(i,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&Nr(t)&&(t=[t]),Ve(i,e,t))}finally{nl(1)}}const e0="3.5.26";let Rc;const Wu=typeof window<"u"&&window.trustedTypes;if(Wu)try{Rc=Wu.createPolicy("vue",{createHTML:i=>i})}catch{}const Zg=Rc?i=>Rc.createHTML(i):i=>i,t0="http://www.w3.org/2000/svg",i0="http://www.w3.org/1998/Math/MathML",Gi=typeof document<"u"?document:null,Uu=Gi&&Gi.createElement("template"),n0={insert:(i,e,t)=>{e.insertBefore(i,t||null)},remove:i=>{const e=i.parentNode;e&&e.removeChild(i)},createElement:(i,e,t,n)=>{const s=e==="svg"?Gi.createElementNS(t0,i):e==="mathml"?Gi.createElementNS(i0,i):t?Gi.createElement(i,{is:t}):Gi.createElement(i);return i==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:i=>Gi.createTextNode(i),createComment:i=>Gi.createComment(i),setText:(i,e)=>{i.nodeValue=e},setElementText:(i,e)=>{i.textContent=e},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Gi.querySelector(i),setScopeId(i,e){i.setAttribute(e,"")},insertStaticContent(i,e,t,n,s,r){const o=t?t.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===r||!(s=s.nextSibling)););else{Uu.innerHTML=Zg(n==="svg"?`<svg>${i}</svg>`:n==="mathml"?`<math>${i}</math>`:i);const l=Uu.content;if(n==="svg"||n==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}e.insertBefore(l,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},nn="transition",rr="animation",Gr=Symbol("_vtc"),$g={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},s0=it({},Cg,$g),r0=i=>(i.displayName="Transition",i.props=s0,i),rl=r0((i,{slots:e})=>Ch(Qp,o0(i),e)),Dn=(i,e=[])=>{he(i)?i.forEach(t=>t(...e)):i&&i(...e)},Ku=i=>i?he(i)?i.some(e=>e.length>1):i.length>1:!1;function o0(i){const e={};for(const A in i)A in $g||(e[A]=i[A]);if(i.css===!1)return e;const{name:t="v",type:n,duration:s,enterFromClass:r=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:l=`${t}-enter-to`,appearFromClass:a=r,appearActiveClass:h=o,appearToClass:c=l,leaveFromClass:u=`${t}-leave-from`,leaveActiveClass:d=`${t}-leave-active`,leaveToClass:f=`${t}-leave-to`}=i,g=l0(s),m=g&&g[0],_=g&&g[1],{onBeforeEnter:p,onEnter:y,onEnterCancelled:v,onLeave:C,onLeaveCancelled:x,onBeforeAppear:T=p,onAppear:I=y,onAppearCancelled:L=v}=e,b=(A,S,O,U)=>{A._enterCancelled=U,kn(A,S?c:l),kn(A,S?h:o),O&&O()},G=(A,S)=>{A._isLeaving=!1,kn(A,u),kn(A,f),kn(A,d),S&&S()},W=A=>(S,O)=>{const U=A?I:y,N=()=>b(S,A,O);Dn(U,[S,N]),Xu(()=>{kn(S,A?a:r),Oi(S,A?c:l),Ku(U)||Hu(S,n,m,N)})};return it(e,{onBeforeEnter(A){Dn(p,[A]),Oi(A,r),Oi(A,o)},onBeforeAppear(A){Dn(T,[A]),Oi(A,a),Oi(A,h)},onEnter:W(!1),onAppear:W(!0),onLeave(A,S){A._isLeaving=!0;const O=()=>G(A,S);Oi(A,u),A._enterCancelled?(Oi(A,d),$u(A)):($u(A),Oi(A,d)),Xu(()=>{A._isLeaving&&(kn(A,u),Oi(A,f),Ku(C)||Hu(A,n,_,O))}),Dn(C,[A,O])},onEnterCancelled(A){b(A,!1,void 0,!0),Dn(v,[A])},onAppearCancelled(A){b(A,!0,void 0,!0),Dn(L,[A])},onLeaveCancelled(A){G(A),Dn(x,[A])}})}function l0(i){if(i==null)return null;if(Ge(i))return[Ia(i.enter),Ia(i.leave)];{const e=Ia(i);return[e,e]}}function Ia(i){return ap(i)}function Oi(i,e){e.split(/\s+/).forEach(t=>t&&i.classList.add(t)),(i[Gr]||(i[Gr]=new Set)).add(e)}function kn(i,e){e.split(/\s+/).forEach(n=>n&&i.classList.remove(n));const t=i[Gr];t&&(t.delete(e),t.size||(i[Gr]=void 0))}function Xu(i){requestAnimationFrame(()=>{requestAnimationFrame(i)})}let a0=0;function Hu(i,e,t,n){const s=i._endId=++a0,r=()=>{s===i._endId&&n()};if(t!=null)return setTimeout(r,t);const{type:o,timeout:l,propCount:a}=c0(i,e);if(!o)return n();const h=o+"end";let c=0;const u=()=>{i.removeEventListener(h,d),r()},d=f=>{f.target===i&&++c>=a&&u()};setTimeout(()=>{c<a&&u()},l+1),i.addEventListener(h,d)}function c0(i,e){const t=window.getComputedStyle(i),n=g=>(t[g]||"").split(", "),s=n(`${nn}Delay`),r=n(`${nn}Duration`),o=Yu(s,r),l=n(`${rr}Delay`),a=n(`${rr}Duration`),h=Yu(l,a);let c=null,u=0,d=0;e===nn?o>0&&(c=nn,u=o,d=r.length):e===rr?h>0&&(c=rr,u=h,d=a.length):(u=Math.max(o,h),c=u>0?o>h?nn:rr:null,d=c?c===nn?r.length:a.length:0);const f=c===nn&&/\b(?:transform|all)(?:,|$)/.test(n(`${nn}Property`).toString());return{type:c,timeout:u,propCount:d,hasTransform:f}}function Yu(i,e){for(;i.length<e.length;)i=i.concat(i);return Math.max(...e.map((t,n)=>Zu(t)+Zu(i[n])))}function Zu(i){return i==="auto"?0:Number(i.slice(0,-1).replace(",","."))*1e3}function $u(i){return(i?i.ownerDocument:document).body.offsetHeight}function h0(i,e,t){const n=i[Gr];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?i.removeAttribute("class"):t?i.setAttribute("class",e):i.className=e}const ol=Symbol("_vod"),qg=Symbol("_vsh"),u0={name:"show",beforeMount(i,{value:e},{transition:t}){i[ol]=i.style.display==="none"?"":i.style.display,t&&e?t.beforeEnter(i):or(i,e)},mounted(i,{value:e},{transition:t}){t&&e&&t.enter(i)},updated(i,{value:e,oldValue:t},{transition:n}){!e!=!t&&(n?e?(n.beforeEnter(i),or(i,!0),n.enter(i)):n.leave(i,()=>{or(i,!1)}):or(i,e))},beforeUnmount(i,{value:e}){or(i,e)}};function or(i,e){i.style.display=e?i[ol]:"none",i[qg]=!e}const d0=Symbol(""),f0=/(?:^|;)\s*display\s*:/;function g0(i,e,t){const n=i.style,s=Ze(t);let r=!1;if(t&&!s){if(e)if(Ze(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();t[l]==null&&Yo(n,l,"")}else for(const o in e)t[o]==null&&Yo(n,o,"");for(const o in t)o==="display"&&(r=!0),Yo(n,o,t[o])}else if(s){if(e!==t){const o=n[d0];o&&(t+=";"+o),n.cssText=t,r=f0.test(t)}}else e&&i.removeAttribute("style");ol in i&&(i[ol]=r?n.display:"",i[qg]&&(n.display="none"))}const qu=/\s*!important$/;function Yo(i,e,t){if(he(t))t.forEach(n=>Yo(i,e,n));else if(t==null&&(t=""),e.startsWith("--"))i.setProperty(e,t);else{const n=m0(i,e);qu.test(t)?i.setProperty(os(n),t.replace(qu,""),"important"):i[n]=t}}const Ju=["Webkit","Moz","ms"],ba={};function m0(i,e){const t=ba[e];if(t)return t;let n=Zt(e);if(n!=="filter"&&n in i)return ba[e]=n;n=Ml(n);for(let s=0;s<Ju.length;s++){const r=Ju[s]+n;if(r in i)return ba[e]=r}return e}const Qu="http://www.w3.org/1999/xlink";function ed(i,e,t,n,s,r=gp(e)){n&&e.startsWith("xlink:")?t==null?i.removeAttributeNS(Qu,e.slice(6,e.length)):i.setAttributeNS(Qu,e,t):t==null||r&&!Uf(t)?i.removeAttribute(e):i.setAttribute(e,r?"":Qi(t)?String(t):t)}function td(i,e,t,n,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(i[e]=e==="innerHTML"?Zg(t):t);return}const r=i.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?i.getAttribute("value")||"":i.value,a=t==null?i.type==="checkbox"?"on":"":String(t);(l!==a||!("_value"in i))&&(i.value=a),t==null&&i.removeAttribute(e),i._value=t;return}let o=!1;if(t===""||t==null){const l=typeof i[e];l==="boolean"?t=Uf(t):t==null&&l==="string"?(t="",o=!0):l==="number"&&(t=0,o=!0)}try{i[e]=t}catch{}o&&i.removeAttribute(s||e)}function Cs(i,e,t,n){i.addEventListener(e,t,n)}function _0(i,e,t,n){i.removeEventListener(e,t,n)}const id=Symbol("_vei");function p0(i,e,t,n,s=null){const r=i[id]||(i[id]={}),o=r[e];if(n&&o)o.value=n;else{const[l,a]=y0(e);if(n){const h=r[e]=E0(n,s);Cs(i,l,h,a)}else o&&(_0(i,l,o,a),r[e]=void 0)}}const nd=/(?:Once|Passive|Capture)$/;function y0(i){let e;if(nd.test(i)){e={};let n;for(;n=i.match(nd);)i=i.slice(0,i.length-n[0].length),e[n[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):os(i.slice(2)),e]}let Aa=0;const C0=Promise.resolve(),v0=()=>Aa||(C0.then(()=>Aa=0),Aa=Date.now());function E0(i,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;ci(x0(n,t.value),e,5,[n])};return t.value=i,t.attached=v0(),t}function x0(i,e){if(he(e)){const t=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{t.call(i),i._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const sd=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,w0=(i,e,t,n,s,r)=>{const o=s==="svg";e==="class"?h0(i,n,o):e==="style"?g0(i,t,n):Al(e)?th(e)||p0(i,e,t,n,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):R0(i,e,n,o))?(td(i,e,n),!i.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ed(i,e,n,o,r,e!=="value")):i._isVueCE&&(/[A-Z]/.test(e)||!Ze(n))?td(i,Zt(e),n,r,e):(e==="true-value"?i._trueValue=n:e==="false-value"&&(i._falseValue=n),ed(i,e,n,o))};function R0(i,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in i&&sd(e)&&ue(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&i.tagName==="IFRAME"||e==="form"||e==="list"&&i.tagName==="INPUT"||e==="type"&&i.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=i.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return sd(e)&&Ze(t)?!1:e in i}const rd=i=>{const e=i.props["onUpdate:modelValue"]||!1;return he(e)?t=>Uo(e,t):e};function T0(i){i.target.composing=!0}function od(i){const e=i.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const La=Symbol("_assign");function ld(i,e,t){return e&&(i=i.trim()),t&&(i=sh(i)),i}const AT={created(i,{modifiers:{lazy:e,trim:t,number:n}},s){i[La]=rd(s);const r=n||s.props&&s.props.type==="number";Cs(i,e?"change":"input",o=>{o.target.composing||i[La](ld(i.value,t,r))}),(t||r)&&Cs(i,"change",()=>{i.value=ld(i.value,t,r)}),e||(Cs(i,"compositionstart",T0),Cs(i,"compositionend",od),Cs(i,"change",od))},mounted(i,{value:e}){i.value=e??""},beforeUpdate(i,{value:e,oldValue:t,modifiers:{lazy:n,trim:s,number:r}},o){if(i[La]=rd(o),i.composing)return;const l=(r||i.type==="number")&&!/^0\d/.test(i.value)?sh(i.value):i.value,a=e??"";l!==a&&(document.activeElement===i&&i.type!=="range"&&(n&&e===t||s&&i.value.trim()===a)||(i.value=a))}},S0=["ctrl","shift","alt","meta"],I0={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,e)=>S0.some(t=>i[`${t}Key`]&&!e.includes(t))},b0=(i,e)=>{const t=i._withMods||(i._withMods={}),n=e.join(".");return t[n]||(t[n]=((s,...r)=>{for(let o=0;o<e.length;o++){const l=I0[e[o]];if(l&&l(s,e))return}return i(s,...r)}))},A0=it({patchProp:w0},n0);let ad;function L0(){return ad||(ad=ky(A0))}const P0=((...i)=>{const e=L0().createApp(...i),{mount:t}=e;return e.mount=n=>{const s=O0(n);if(!s)return;const r=e._component;!ue(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,M0(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e});function M0(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function O0(i){return Ze(i)?document.querySelector(i):i}const F0="/Blogs/logo.svg";const vs=typeof document<"u";function Jg(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function D0(i){return i.__esModule||i[Symbol.toStringTag]==="Module"||i.default&&Jg(i.default)}const be=Object.assign;function Pa(i,e){const t={};for(const n in e){const s=e[n];t[n]=hi(s)?s.map(i):i(s)}return t}const br=()=>{},hi=Array.isArray;function cd(i,e){const t={};for(const n in i)t[n]=n in e?e[n]:i[n];return t}const Qg=/#/g,k0=/&/g,N0=/\//g,G0=/=/g,V0=/\?/g,em=/\+/g,j0=/%5B/g,z0=/%5D/g,tm=/%5E/g,B0=/%60/g,im=/%7B/g,W0=/%7C/g,nm=/%7D/g,U0=/%20/g;function vh(i){return i==null?"":encodeURI(""+i).replace(W0,"|").replace(j0,"[").replace(z0,"]")}function K0(i){return vh(i).replace(im,"{").replace(nm,"}").replace(tm,"^")}function Tc(i){return vh(i).replace(em,"%2B").replace(U0,"+").replace(Qg,"%23").replace(k0,"%26").replace(B0,"`").replace(im,"{").replace(nm,"}").replace(tm,"^")}function X0(i){return Tc(i).replace(G0,"%3D")}function H0(i){return vh(i).replace(Qg,"%23").replace(V0,"%3F")}function Y0(i){return H0(i).replace(N0,"%2F")}function Vr(i){if(i==null)return null;try{return decodeURIComponent(""+i)}catch{}return""+i}const Z0=/\/$/,$0=i=>i.replace(Z0,"");function Ma(i,e,t="/"){let n,s={},r="",o="";const l=e.indexOf("#");let a=e.indexOf("?");return a=l>=0&&a>l?-1:a,a>=0&&(n=e.slice(0,a),r=e.slice(a,l>0?l:e.length),s=i(r.slice(1))),l>=0&&(n=n||e.slice(0,l),o=e.slice(l,e.length)),n=eC(n??e,t),{fullPath:n+r+o,path:n,query:s,hash:Vr(o)}}function q0(i,e){const t=e.query?i(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function hd(i,e){return!e||!i.toLowerCase().startsWith(e.toLowerCase())?i:i.slice(e.length)||"/"}function J0(i,e,t){const n=e.matched.length-1,s=t.matched.length-1;return n>-1&&n===s&&js(e.matched[n],t.matched[s])&&sm(e.params,t.params)&&i(e.query)===i(t.query)&&e.hash===t.hash}function js(i,e){return(i.aliasOf||i)===(e.aliasOf||e)}function sm(i,e){if(Object.keys(i).length!==Object.keys(e).length)return!1;for(var t in i)if(!Q0(i[t],e[t]))return!1;return!0}function Q0(i,e){return hi(i)?ud(i,e):hi(e)?ud(e,i):i?.valueOf()===e?.valueOf()}function ud(i,e){return hi(e)?i.length===e.length&&i.every((t,n)=>t===e[n]):i.length===1&&i[0]===e}function eC(i,e){if(i.startsWith("/"))return i;if(!i)return e;const t=e.split("/"),n=i.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let r=t.length-1,o,l;for(o=0;o<n.length;o++)if(l=n[o],l!==".")if(l==="..")r>1&&r--;else break;return t.slice(0,r).join("/")+"/"+n.slice(o).join("/")}const sn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Sc=(function(i){return i.pop="pop",i.push="push",i})({}),Oa=(function(i){return i.back="back",i.forward="forward",i.unknown="",i})({});function tC(i){if(!i)if(vs){const e=document.querySelector("base");i=e&&e.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),$0(i)}const iC=/^[^#]+#/;function nC(i,e){return i.replace(iC,"#")+e}function sC(i,e){const t=document.documentElement.getBoundingClientRect(),n=i.getBoundingClientRect();return{behavior:e.behavior,left:n.left-t.left-(e.left||0),top:n.top-t.top-(e.top||0)}}const Wl=()=>({left:window.scrollX,top:window.scrollY});function rC(i){let e;if("el"in i){const t=i.el,n=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?n?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=sC(s,i)}else e=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function dd(i,e){return(history.state?history.state.position-e:-1)+i}const Ic=new Map;function oC(i,e){Ic.set(i,e)}function lC(i){const e=Ic.get(i);return Ic.delete(i),e}function aC(i){return typeof i=="string"||i&&typeof i=="object"}function rm(i){return typeof i=="string"||typeof i=="symbol"}let Ue=(function(i){return i[i.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",i[i.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",i[i.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",i[i.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",i[i.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",i})({});const om=Symbol("");Ue.MATCHER_NOT_FOUND+"",Ue.NAVIGATION_GUARD_REDIRECT+"",Ue.NAVIGATION_ABORTED+"",Ue.NAVIGATION_CANCELLED+"",Ue.NAVIGATION_DUPLICATED+"";function zs(i,e){return be(new Error,{type:i,[om]:!0},e)}function Fi(i,e){return i instanceof Error&&om in i&&(e==null||!!(i.type&e))}const cC=["params","query","hash"];function hC(i){if(typeof i=="string")return i;if(i.path!=null)return i.path;const e={};for(const t of cC)t in i&&(e[t]=i[t]);return JSON.stringify(e,null,2)}function uC(i){const e={};if(i===""||i==="?")return e;const t=(i[0]==="?"?i.slice(1):i).split("&");for(let n=0;n<t.length;++n){const s=t[n].replace(em," "),r=s.indexOf("="),o=Vr(r<0?s:s.slice(0,r)),l=r<0?null:Vr(s.slice(r+1));if(o in e){let a=e[o];hi(a)||(a=e[o]=[a]),a.push(l)}else e[o]=l}return e}function fd(i){let e="";for(let t in i){const n=i[t];if(t=X0(t),n==null){n!==void 0&&(e+=(e.length?"&":"")+t);continue}(hi(n)?n.map(s=>s&&Tc(s)):[n&&Tc(n)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function dC(i){const e={};for(const t in i){const n=i[t];n!==void 0&&(e[t]=hi(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const fC=Symbol(""),gd=Symbol(""),Ul=Symbol(""),Eh=Symbol(""),bc=Symbol("");function lr(){let i=[];function e(n){return i.push(n),()=>{const s=i.indexOf(n);s>-1&&i.splice(s,1)}}function t(){i=[]}return{add:e,list:()=>i.slice(),reset:t}}function mn(i,e,t,n,s,r=o=>o()){const o=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((l,a)=>{const h=d=>{d===!1?a(zs(Ue.NAVIGATION_ABORTED,{from:t,to:e})):d instanceof Error?a(d):aC(d)?a(zs(Ue.NAVIGATION_GUARD_REDIRECT,{from:e,to:d})):(o&&n.enterCallbacks[s]===o&&typeof d=="function"&&o.push(d),l())},c=r(()=>i.call(n&&n.instances[s],e,t,h));let u=Promise.resolve(c);i.length<3&&(u=u.then(h)),u.catch(d=>a(d))})}function Fa(i,e,t,n,s=r=>r()){const r=[];for(const o of i)for(const l in o.components){let a=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(Jg(a)){const h=(a.__vccOpts||a)[e];h&&r.push(mn(h,t,n,o,l,s))}else{let h=a();r.push(()=>h.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const u=D0(c)?c.default:c;o.mods[l]=c,o.components[l]=u;const d=(u.__vccOpts||u)[e];return d&&mn(d,t,n,o,l,s)()}))}}return r}function gC(i,e){const t=[],n=[],s=[],r=Math.max(e.matched.length,i.matched.length);for(let o=0;o<r;o++){const l=e.matched[o];l&&(i.matched.find(h=>js(h,l))?n.push(l):t.push(l));const a=i.matched[o];a&&(e.matched.find(h=>js(h,a))||s.push(a))}return[t,n,s]}let mC=()=>location.protocol+"//"+location.host;function lm(i,e){const{pathname:t,search:n,hash:s}=e,r=i.indexOf("#");if(r>-1){let o=s.includes(i.slice(r))?i.slice(r).length:1,l=s.slice(o);return l[0]!=="/"&&(l="/"+l),hd(l,"")}return hd(t,i)+n+s}function _C(i,e,t,n){let s=[],r=[],o=null;const l=({state:d})=>{const f=lm(i,location),g=t.value,m=e.value;let _=0;if(d){if(t.value=f,e.value=d,o&&o===g){o=null;return}_=m?d.position-m.position:0}else n(f);s.forEach(p=>{p(t.value,g,{delta:_,type:Sc.pop,direction:_?_>0?Oa.forward:Oa.back:Oa.unknown})})};function a(){o=t.value}function h(d){s.push(d);const f=()=>{const g=s.indexOf(d);g>-1&&s.splice(g,1)};return r.push(f),f}function c(){if(document.visibilityState==="hidden"){const{history:d}=window;if(!d.state)return;d.replaceState(be({},d.state,{scroll:Wl()}),"")}}function u(){for(const d of r)d();r=[],window.removeEventListener("popstate",l),window.removeEventListener("pagehide",c),document.removeEventListener("visibilitychange",c)}return window.addEventListener("popstate",l),window.addEventListener("pagehide",c),document.addEventListener("visibilitychange",c),{pauseListeners:a,listen:h,destroy:u}}function md(i,e,t,n=!1,s=!1){return{back:i,current:e,forward:t,replaced:n,position:window.history.length,scroll:s?Wl():null}}function pC(i){const{history:e,location:t}=window,n={value:lm(i,t)},s={value:e.state};s.value||r(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function r(a,h,c){const u=i.indexOf("#"),d=u>-1?(t.host&&document.querySelector("base")?i:i.slice(u))+a:mC()+i+a;try{e[c?"replaceState":"pushState"](h,"",d),s.value=h}catch(f){console.error(f),t[c?"replace":"assign"](d)}}function o(a,h){r(a,be({},e.state,md(s.value.back,a,s.value.forward,!0),h,{position:s.value.position}),!0),n.value=a}function l(a,h){const c=be({},s.value,e.state,{forward:a,scroll:Wl()});r(c.current,c,!0),r(a,be({},md(n.value,a,null),{position:c.position+1},h),!1),n.value=a}return{location:n,state:s,push:l,replace:o}}function yC(i){i=tC(i);const e=pC(i),t=_C(i,e.state,e.location,e.replace);function n(r,o=!0){o||t.pauseListeners(),history.go(r)}const s=be({location:"",base:i,go:n,createHref:nC.bind(null,i)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function CC(i){return i=location.host?i||location.pathname+location.search:"",i.includes("#")||(i+="#"),yC(i)}let Un=(function(i){return i[i.Static=0]="Static",i[i.Param=1]="Param",i[i.Group=2]="Group",i})({});var Je=(function(i){return i[i.Static=0]="Static",i[i.Param=1]="Param",i[i.ParamRegExp=2]="ParamRegExp",i[i.ParamRegExpEnd=3]="ParamRegExpEnd",i[i.EscapeNext=4]="EscapeNext",i})(Je||{});const vC={type:Un.Static,value:""},EC=/[a-zA-Z0-9_]/;function xC(i){if(!i)return[[]];if(i==="/")return[[vC]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function e(f){throw new Error(`ERR (${t})/"${h}": ${f}`)}let t=Je.Static,n=t;const s=[];let r;function o(){r&&s.push(r),r=[]}let l=0,a,h="",c="";function u(){h&&(t===Je.Static?r.push({type:Un.Static,value:h}):t===Je.Param||t===Je.ParamRegExp||t===Je.ParamRegExpEnd?(r.length>1&&(a==="*"||a==="+")&&e(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),r.push({type:Un.Param,value:h,regexp:c,repeatable:a==="*"||a==="+",optional:a==="*"||a==="?"})):e("Invalid state to consume buffer"),h="")}function d(){h+=a}for(;l<i.length;){if(a=i[l++],a==="\\"&&t!==Je.ParamRegExp){n=t,t=Je.EscapeNext;continue}switch(t){case Je.Static:a==="/"?(h&&u(),o()):a===":"?(u(),t=Je.Param):d();break;case Je.EscapeNext:d(),t=n;break;case Je.Param:a==="("?t=Je.ParamRegExp:EC.test(a)?d():(u(),t=Je.Static,a!=="*"&&a!=="?"&&a!=="+"&&l--);break;case Je.ParamRegExp:a===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+a:t=Je.ParamRegExpEnd:c+=a;break;case Je.ParamRegExpEnd:u(),t=Je.Static,a!=="*"&&a!=="?"&&a!=="+"&&l--,c="";break;default:e("Unknown state");break}}return t===Je.ParamRegExp&&e(`Unfinished custom RegExp for param "${h}"`),u(),o(),s}const _d="[^/]+?",wC={sensitive:!1,strict:!1,start:!0,end:!0};var yt=(function(i){return i[i._multiplier=10]="_multiplier",i[i.Root=90]="Root",i[i.Segment=40]="Segment",i[i.SubSegment=30]="SubSegment",i[i.Static=40]="Static",i[i.Dynamic=20]="Dynamic",i[i.BonusCustomRegExp=10]="BonusCustomRegExp",i[i.BonusWildcard=-50]="BonusWildcard",i[i.BonusRepeatable=-20]="BonusRepeatable",i[i.BonusOptional=-8]="BonusOptional",i[i.BonusStrict=.7000000000000001]="BonusStrict",i[i.BonusCaseSensitive=.25]="BonusCaseSensitive",i})(yt||{});const RC=/[.+*?^${}()[\]/\\]/g;function TC(i,e){const t=be({},wC,e),n=[];let s=t.start?"^":"";const r=[];for(const h of i){const c=h.length?[]:[yt.Root];t.strict&&!h.length&&(s+="/");for(let u=0;u<h.length;u++){const d=h[u];let f=yt.Segment+(t.sensitive?yt.BonusCaseSensitive:0);if(d.type===Un.Static)u||(s+="/"),s+=d.value.replace(RC,"\\$&"),f+=yt.Static;else if(d.type===Un.Param){const{value:g,repeatable:m,optional:_,regexp:p}=d;r.push({name:g,repeatable:m,optional:_});const y=p||_d;if(y!==_d){f+=yt.BonusCustomRegExp;try{`${y}`}catch(C){throw new Error(`Invalid custom RegExp for param "${g}" (${y}): `+C.message)}}let v=m?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;u||(v=_&&h.length<2?`(?:/${v})`:"/"+v),_&&(v+="?"),s+=v,f+=yt.Dynamic,_&&(f+=yt.BonusOptional),m&&(f+=yt.BonusRepeatable),y===".*"&&(f+=yt.BonusWildcard)}c.push(f)}n.push(c)}if(t.strict&&t.end){const h=n.length-1;n[h][n[h].length-1]+=yt.BonusStrict}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function l(h){const c=h.match(o),u={};if(!c)return null;for(let d=1;d<c.length;d++){const f=c[d]||"",g=r[d-1];u[g.name]=f&&g.repeatable?f.split("/"):f}return u}function a(h){let c="",u=!1;for(const d of i){(!u||!c.endsWith("/"))&&(c+="/"),u=!1;for(const f of d)if(f.type===Un.Static)c+=f.value;else if(f.type===Un.Param){const{value:g,repeatable:m,optional:_}=f,p=g in h?h[g]:"";if(hi(p)&&!m)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const y=hi(p)?p.join("/"):p;if(!y)if(_)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):u=!0);else throw new Error(`Missing required param "${g}"`);c+=y}}return c||"/"}return{re:o,score:n,keys:r,parse:l,stringify:a}}function SC(i,e){let t=0;for(;t<i.length&&t<e.length;){const n=e[t]-i[t];if(n)return n;t++}return i.length<e.length?i.length===1&&i[0]===yt.Static+yt.Segment?-1:1:i.length>e.length?e.length===1&&e[0]===yt.Static+yt.Segment?1:-1:0}function am(i,e){let t=0;const n=i.score,s=e.score;for(;t<n.length&&t<s.length;){const r=SC(n[t],s[t]);if(r)return r;t++}if(Math.abs(s.length-n.length)===1){if(pd(n))return 1;if(pd(s))return-1}return s.length-n.length}function pd(i){const e=i[i.length-1];return i.length>0&&e[e.length-1]<0}const IC={strict:!1,end:!0,sensitive:!1};function bC(i,e,t){const n=TC(xC(i.path),t),s=be(n,{record:i,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function AC(i,e){const t=[],n=new Map;e=cd(IC,e);function s(u){return n.get(u)}function r(u,d,f){const g=!f,m=Cd(u);m.aliasOf=f&&f.record;const _=cd(e,u),p=[m];if("alias"in u){const C=typeof u.alias=="string"?[u.alias]:u.alias;for(const x of C)p.push(Cd(be({},m,{components:f?f.record.components:m.components,path:x,aliasOf:f?f.record:m})))}let y,v;for(const C of p){const{path:x}=C;if(d&&x[0]!=="/"){const T=d.record.path,I=T[T.length-1]==="/"?"":"/";C.path=d.record.path+(x&&I+x)}if(y=bC(C,d,_),f?f.alias.push(y):(v=v||y,v!==y&&v.alias.push(y),g&&u.name&&!vd(y)&&o(u.name)),cm(y)&&a(y),m.children){const T=m.children;for(let I=0;I<T.length;I++)r(T[I],y,f&&f.children[I])}f=f||y}return v?()=>{o(v)}:br}function o(u){if(rm(u)){const d=n.get(u);d&&(n.delete(u),t.splice(t.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=t.indexOf(u);d>-1&&(t.splice(d,1),u.record.name&&n.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function l(){return t}function a(u){const d=MC(u,t);t.splice(d,0,u),u.record.name&&!vd(u)&&n.set(u.record.name,u)}function h(u,d){let f,g={},m,_;if("name"in u&&u.name){if(f=n.get(u.name),!f)throw zs(Ue.MATCHER_NOT_FOUND,{location:u});_=f.record.name,g=be(yd(d.params,f.keys.filter(v=>!v.optional).concat(f.parent?f.parent.keys.filter(v=>v.optional):[]).map(v=>v.name)),u.params&&yd(u.params,f.keys.map(v=>v.name))),m=f.stringify(g)}else if(u.path!=null)m=u.path,f=t.find(v=>v.re.test(m)),f&&(g=f.parse(m),_=f.record.name);else{if(f=d.name?n.get(d.name):t.find(v=>v.re.test(d.path)),!f)throw zs(Ue.MATCHER_NOT_FOUND,{location:u,currentLocation:d});_=f.record.name,g=be({},d.params,u.params),m=f.stringify(g)}const p=[];let y=f;for(;y;)p.unshift(y.record),y=y.parent;return{name:_,path:m,params:g,matched:p,meta:PC(p)}}i.forEach(u=>r(u));function c(){t.length=0,n.clear()}return{addRoute:r,resolve:h,removeRoute:o,clearRoutes:c,getRoutes:l,getRecordMatcher:s}}function yd(i,e){const t={};for(const n of e)n in i&&(t[n]=i[n]);return t}function Cd(i){const e={path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:i.aliasOf,beforeEnter:i.beforeEnter,props:LC(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||null:i.component&&{default:i.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function LC(i){const e={},t=i.props||!1;if("component"in i)e.default=t;else for(const n in i.components)e[n]=typeof t=="object"?t[n]:t;return e}function vd(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function PC(i){return i.reduce((e,t)=>be(e,t.meta),{})}function MC(i,e){let t=0,n=e.length;for(;t!==n;){const r=t+n>>1;am(i,e[r])<0?n=r:t=r+1}const s=OC(i);return s&&(n=e.lastIndexOf(s,n-1)),n}function OC(i){let e=i;for(;e=e.parent;)if(cm(e)&&am(i,e)===0)return e}function cm({record:i}){return!!(i.name||i.components&&Object.keys(i.components).length||i.redirect)}function Ed(i){const e=ii(Ul),t=ii(Eh),n=xt(()=>{const a=Xe(i.to);return e.resolve(a)}),s=xt(()=>{const{matched:a}=n.value,{length:h}=a,c=a[h-1],u=t.matched;if(!c||!u.length)return-1;const d=u.findIndex(js.bind(null,c));if(d>-1)return d;const f=xd(a[h-2]);return h>1&&xd(c)===f&&u[u.length-1].path!==f?u.findIndex(js.bind(null,a[h-2])):d}),r=xt(()=>s.value>-1&&GC(t.params,n.value.params)),o=xt(()=>s.value>-1&&s.value===t.matched.length-1&&sm(t.params,n.value.params));function l(a={}){if(NC(a)){const h=e[Xe(i.replace)?"replace":"push"](Xe(i.to)).catch(br);return i.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:n,href:xt(()=>n.value.href),isActive:r,isExactActive:o,navigate:l}}function FC(i){return i.length===1?i[0]:i}const DC=fh({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ed,setup(i,{slots:e}){const t=kl(Ed(i)),{options:n}=ii(Ul),s=xt(()=>({[wd(i.activeClass,n.linkActiveClass,"router-link-active")]:t.isActive,[wd(i.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const r=e.default&&FC(e.default(t));return i.custom?r:Ch("a",{"aria-current":t.isExactActive?i.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},r)}}}),kC=DC;function NC(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const e=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return i.preventDefault&&i.preventDefault(),!0}}function GC(i,e){for(const t in e){const n=e[t],s=i[t];if(typeof n=="string"){if(n!==s)return!1}else if(!hi(s)||s.length!==n.length||n.some((r,o)=>r.valueOf()!==s[o].valueOf()))return!1}return!0}function xd(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const wd=(i,e,t)=>i??e??t,VC=fh({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(i,{attrs:e,slots:t}){const n=ii(bc),s=xt(()=>i.route||n.value),r=ii(gd,0),o=xt(()=>{let h=Xe(r);const{matched:c}=s.value;let u;for(;(u=c[h])&&!u.components;)h++;return h}),l=xt(()=>s.value.matched[o.value]);Ko(gd,xt(()=>o.value+1)),Ko(fC,l),Ko(bc,s);const a=rt();return ni(()=>[a.value,l.value,i.name],([h,c,u],[d,f,g])=>{c&&(c.instances[u]=h,f&&f!==c&&h&&h===d&&(c.leaveGuards.size||(c.leaveGuards=f.leaveGuards),c.updateGuards.size||(c.updateGuards=f.updateGuards))),h&&c&&(!f||!js(c,f)||!d)&&(c.enterCallbacks[u]||[]).forEach(m=>m(h))},{flush:"post"}),()=>{const h=s.value,c=i.name,u=l.value,d=u&&u.components[c];if(!d)return Rd(t.default,{Component:d,route:h});const f=u.props[c],g=f?f===!0?h.params:typeof f=="function"?f(h):f:null,_=Ch(d,be({},g,e,{onVnodeUnmounted:p=>{p.component.isUnmounted&&(u.instances[c]=null)},ref:a}));return Rd(t.default,{Component:_,route:h})||_}}});function Rd(i,e){if(!i)return null;const t=i(e);return t.length===1?t[0]:t}const jC=VC;function zC(i){const e=AC(i.routes,i),t=i.parseQuery||uC,n=i.stringifyQuery||fd,s=i.history,r=lr(),o=lr(),l=lr(),a=kp(sn);let h=sn;vs&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=Pa.bind(null,P=>""+P),u=Pa.bind(null,Y0),d=Pa.bind(null,Vr);function f(P,q){let Y,Q;return rm(P)?(Y=e.getRecordMatcher(P),Q=q):Q=P,e.addRoute(Q,Y)}function g(P){const q=e.getRecordMatcher(P);q&&e.removeRoute(q)}function m(){return e.getRoutes().map(P=>P.record)}function _(P){return!!e.getRecordMatcher(P)}function p(P,q){if(q=be({},q||a.value),typeof P=="string"){const R=Ma(t,P,q.path),M=e.resolve({path:R.path},q),k=s.createHref(R.fullPath);return be(R,M,{params:d(M.params),hash:Vr(R.hash),redirectedFrom:void 0,href:k})}let Y;if(P.path!=null)Y=be({},P,{path:Ma(t,P.path,q.path).path});else{const R=be({},P.params);for(const M in R)R[M]==null&&delete R[M];Y=be({},P,{params:u(R)}),q.params=u(q.params)}const Q=e.resolve(Y,q),me=P.hash||"";Q.params=c(d(Q.params));const E=q0(n,be({},P,{hash:K0(me),path:Q.path})),w=s.createHref(E);return be({fullPath:E,hash:me,query:n===fd?dC(P.query):P.query||{}},Q,{redirectedFrom:void 0,href:w})}function y(P){return typeof P=="string"?Ma(t,P,a.value.path):be({},P)}function v(P,q){if(h!==P)return zs(Ue.NAVIGATION_CANCELLED,{from:q,to:P})}function C(P){return I(P)}function x(P){return C(be(y(P),{replace:!0}))}function T(P,q){const Y=P.matched[P.matched.length-1];if(Y&&Y.redirect){const{redirect:Q}=Y;let me=typeof Q=="function"?Q(P,q):Q;return typeof me=="string"&&(me=me.includes("?")||me.includes("#")?me=y(me):{path:me},me.params={}),be({query:P.query,hash:P.hash,params:me.path!=null?{}:P.params},me)}}function I(P,q){const Y=h=p(P),Q=a.value,me=P.state,E=P.force,w=P.replace===!0,R=T(Y,Q);if(R)return I(be(y(R),{state:typeof R=="object"?be({},me,R.state):me,force:E,replace:w}),q||Y);const M=Y;M.redirectedFrom=q;let k;return!E&&J0(n,Q,Y)&&(k=zs(Ue.NAVIGATION_DUPLICATED,{to:M,from:Q}),ae(Q,Q,!0,!1)),(k?Promise.resolve(k):G(M,Q)).catch(F=>Fi(F)?Fi(F,Ue.NAVIGATION_GUARD_REDIRECT)?F:se(F):V(F,M,Q)).then(F=>{if(F){if(Fi(F,Ue.NAVIGATION_GUARD_REDIRECT))return I(be({replace:w},y(F.to),{state:typeof F.to=="object"?be({},me,F.to.state):me,force:E}),q||M)}else F=A(M,Q,!0,w,me);return W(M,Q,F),F})}function L(P,q){const Y=v(P,q);return Y?Promise.reject(Y):Promise.resolve()}function b(P){const q=ye.values().next().value;return q&&typeof q.runWithContext=="function"?q.runWithContext(P):P()}function G(P,q){let Y;const[Q,me,E]=gC(P,q);Y=Fa(Q.reverse(),"beforeRouteLeave",P,q);for(const R of Q)R.leaveGuards.forEach(M=>{Y.push(mn(M,P,q))});const w=L.bind(null,P,q);return Y.push(w),De(Y).then(()=>{Y=[];for(const R of r.list())Y.push(mn(R,P,q));return Y.push(w),De(Y)}).then(()=>{Y=Fa(me,"beforeRouteUpdate",P,q);for(const R of me)R.updateGuards.forEach(M=>{Y.push(mn(M,P,q))});return Y.push(w),De(Y)}).then(()=>{Y=[];for(const R of E)if(R.beforeEnter)if(hi(R.beforeEnter))for(const M of R.beforeEnter)Y.push(mn(M,P,q));else Y.push(mn(R.beforeEnter,P,q));return Y.push(w),De(Y)}).then(()=>(P.matched.forEach(R=>R.enterCallbacks={}),Y=Fa(E,"beforeRouteEnter",P,q,b),Y.push(w),De(Y))).then(()=>{Y=[];for(const R of o.list())Y.push(mn(R,P,q));return Y.push(w),De(Y)}).catch(R=>Fi(R,Ue.NAVIGATION_CANCELLED)?R:Promise.reject(R))}function W(P,q,Y){l.list().forEach(Q=>b(()=>Q(P,q,Y)))}function A(P,q,Y,Q,me){const E=v(P,q);if(E)return E;const w=q===sn,R=vs?history.state:{};Y&&(Q||w?s.replace(P.fullPath,be({scroll:w&&R&&R.scroll},me)):s.push(P.fullPath,me)),a.value=P,ae(P,q,Y,w),se()}let S;function O(){S||(S=s.listen((P,q,Y)=>{if(!Le.listening)return;const Q=p(P),me=T(Q,Le.currentRoute.value);if(me){I(be(me,{replace:!0,force:!0}),Q).catch(br);return}h=Q;const E=a.value;vs&&oC(dd(E.fullPath,Y.delta),Wl()),G(Q,E).catch(w=>Fi(w,Ue.NAVIGATION_ABORTED|Ue.NAVIGATION_CANCELLED)?w:Fi(w,Ue.NAVIGATION_GUARD_REDIRECT)?(I(be(y(w.to),{force:!0}),Q).then(R=>{Fi(R,Ue.NAVIGATION_ABORTED|Ue.NAVIGATION_DUPLICATED)&&!Y.delta&&Y.type===Sc.pop&&s.go(-1,!1)}).catch(br),Promise.reject()):(Y.delta&&s.go(-Y.delta,!1),V(w,Q,E))).then(w=>{w=w||A(Q,E,!1),w&&(Y.delta&&!Fi(w,Ue.NAVIGATION_CANCELLED)?s.go(-Y.delta,!1):Y.type===Sc.pop&&Fi(w,Ue.NAVIGATION_ABORTED|Ue.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),W(Q,E,w)}).catch(br)}))}let U=lr(),N=lr(),z;function V(P,q,Y){se(P);const Q=N.list();return Q.length?Q.forEach(me=>me(P,q,Y)):console.error(P),Promise.reject(P)}function J(){return z&&a.value!==sn?Promise.resolve():new Promise((P,q)=>{U.add([P,q])})}function se(P){return z||(z=!P,O(),U.list().forEach(([q,Y])=>P?Y(P):q()),U.reset()),P}function ae(P,q,Y,Q){const{scrollBehavior:me}=i;if(!vs||!me)return Promise.resolve();const E=!Y&&lC(dd(P.fullPath,0))||(Q||!Y)&&history.state&&history.state.scroll||null;return ug().then(()=>me(P,q,E)).then(w=>w&&rC(w)).catch(w=>V(w,P,q))}const j=P=>s.go(P);let xe;const ye=new Set,Le={currentRoute:a,listening:!0,addRoute:f,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:_,getRoutes:m,resolve:p,options:i,push:C,replace:x,go:j,back:()=>j(-1),forward:()=>j(1),beforeEach:r.add,beforeResolve:o.add,afterEach:l.add,onError:N.add,isReady:J,install(P){P.component("RouterLink",kC),P.component("RouterView",jC),P.config.globalProperties.$router=Le,Object.defineProperty(P.config.globalProperties,"$route",{enumerable:!0,get:()=>Xe(a)}),vs&&!xe&&a.value===sn&&(xe=!0,C(s.location).catch(Q=>{}));const q={};for(const Q in sn)Object.defineProperty(q,Q,{get:()=>a.value[Q],enumerable:!0});P.provide(Ul,Le),P.provide(Eh,lg(q)),P.provide(bc,a);const Y=P.unmount;ye.add(P),P.unmount=function(){ye.delete(P),ye.size<1&&(h=sn,S&&S(),S=null,a.value=sn,xe=!1,z=!1),Y()}}};function De(P){return P.reduce((q,Y)=>q.then(()=>b(Y)),Promise.resolve())}return Le}function BC(){return ii(Ul)}function hm(i){return ii(Eh)}const Os=rt(!1),um="app-theme",WC=()=>{try{if(typeof window>"u"||!window.localStorage)return null;const i=window.localStorage.getItem(um);return i==="dark"?!0:i==="light"?!1:null}catch{return null}},UC=i=>{try{if(typeof window>"u"||!window.localStorage)return;window.localStorage.setItem(um,i?"dark":"light")}catch{}},dm=i=>{if(typeof document>"u")return;const e=document.documentElement;e.classList.toggle("theme-dark",!!i),e.classList.toggle("theme-light",!i)},Td=WC();Td!==null&&(Os.value=Td);dm(Os.value);ni(Os,i=>{dm(i),UC(i)});function xh(){return{isDark:Os,toggleTheme:()=>{Os.value=!Os.value}}}const Ys=(i,e)=>{const t=i.__vccOpts||i;for(const[n,s]of e)t[n]=s;return t},KC={class:"nav-panel right-panel"},XC={class:"panel-content"},HC={class:"nav-menu"},YC=["onClick"],ZC={class:"submenu"},$C=["title"],qC={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},JC={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},QC={class:"panel-content mobile-trigger-content"},ev={key:0,xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},tv={key:1,xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},iv={class:"panel-content mobile-menu-content"},nv={class:"mobile-menu"},sv=["onClick"],rv={class:"mobile-submenu"},ov={class:"mobile-menu-item"},lv=["title"],av={key:0,xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},cv={key:1,xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},hv={__name:"FloatingNavBar",setup(i){const{isDark:e,toggleTheme:t}=xh(),n=hm(),s=rt(null),r=u=>{s.value=s.value===u?null:u},o=rt(!1),l=()=>{o.value=!1,s.value=null},a=()=>{o.value=!o.value,o.value||(s.value=null)};ni(()=>n.fullPath,()=>{l()});const h=xt(()=>["BlogList","BlogPost","About"].includes(n.name)),c=rt([{title:"",link:"/"},{title:"",link:"/blog"},{title:"",children:[{title:""},{title:""}]},{title:"",link:"/about"}]);return(u,d)=>{const f=mh("router-link");return pe(),Me("nav",{class:Qn(["floating-nav-container",{"with-bg":h.value,"theme-dark":Xe(e),"theme-light":!Xe(e)}])},[Ve(f,{to:"/",class:"nav-panel left-panel"},{default:Jt(()=>[...d[4]||(d[4]=[ee("div",{class:"border-effect"},[ee("svg",{class:"border-svg",xmlns:"http://www.w3.org/2000/svg"},[ee("rect",{class:"border-rect",x:"0",y:"0",width:"100%",height:"100%",rx:"16",ry:"16",pathLength:"100"})])],-1),ee("div",{class:"panel-content"},[ee("img",{src:F0,class:"logo-icon",alt:"Logo"}),ee("span",{class:"logo-text"},"Dawn")],-1)])]),_:1}),ee("div",KC,[d[8]||(d[8]=ee("div",{class:"border-effect"},[ee("svg",{class:"border-svg",xmlns:"http://www.w3.org/2000/svg"},[ee("rect",{class:"border-rect",x:"0",y:"0",width:"100%",height:"100%",rx:"16",ry:"16",pathLength:"100"})])],-1)),ee("div",XC,[ee("ul",HC,[(pe(!0),Me(He,null,So(c.value,(g,m)=>(pe(),Me("li",{key:m,class:Qn(["menu-item",{open:s.value===m}])},[g.children?(pe(),Me(He,{key:0},[ee("span",{class:"menu-link",onClick:_=>r(m)},[Bn(ji(g.title)+" ",1),d[5]||(d[5]=ee("span",{class:"arrow-icon"},"",-1))],8,YC),ee("ul",ZC,[(pe(!0),Me(He,null,So(g.children,(_,p)=>(pe(),Me("li",{key:p,class:"submenu-item"},[Ve(f,{to:_.link||"#",class:"submenu-link",onClick:d[0]||(d[0]=y=>s.value=null)},{default:Jt(()=>[Bn(ji(_.title),1)]),_:2},1032,["to"])]))),128))])],64)):(pe(),si(f,{key:1,to:g.link||"#",class:"menu-link"},{default:Jt(()=>[Bn(ji(g.title),1)]),_:2},1032,["to"]))],2))),128)),ee("li",{class:"menu-item theme-toggle-item",onClick:d[1]||(d[1]=(...g)=>Xe(t)&&Xe(t)(...g))},[ee("span",{class:"menu-link theme-toggle-btn",title:Xe(e)?"":""},[Xe(e)?(pe(),Me("svg",qC,[...d[6]||(d[6]=[ee("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},null,-1)])])):(pe(),Me("svg",JC,[...d[7]||(d[7]=[Kg('<circle cx="12" cy="12" r="5" data-v-0b194b94></circle><line x1="12" y1="1" x2="12" y2="3" data-v-0b194b94></line><line x1="12" y1="21" x2="12" y2="23" data-v-0b194b94></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-v-0b194b94></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-v-0b194b94></line><line x1="1" y1="12" x2="3" y2="12" data-v-0b194b94></line><line x1="21" y1="12" x2="23" y2="12" data-v-0b194b94></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-v-0b194b94></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-v-0b194b94></line>',9)])]))],8,$C)])])])]),ee("div",{class:"nav-panel mobile-trigger",onClick:a},[d[11]||(d[11]=ee("div",{class:"border-effect"},[ee("svg",{class:"border-svg",xmlns:"http://www.w3.org/2000/svg"},[ee("rect",{class:"border-rect",x:"0",y:"0",width:"100%",height:"100%",rx:"16",ry:"16",pathLength:"100"})])],-1)),ee("div",QC,[o.value?(pe(),Me("svg",tv,[...d[10]||(d[10]=[ee("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),ee("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)])])):(pe(),Me("svg",ev,[...d[9]||(d[9]=[ee("line",{x1:"3",y1:"12",x2:"21",y2:"12"},null,-1),ee("line",{x1:"3",y1:"6",x2:"21",y2:"6"},null,-1),ee("line",{x1:"3",y1:"18",x2:"21",y2:"18"},null,-1)])]))])]),Ve(rl,{name:"fade"},{default:Jt(()=>[o.value?(pe(),Me("div",{key:0,class:"mobile-menu-overlay",onClick:l})):Gs("",!0)]),_:1}),Ve(rl,{name:"slide-fade"},{default:Jt(()=>[o.value?(pe(),Me("div",{key:0,class:"nav-panel mobile-menu-drawer",onClick:d[3]||(d[3]=b0(()=>{},["stop"]))},[ee("div",iv,[ee("ul",nv,[(pe(!0),Me(He,null,So(c.value,(g,m)=>(pe(),Me("li",{key:`m-${m}`,class:"mobile-menu-item"},[g.children?(pe(),Me(He,{key:0},[ee("button",{type:"button",class:"mobile-menu-link",onClick:_=>r(m)},[ee("span",null,ji(g.title),1),d[12]||(d[12]=ee("span",{class:"arrow-icon"},"",-1))],8,sv),Xp(ee("div",rv,[(pe(!0),Me(He,null,So(g.children,(_,p)=>(pe(),si(f,{key:`m-${m}-${p}`,to:_.link||"#",class:"mobile-submenu-link",onClick:l},{default:Jt(()=>[Bn(ji(_.title),1)]),_:2},1032,["to"]))),128))],512),[[u0,s.value===m]])],64)):(pe(),si(f,{key:1,to:g.link||"#",class:"mobile-menu-link",onClick:l},{default:Jt(()=>[Bn(ji(g.title),1)]),_:2},1032,["to"]))]))),128)),ee("li",ov,[ee("button",{type:"button",class:"mobile-menu-link mobile-theme-toggle",onClick:d[2]||(d[2]=(...g)=>Xe(t)&&Xe(t)(...g)),title:Xe(e)?"":""},[Xe(e)?(pe(),Me("svg",av,[...d[13]||(d[13]=[ee("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},null,-1)])])):(pe(),Me("svg",cv,[...d[14]||(d[14]=[ee("circle",{cx:"12",cy:"12",r:"5"},null,-1),ee("line",{x1:"12",y1:"1",x2:"12",y2:"3"},null,-1),ee("line",{x1:"12",y1:"21",x2:"12",y2:"23"},null,-1),ee("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},null,-1),ee("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},null,-1),ee("line",{x1:"1",y1:"12",x2:"3",y2:"12"},null,-1),ee("line",{x1:"21",y1:"12",x2:"23",y2:"12"},null,-1),ee("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},null,-1),ee("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},null,-1)])]))],8,lv)])])])])):Gs("",!0)]),_:1})],2)}}},uv=Ys(hv,[["__scopeId","data-v-0b194b94"]]),dv={key:0,class:"loading-overlay"},fv={__name:"Loading",props:{loading:{type:Boolean,default:!1},text:{type:String,default:"..."}},setup(i){return(e,t)=>(pe(),si(rl,{name:"fade"},{default:Jt(()=>[i.loading?(pe(),Me("div",dv,[t[0]||(t[0]=ee("div",{class:"spinner"},null,-1)),ee("p",null,ji(i.text),1)])):Gs("",!0)]),_:1}))}},gv=Ys(fv,[["__scopeId","data-v-bbe7a72a"]]),Da=rt(!1),Sd=rt("...");function wh(){return{isLoading:Da,loadingText:Sd,showLoading:(t="...")=>{Sd.value=t,Da.value=!0},hideLoading:()=>{Da.value=!1}}}const ka=rt(null);function Rh(){return{appError:ka,setAppError:t=>{ka.value=t||new Error("Unknown error")},clearAppError:()=>{ka.value=null}}}const mv={class:"nf-page"},_v={class:"nf-center"},pv={__name:"NotFound",setup(i){const{clearAppError:e}=Rh();return(t,n)=>{const s=mh("router-link");return pe(),Me("main",mv,[ee("div",_v,[n[1]||(n[1]=ee("div",{class:"nf-code"},"404",-1)),Ve(s,{to:"/",class:"nf-home",onClick:Xe(e)},{default:Jt(()=>[...n[0]||(n[0]=[Bn("",-1)])]),_:1},8,["onClick"])])])}}},fm=Ys(pv,[["__scopeId","data-v-0e860860"]]),yv=Object.freeze(Object.defineProperty({__proto__:null,default:fm},Symbol.toStringTag,{value:"Module"})),Cv={__name:"App",setup(i){const{isLoading:e,loadingText:t}=wh(),n=hm(),{appError:s,clearAppError:r}=Rh(),o=xt(()=>s.value?!0:n.name==="NotFound");return ni(()=>n.fullPath,()=>{s.value&&r()}),(l,a)=>{const h=mh("router-view");return pe(),Me(He,null,[Ve(gv,{loading:Xe(e),text:Xe(t)},null,8,["loading","text"]),o.value?Gs("",!0):(pe(),si(uv,{key:0})),Xe(s)?(pe(),si(fm,{key:1})):(pe(),si(h,{key:2}))],64)}}},vv={key:0,viewBox:"0 0 24 24",width:"16",height:"16",stroke:"currentColor","stroke-width":"2",fill:"none"},Ev={key:1,viewBox:"0 0 24 24",width:"18",height:"18",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},xv={key:2,viewBox:"0 0 24 24",width:"18",height:"18",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},wv={key:3,viewBox:"0 0 24 24",width:"18",height:"18",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Rv={class:"toast-text"},Tv={__name:"Toast",props:{visible:{type:Boolean,default:!1},message:{type:String,default:""},position:{type:String,default:"bottom",validator:i=>["bottom","top","center"].includes(i)},duration:{type:Number,default:2e3},type:{type:String,default:"default",validator:i=>["success","info","warning","error","default"].includes(i)}},emits:["update:visible","close"],setup(i,{emit:e}){const t=i,n=e;let s=null;const r=xt(()=>t.position==="top"?"fade-down":t.position==="center"?"fade":"fade-up"),o=xt(()=>({})),l=()=>{s&&clearTimeout(s),t.duration>0&&(s=setTimeout(()=>{a()},t.duration))},a=()=>{n("update:visible",!1),n("close")};return ni(()=>t.visible,h=>{h?l():s&&clearTimeout(s)}),Vl(()=>{s&&clearTimeout(s)}),(h,c)=>(pe(),si(rl,{name:r.value},{default:Jt(()=>[i.visible?(pe(),Me("div",{key:0,class:Qn(["toast-message",[`position-${i.position}`,`type-${i.type}`]]),style:Fl(o.value)},[gy(h.$slots,"icon",{},()=>[i.type==="default"||i.type==="success"?(pe(),Me("svg",vv,[...c[0]||(c[0]=[ee("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):i.type==="info"?(pe(),Me("svg",Ev,[...c[1]||(c[1]=[ee("circle",{cx:"12",cy:"12",r:"10"},null,-1),ee("line",{x1:"12",y1:"16",x2:"12",y2:"12"},null,-1),ee("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"},null,-1)])])):i.type==="warning"?(pe(),Me("svg",xv,[...c[2]||(c[2]=[ee("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"},null,-1),ee("line",{x1:"12",y1:"9",x2:"12",y2:"13"},null,-1),ee("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"},null,-1)])])):i.type==="error"?(pe(),Me("svg",wv,[...c[3]||(c[3]=[ee("circle",{cx:"12",cy:"12",r:"10"},null,-1),ee("line",{x1:"15",y1:"9",x2:"9",y2:"15"},null,-1),ee("line",{x1:"9",y1:"9",x2:"15",y2:"15"},null,-1)])])):Gs("",!0)],!0),ee("span",Rv,ji(i.message),1)],6)):Gs("",!0)]),_:3},8,["name"]))}},Sv=Ys(Tv,[["__scopeId","data-v-a57f5655"]]),It={ADD:"add",REMOVE:"remove"},Bs={PROPERTYCHANGE:"propertychange"},le={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Kl{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Iv(i,e,t){let n,s;t=t||xi;let r=0,o=i.length,l=!1;for(;r<o;)n=r+(o-r>>1),s=+t(i[n],e),s<0?r=n+1:(o=n,l=!s);return l?r:~r}function xi(i,e){return i>e?1:i<e?-1:0}function bv(i,e){return i<e?1:i>e?-1:0}function Xl(i,e,t){if(i[0]<=e)return 0;const n=i.length;if(e<=i[n-1])return n-1;if(typeof t=="function"){for(let s=1;s<n;++s){const r=i[s];if(r===e)return s;if(r<e)return t(e,i[s-1],r)>0?s-1:s}return n-1}if(t>0){for(let s=1;s<n;++s)if(i[s]<e)return s-1;return n-1}if(t<0){for(let s=1;s<n;++s)if(i[s]<=e)return s;return n-1}for(let s=1;s<n;++s){if(i[s]==e)return s;if(i[s]<e)return i[s-1]-e<e-i[s]?s-1:s}return n-1}function Av(i,e,t){for(;e<t;){const n=i[e];i[e]=i[t],i[t]=n,++e,--t}}function ri(i,e){const t=Array.isArray(e)?e:[e],n=t.length;for(let s=0;s<n;s++)i[i.length]=t[s]}function bn(i,e){const t=i.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(i[n]!==e[n])return!1;return!0}function Lv(i,e,t){const n=e||xi;return i.every(function(s,r){if(r===0)return!0;const o=n(i[r-1],s);return!(o>0||o===0)})}function jr(){return!0}function Hl(){return!1}function zr(){}function gm(i){let e,t,n;return function(){const s=Array.prototype.slice.call(arguments);return(!t||this!==n||!bn(s,t))&&(n=this,t=s,e=i.apply(this,arguments)),e}}function mm(i){function e(){let t;try{t=i()}catch(n){return Promise.reject(n)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function ro(i){for(const e in i)delete i[e]}function es(i){let e;for(e in i)return!1;return!e}class bi{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class oo extends Kl{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const n=this.listeners_||(this.listeners_={}),s=n[e]||(n[e]=[]);s.includes(t)||s.push(t)}dispatchEvent(e){const t=typeof e=="string",n=t?e:e.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const r=t?new bi(e):e;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,l[n]=0),++o[n];let a;for(let h=0,c=s.length;h<c;++h)if("handleEvent"in s[h]?a=s[h].handleEvent(r):a=s[h].call(this,r),a===!1||r.propagationStopped){a=!1;break}if(--o[n]===0){let h=l[n];for(delete l[n];h--;)this.removeEventListener(n,zr);delete o[n]}return a}disposeInternal(){this.listeners_&&ro(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const n=this.listeners_[e];if(!n)return;const s=n.indexOf(t);s!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(n[s]=zr,++this.pendingRemovals_[e]):(n.splice(s,1),n.length===0&&delete this.listeners_[e]))}}function Ee(i,e,t,n,s){if(s){const o=t;t=function(l){return i.removeEventListener(e,t),o.call(n??this,l)}}else n&&n!==i&&(t=t.bind(n));const r={target:i,type:e,listener:t};return i.addEventListener(e,t),r}function ll(i,e,t,n){return Ee(i,e,t,n,!0)}function Ne(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),ro(i))}class lo extends oo{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(le.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const n=e.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=Ee(this,e[r],t);return s}return Ee(this,e,t)}onceInternal(e,t){let n;if(Array.isArray(e)){const s=e.length;n=new Array(s);for(let r=0;r<s;++r)n[r]=ll(this,e[r],t)}else n=ll(this,e,t);return t.ol_key=n,n}unInternal(e,t){const n=t.ol_key;if(n)Qt(n);else if(Array.isArray(e))for(let s=0,r=e.length;s<r;++s)this.removeEventListener(e[s],t);else this.removeEventListener(e,t)}}lo.prototype.on;lo.prototype.once;lo.prototype.un;function Qt(i){if(Array.isArray(i))for(let e=0,t=i.length;e<t;++e)Ne(i[e]);else Ne(i)}function ge(){throw new Error("Unimplemented abstract method.")}let Pv=0;function de(i){return i.ol_uid||(i.ol_uid=String(++Pv))}class Id extends bi{constructor(e,t,n){super(e),this.key=t,this.oldValue=n}}class di extends lo{constructor(e){super(),this.on,this.once,this.un,de(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let n;n=`change:${e}`,this.hasListener(n)&&this.dispatchEvent(new Id(n,e,t)),n=Bs.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Id(n,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,n){const s=this.values_||(this.values_={});if(n)s[e]=t;else{const r=s[e];s[e]=t,r!==t&&this.notify(e,r)}}setProperties(e,t){for(const n in e)this.set(n,e[n],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const n=this.values_[e];delete this.values_[e],es(this.values_)&&(this.values_=null),t||this.notify(e,n)}}}const bd={LENGTH:"length"};class Io extends bi{constructor(e,t,n){super(e),this.element=t,this.index=n}}class Wt extends di{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let n=1,s=this.array_.length;n<s;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,n=e.length;t<n;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let n=0,s=t.length;n<s;++n)e(t[n],n,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(bd.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Io(It.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let n=0,s=t.length;n<s;++n)if(t[n]===e)return this.removeAt(n)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Io(It.REMOVE,t,e)),t}setAt(e,t){const n=this.getLength();if(e>=n){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const s=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Io(It.REMOVE,s,e)),this.dispatchEvent(new Io(It.ADD,t,e))}updateLength_(){this.set(bd.LENGTH,this.array_.length)}assertUnique_(e,t){const n=this.array_;for(let s=0,r=n.length;s<r;++s)if(n[s]===e&&s!==t)throw new Error("Duplicate item added to a unique collection")}}class Es extends bi{constructor(e,t,n){super(e),this.map=t,this.frameState=n!==void 0?n:null}}class un extends Es{constructor(e,t,n,s,r,o){super(e,t,r),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0?s:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const We={SINGLECLICK:"singleclick",CLICK:le.CLICK,DBLCLICK:le.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ts=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Mv=ts.includes("safari")&&!ts.includes("chrom");Mv&&(ts.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ts));const Ov=ts.includes("webkit")&&!ts.includes("edge"),_m=ts.includes("macintosh"),pm=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ut=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Th=typeof Image<"u"&&Image.prototype.decode,ym=typeof createImageBitmap=="function",Cm=(function(){let i=!1;try{const e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return i})(),Ac={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class Fv extends oo{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=Ee(n,Ac.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Ee(n,Ac.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(le.TOUCHMOVE,this.boundHandleTouchMove_,Cm?{passive:!1}:!1)}emulateClick_(e){let t=new un(We.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new un(We.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new un(We.SINGLECLICK,this.map_,e);this.dispatchEvent(n)},250)}updateActivePointers_(e){const t=e,n=t.pointerId;if(t.type==We.POINTERUP||t.type==We.POINTERCANCEL){delete this.trackedTouches_[n];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==t.target){delete this.trackedTouches_[s];break}}else(t.type==We.POINTERDOWN||t.type==We.POINTERMOVE)&&(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new un(We.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ne),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new un(We.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Ee(n,We.POINTERMOVE,this.handlePointerMove_,this),Ee(n,We.POINTERUP,this.handlePointerUp_,this),Ee(this.element_,We.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(Ee(this.element_.getRootNode(),We.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new un(We.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new un(We.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ne(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(le.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ne(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ne),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Vi={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ut={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},$={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function we(i,e){if(!i)throw new Error(e)}const al=1/0;class Dv{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ro(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const s=this.keyFunction_(n);return delete this.queuedElements_[s],n}enqueue(e){we(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=al?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,n=this.priorities_,s=t.length,r=t[e],o=n[e],l=e;for(;e<s>>1;){const a=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),c=h<s&&n[h]<n[a]?h:a;t[e]=t[c],n[e]=n[c],e=c}t[e]=r,n[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const n=this.elements_,s=this.priorities_,r=n[t],o=s[t];for(;t>e;){const l=this.getParentIndex_(t);if(s[l]>o)n[t]=n[l],s[t]=s[l],t=l;else break}n[t]=r,s[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,n=this.priorities_;let s=0;const r=t.length;let o,l,a;for(l=0;l<r;++l)o=t[l],a=e(o),a==al?delete this.queuedElements_[this.keyFunction_(o)]:(n[s]=a,t[s++]=o);t.length=s,n.length=s,this.heapify_()}}class kv extends Dv{constructor(e,t){super(n=>e.apply(null,n),n=>n[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(le.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,n=t.getState();if(n===$.LOADED||n===$.ERROR||n===$.EMPTY){n!==$.ERROR&&t.removeEventListener(le.CHANGE,this.boundHandleTileChange_);const s=t.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let n=0;for(;this.tilesLoading_<e&&n<t&&this.getCount()>0;){const s=this.dequeue()[0],r=s.getKey();s.getState()===$.IDLE&&!(r in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++n,s.load())}}}function Nv(i,e,t,n,s){if(!i||!(t in i.wantedTiles)||!i.wantedTiles[t][e.getKey()])return al;const r=i.viewState.center,o=n[0]-r[0],l=n[1]-r[1];return 65536*Math.log(s)+Math.sqrt(o*o+l*l)/s}const je={ANIMATING:0,INTERACTING:1},qt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function ze(i,e,t){return Math.min(Math.max(i,e),t)}function Gv(i,e,t,n,s,r){const o=s-t,l=r-n;if(o!==0||l!==0){const a=((i-t)*o+(e-n)*l)/(o*o+l*l);a>1?(t=s,n=r):a>0&&(t+=o*a,n+=l*a)}return qn(i,e,t,n)}function qn(i,e,t,n){const s=t-i,r=n-e;return s*s+r*r}function Vv(i){const e=i.length;for(let n=0;n<e;n++){let s=n,r=Math.abs(i[n][n]);for(let l=n+1;l<e;l++){const a=Math.abs(i[l][n]);a>r&&(r=a,s=l)}if(r===0)return null;const o=i[s];i[s]=i[n],i[n]=o;for(let l=n+1;l<e;l++){const a=-i[l][n]/i[n][n];for(let h=n;h<e+1;h++)n==h?i[l][h]=0:i[l][h]+=a*i[n][h]}}const t=new Array(e);for(let n=e-1;n>=0;n--){t[n]=i[n][e]/i[n][n];for(let s=n-1;s>=0;s--)i[s][e]-=i[s][n]*t[n]}return t}function cl(i){return i*180/Math.PI}function wi(i){return i*Math.PI/180}function Jn(i,e){const t=i%e;return t*e<0?t+e:t}function Ot(i,e,t){return i+t*(e-i)}function ao(i,e){const t=Math.pow(10,e);return Math.round(i*t)/t}function Ad(i,e){return Math.round(ao(i,e))}function Ts(i,e){return Math.floor(ao(i,e))}function pn(i,e){return Math.ceil(ao(i,e))}function Lc(i,e,t){if(i>=e&&i<t)return i;const n=t-e;return((i-e)%n+n)%n+e}function Ld(i,e,t){return(function(n,s,r,o,l){if(!n)return;if(!s&&!e)return n;const a=e?0:r[0]*s,h=e?0:r[1]*s,c=l?l[0]:0,u=l?l[1]:0;let d=i[0]+a/2+c,f=i[2]-a/2+c,g=i[1]+h/2+u,m=i[3]-h/2+u;d>f&&(d=(f+d)/2,f=d),g>m&&(g=(m+g)/2,m=g);let _=ze(n[0],d,f),p=ze(n[1],g,m);if(o&&t&&s){const y=30*s;_+=-y*Math.log(1+Math.max(0,d-n[0])/y)+y*Math.log(1+Math.max(0,n[0]-f)/y),p+=-y*Math.log(1+Math.max(0,g-n[1])/y)+y*Math.log(1+Math.max(0,n[1]-m)/y)}return[_,p]})}function jv(i){return i}const tt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function hl(i){const e=wt();for(let t=0,n=i.length;t<n;++t)Ar(e,i[t]);return e}function zv(i,e,t){const n=Math.min.apply(null,i),s=Math.min.apply(null,e),r=Math.max.apply(null,i),o=Math.max.apply(null,e);return $i(n,s,r,o,t)}function oi(i,e,t){return t?(t[0]=i[0]-e,t[1]=i[1]-e,t[2]=i[2]+e,t[3]=i[3]+e,t):[i[0]-e,i[1]-e,i[2]+e,i[3]+e]}function vm(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i.slice()}function Zs(i,e,t){let n,s;return e<i[0]?n=i[0]-e:i[2]<e?n=e-i[2]:n=0,t<i[1]?s=i[1]-t:i[3]<t?s=t-i[3]:s=0,n*n+s*s}function is(i,e){return Sh(i,e[0],e[1])}function yi(i,e){return i[0]<=e[0]&&e[2]<=i[2]&&i[1]<=e[1]&&e[3]<=i[3]}function Sh(i,e,t){return i[0]<=e&&e<=i[2]&&i[1]<=t&&t<=i[3]}function Pc(i,e){const t=i[0],n=i[1],s=i[2],r=i[3],o=e[0],l=e[1];let a=tt.UNKNOWN;return o<t?a=a|tt.LEFT:o>s&&(a=a|tt.RIGHT),l<n?a=a|tt.BELOW:l>r&&(a=a|tt.ABOVE),a===tt.UNKNOWN&&(a=tt.INTERSECTING),a}function wt(){return[1/0,1/0,-1/0,-1/0]}function $i(i,e,t,n,s){return s?(s[0]=i,s[1]=e,s[2]=t,s[3]=n,s):[i,e,t,n]}function co(i){return $i(1/0,1/0,-1/0,-1/0,i)}function Ih(i,e){const t=i[0],n=i[1];return $i(t,n,t,n,e)}function bh(i,e,t,n,s){const r=co(s);return xm(r,i,e,t,n)}function ns(i,e){return i[0]==e[0]&&i[2]==e[2]&&i[1]==e[1]&&i[3]==e[3]}function Em(i,e){return e[0]<i[0]&&(i[0]=e[0]),e[2]>i[2]&&(i[2]=e[2]),e[1]<i[1]&&(i[1]=e[1]),e[3]>i[3]&&(i[3]=e[3]),i}function Ar(i,e){e[0]<i[0]&&(i[0]=e[0]),e[0]>i[2]&&(i[2]=e[0]),e[1]<i[1]&&(i[1]=e[1]),e[1]>i[3]&&(i[3]=e[1])}function xm(i,e,t,n,s){for(;t<n;t+=s)Bv(i,e[t],e[t+1]);return i}function Bv(i,e,t){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}function wm(i,e){let t;return t=e(Yl(i)),t||(t=e(Zl(i)),t)||(t=e($l(i)),t)||(t=e(An(i)),t)?t:!1}function Mc(i){let e=0;return ls(i)||(e=ve(i)*Ye(i)),e}function Yl(i){return[i[0],i[1]]}function Zl(i){return[i[2],i[1]]}function $t(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function Wv(i,e){let t;if(e==="bottom-left")t=Yl(i);else if(e==="bottom-right")t=Zl(i);else if(e==="top-left")t=An(i);else if(e==="top-right")t=$l(i);else throw new Error("Invalid corner");return t}function Br(i,e,t,n,s){const[r,o,l,a,h,c,u,d]=Rm(i,e,t,n);return $i(Math.min(r,l,h,u),Math.min(o,a,c,d),Math.max(r,l,h,u),Math.max(o,a,c,d),s)}function Rm(i,e,t,n){const s=e*n[0]/2,r=e*n[1]/2,o=Math.cos(t),l=Math.sin(t),a=s*o,h=s*l,c=r*o,u=r*l,d=i[0],f=i[1];return[d-a+u,f-h-c,d-a-u,f-h+c,d+a-u,f+h+c,d+a+u,f+h-c,d-a+u,f-h-c]}function Ye(i){return i[3]-i[1]}function li(i,e,t){const n=t||wt();return Ke(i,e)?(i[0]>e[0]?n[0]=i[0]:n[0]=e[0],i[1]>e[1]?n[1]=i[1]:n[1]=e[1],i[2]<e[2]?n[2]=i[2]:n[2]=e[2],i[3]<e[3]?n[3]=i[3]:n[3]=e[3]):co(n),n}function An(i){return[i[0],i[3]]}function $l(i){return[i[2],i[3]]}function ve(i){return i[2]-i[0]}function Ke(i,e){return i[0]<=e[2]&&i[2]>=e[0]&&i[1]<=e[3]&&i[3]>=e[1]}function ls(i){return i[2]<i[0]||i[3]<i[1]}function Uv(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i}function Kv(i,e,t){let n=!1;const s=Pc(i,e),r=Pc(i,t);if(s===tt.INTERSECTING||r===tt.INTERSECTING)n=!0;else{const o=i[0],l=i[1],a=i[2],h=i[3],c=e[0],u=e[1],d=t[0],f=t[1],g=(f-u)/(d-c);let m,_;r&tt.ABOVE&&!(s&tt.ABOVE)&&(m=d-(f-h)/g,n=m>=o&&m<=a),!n&&r&tt.RIGHT&&!(s&tt.RIGHT)&&(_=f-(d-a)*g,n=_>=l&&_<=h),!n&&r&tt.BELOW&&!(s&tt.BELOW)&&(m=d-(f-l)/g,n=m>=o&&m<=a),!n&&r&tt.LEFT&&!(s&tt.LEFT)&&(_=f-(d-o)*g,n=_>=l&&_<=h)}return n}function Xv(i,e,t,n){if(ls(i))return co(t);let s=[];if(n>1){const l=i[2]-i[0],a=i[3]-i[1];for(let h=0;h<n;++h)s.push(i[0]+l*h/n,i[1],i[2],i[1]+a*h/n,i[2]-l*h/n,i[3],i[0],i[3]-a*h/n)}else s=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]];e(s,s,2);const r=[],o=[];for(let l=0,a=s.length;l<a;l+=2)r.push(s[l]),o.push(s[l+1]);return zv(r,o,t)}function Tm(i,e){const t=e.getExtent(),n=$t(i);if(e.canWrapX()&&(n[0]<t[0]||n[0]>=t[2])){const s=ve(t),o=Math.floor((n[0]-t[0])/s)*s;i[0]-=o,i[2]-=o}return i}function Sm(i,e,t){if(e.canWrapX()){const n=e.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[n[0],i[1],n[2],i[3]]];Tm(i,e);const s=ve(n);if(ve(i)>s&&!t)return[[n[0],i[1],n[2],i[3]]];if(i[0]<n[0])return[[i[0]+s,i[1],n[2],i[3]],[n[0],i[1],i[2],i[3]]];if(i[2]>n[2])return[[i[0],i[1],n[2],i[3]],[n[0],i[1],i[2]-s,i[3]]]}return[i]}function Ah(i,e){const t=(""+i).split("."),n=(""+e).split(".");for(let s=0;s<Math.max(t.length,n.length);s++){const r=parseInt(t[s]||"0",10),o=parseInt(n[s]||"0",10);if(r>o)return 1;if(o>r)return-1}return 0}function Im(i,e){return i[0]+=+e[0],i[1]+=+e[1],i}function ul(i,e){let t=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=e[n]){t=!1;break}return t}function Lh(i,e){const t=Math.cos(e),n=Math.sin(e),s=i[0]*t-i[1]*n,r=i[1]*t+i[0]*n;return i[0]=s,i[1]=r,i}function bm(i,e){return i[0]*=e,i[1]*=e,i}function Ph(i,e){if(e.canWrapX()){const t=ve(e.getExtent()),n=Hv(i,e,t);n&&(i[0]-=n*t)}return i}function Hv(i,e,t){const n=e.getExtent();let s=0;return e.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(t=t||ve(n),s=Math.floor((i[0]-n[0])/t)),s}function Am(i){return Math.pow(i,3)}function $s(i){return 1-Am(1-i)}function Yv(i){return 3*i*i-2*i*i*i}function Zv(i){return i}const Lm=63710088e-1;function Pd(i,e,t){t=t||Lm;const n=wi(i[1]),s=wi(e[1]),r=(s-n)/2,o=wi(e[0]-i[0])/2,l=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(s);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function $v(i,e,t,n){n=n||Lm;const s=wi(i[1]),r=wi(i[0]),o=e/n,l=Math.asin(Math.sin(s)*Math.cos(o)+Math.cos(s)*Math.sin(o)*Math.cos(t)),a=r+Math.atan2(Math.sin(t)*Math.sin(o)*Math.cos(s),Math.cos(o)-Math.sin(s)*Math.sin(l));return[cl(a),cl(l)]}function Pm(...i){console.warn(...i)}const Mh={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class ql{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Mh[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const ho=6378137,Ss=Math.PI*ho,qv=[-Ss,-Ss,Ss,Ss],Jv=[-180,-85,180,85],bo=ho*Math.log(Math.tan(Math.PI/2));class hs extends ql{constructor(e){super({code:e,units:"m",extent:qv,global:!0,worldExtent:Jv,getPointResolution:function(t,n){return t/Math.cosh(n[1]/ho)}})}}const Md=[new hs("EPSG:3857"),new hs("EPSG:102100"),new hs("EPSG:102113"),new hs("EPSG:900913"),new hs("http://www.opengis.net/def/crs/EPSG/0/3857"),new hs("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Qv(i,e,t,n){const s=i.length;t=t>1?t:2,n=n??t,e===void 0&&(t>2?e=i.slice():e=new Array(s));for(let r=0;r<s;r+=n){e[r]=Ss*i[r]/180;let o=ho*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));o>bo?o=bo:o<-bo&&(o=-bo),e[r+1]=o}return e}function eE(i,e,t,n){const s=i.length;t=t>1?t:2,n=n??t,e===void 0&&(t>2?e=i.slice():e=new Array(s));for(let r=0;r<s;r+=n)e[r]=180*i[r]/Ss,e[r+1]=360*Math.atan(Math.exp(i[r+1]/ho))/Math.PI-90;return e}const tE=6378137,Od=[-180,-90,180,90],iE=Math.PI*tE/180;class Nn extends ql{constructor(e,t){super({code:e,units:"degrees",extent:Od,axisOrientation:t,global:!0,metersPerUnit:iE,worldExtent:Od})}}const Fd=[new Nn("CRS:84"),new Nn("EPSG:4326","neu"),new Nn("urn:ogc:def:crs:OGC:1.3:CRS84"),new Nn("urn:ogc:def:crs:OGC:2:84"),new Nn("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Nn("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Nn("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Oc={};function nE(i){return Oc[i]||Oc[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function sE(i,e){Oc[i]=e}let Fs={};function Wr(i,e,t){const n=i.getCode(),s=e.getCode();n in Fs||(Fs[n]={}),Fs[n][s]=t}function Na(i,e){return i in Fs&&e in Fs[i]?Fs[i][e]:null}const dl=.9996,Yt=.00669438,Jl=Yt*Yt,Ql=Jl*Yt,Kn=Yt/(1-Yt),Dd=Math.sqrt(1-Yt),Ws=(1-Dd)/(1+Dd),Mm=Ws*Ws,Oh=Mm*Ws,Fh=Oh*Ws,Om=Fh*Ws,Fm=1-Yt/4-3*Jl/64-5*Ql/256,rE=3*Yt/8+3*Jl/32+45*Ql/1024,oE=15*Jl/256+45*Ql/1024,lE=35*Ql/3072,aE=3/2*Ws-27/32*Oh+269/512*Om,cE=21/16*Mm-55/32*Fh,hE=151/96*Oh-417/128*Om,uE=1097/512*Fh,fl=6378137;function dE(i,e,t){const n=i-5e5,o=(t.north?e:e-1e7)/dl/(fl*Fm),l=o+aE*Math.sin(2*o)+cE*Math.sin(4*o)+hE*Math.sin(6*o)+uE*Math.sin(8*o),a=Math.sin(l),h=a*a,c=Math.cos(l),u=a/c,d=u*u,f=d*d,g=1-Yt*h,m=Math.sqrt(1-Yt*h),_=fl/m,p=(1-Yt)/g,y=Kn*c**2,v=y*y,C=n/(_*dl),x=C*C,T=x*C,I=T*C,L=I*C,b=L*C,G=l-u/p*(x/2-I/24*(5+3*d+10*y-4*v-9*Kn))+b/720*(61+90*d+298*y+45*f-252*Kn-3*v);let W=(C-T/6*(1+2*d+y)+L/120*(5-2*y+28*d-3*v+8*Kn+24*f))/c;return W=Lc(W+wi(Dm(t.number)),-Math.PI,Math.PI),[cl(W),cl(G)]}const kd=-80,Nd=84,fE=-180,gE=180;function mE(i,e,t){i=Lc(i,fE,gE),e<kd?e=kd:e>Nd&&(e=Nd);const n=wi(e),s=Math.sin(n),r=Math.cos(n),o=s/r,l=o*o,a=l*l,h=wi(i),c=Dm(t.number),u=wi(c),d=fl/Math.sqrt(1-Yt*s**2),f=Kn*r**2,g=r*Lc(h-u,-Math.PI,Math.PI),m=g*g,_=m*g,p=_*g,y=p*g,v=y*g,C=fl*(Fm*n-rE*Math.sin(2*n)+oE*Math.sin(4*n)-lE*Math.sin(6*n)),x=dl*d*(g+_/6*(1-l+f)+y/120*(5-18*l+a+72*f-58*Kn))+5e5;let T=dl*(C+d*o*(m/2+p/24*(5-l+9*f+4*f**2)+v/720*(61-58*l+a+600*f-330*Kn)));return t.north||(T+=1e7),[x,T]}function Dm(i){return(i-1)*6-180+3}const _E=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function km(i){let e=0;for(const s of _E){const r=i.match(s);if(r){e=parseInt(r[1]);break}}if(!e)return null;let t=0,n=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(n=!0,t=e-32600),t?{number:t,north:n}:null}function Gd(i,e){return function(t,n,s,r){const o=t.length;s=s>1?s:2,r=r??s,n||(s>2?n=t.slice():n=new Array(o));for(let l=0;l<o;l+=r){const a=t[l],h=t[l+1],c=i(a,h,e);n[l]=c[0],n[l+1]=c[1]}return n}}function pE(i){return km(i)?new ql({code:i,units:"m"}):null}function yE(i){const e=km(i.getCode());return e?{forward:Gd(mE,e),inverse:Gd(dE,e)}:null}const CE=[yE],vE=[pE];let Fc=!0;function Nm(i){Fc=!1}function Dh(i,e){if(e!==void 0){for(let t=0,n=i.length;t<n;++t)e[t]=i[t];e=e}else e=i.slice();return e}function Dc(i){sE(i.getCode(),i),Wr(i,i,Dh)}function EE(i){i.forEach(Dc)}function Oe(i){if(typeof i!="string")return i;const e=nE(i);if(e)return e;for(const t of vE){const n=t(i);if(n)return n}return null}function Vd(i,e,t,n){i=Oe(i);let s;const r=i.getPointResolutionFunc();if(r)s=r(e,t);else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")s=e;else{const l=ea(i,Oe("EPSG:4326"));if(!l&&o!=="degrees")s=e*i.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const c=Pd(h.slice(0,2),h.slice(2,4)),u=Pd(h.slice(4,6),h.slice(6,8));s=(c+u)/2}const a=i.getMetersPerUnit();a!==void 0&&(s/=a)}}return s}function jd(i){EE(i),i.forEach(function(e){i.forEach(function(t){e!==t&&Wr(e,t,Dh)})})}function xE(i,e,t,n){i.forEach(function(s){e.forEach(function(r){Wr(s,r,t),Wr(r,s,n)})})}function kh(i,e){return i?typeof i=="string"?Oe(i):i:Oe(e)}function wE(i){return(function(e,t,n,s){const r=e.length;n=n!==void 0?n:2,s=s??n,t=t!==void 0?t:new Array(r);for(let o=0;o<r;o+=s){const l=i(e.slice(o,o+n)),a=l.length;for(let h=0,c=s;h<c;++h)t[o+h]=h>=a?e[o+h]:l[h]}return t})}function Ao(i,e){return Nm(),qs(i,"EPSG:4326","EPSG:3857")}function vt(i,e){if(i===e)return!0;const t=i.getUnits()===e.getUnits();return(i.getCode()===e.getCode()||ea(i,e)===Dh)&&t}function ea(i,e){const t=i.getCode(),n=e.getCode();let s=Na(t,n);if(s)return s;let r=null,o=null;for(const a of CE)r||(r=a(i)),o||(o=a(e));if(!r&&!o)return null;const l="EPSG:4326";if(o)if(r)s=Ga(r.inverse,o.forward);else{const a=Na(t,l);a&&(s=Ga(a,o.forward))}else{const a=Na(l,n);a&&(s=Ga(r.inverse,a))}return s&&(Dc(i),Dc(e),Wr(i,e,s)),s}function Ga(i,e){return function(t,n,s,r){return n=i(t,n,s,r),e(n,n,s,r)}}function Ti(i,e){const t=Oe(i),n=Oe(e);return ea(t,n)}function qs(i,e,t){const n=Ti(e,t);if(!n){const s=Oe(e).getCode(),r=Oe(t).getCode();throw new Error(`No transform available between ${s} and ${r}`)}return n(i,void 0,i.length)}function Lr(i,e,t,n){const s=Ti(e,t);return Xv(i,s,void 0,n)}let RE=null;function TE(){return RE}function kc(i,e){return i}function Ni(i,e){return Fc&&!ul(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Fc=!1,Pm("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function Nh(i,e){return i}function Ci(i,e){return i}function SE(){jd(Md),jd(Fd),xE(Fd,Md,Qv,eE)}SE();const Gm=new Array(6);function kt(){return[1,0,0,1,0,0]}function zd(i){return Vh(i,1,0,0,1,0,0)}function Gh(i,e){const t=i[0],n=i[1],s=i[2],r=i[3],o=i[4],l=i[5],a=e[0],h=e[1],c=e[2],u=e[3],d=e[4],f=e[5];return i[0]=t*a+s*h,i[1]=n*a+r*h,i[2]=t*c+s*u,i[3]=n*c+r*u,i[4]=t*d+s*f+o,i[5]=n*d+r*f+l,i}function Vh(i,e,t,n,s,r,o){return i[0]=e,i[1]=t,i[2]=n,i[3]=s,i[4]=r,i[5]=o,i}function IE(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i}function $e(i,e){const t=e[0],n=e[1];return e[0]=i[0]*t+i[2]*n+i[4],e[1]=i[1]*t+i[3]*n+i[5],e}function Zo(i,e,t){return Gh(i,Vh(Gm,e,0,0,t,0,0))}function bE(i,e,t){return Gh(i,Vh(Gm,1,0,0,1,e,t))}function Si(i,e,t,n,s,r,o,l){const a=Math.sin(r),h=Math.cos(r);return i[0]=n*h,i[1]=s*a,i[2]=-n*a,i[3]=s*h,i[4]=o*n*h-l*n*a+e,i[5]=o*s*a+l*s*h+t,i}function Vm(i,e){const t=AE(e);we(t!==0,"Transformation matrix cannot be inverted");const n=e[0],s=e[1],r=e[2],o=e[3],l=e[4],a=e[5];return i[0]=o/t,i[1]=-s/t,i[2]=-r/t,i[3]=n/t,i[4]=(r*a-o*l)/t,i[5]=-(n*a-s*l)/t,i}function AE(i){return i[0]*i[3]-i[1]*i[2]}const LE=[1e5,1e5,1e5,1e5,2,2];function PE(i){return"matrix("+i.join(", ")+")"}function Nc(i){return i.substring(7,i.length-1).split(",").map(parseFloat)}function ME(i,e){const t=Nc(i),n=Nc(e);for(let s=0;s<6;++s)if(Math.round((t[s]-n[s])*LE[s])!==0)return!1;return!0}function Rn(i,e,t,n,s,r,o){r=r||[],o=o||2;let l=0;for(let a=e;a<t;a+=n){const h=i[a],c=i[a+1];r[l++]=s[0]*h+s[2]*c+s[4],r[l++]=s[1]*h+s[3]*c+s[5];for(let u=2;u<o;u++)r[l++]=i[a+u]}return r&&r.length!=l&&(r.length=l),r}function jm(i,e,t,n,s,r,o){o=o||[];const l=Math.cos(s),a=Math.sin(s),h=r[0],c=r[1];let u=0;for(let d=e;d<t;d+=n){const f=i[d]-h,g=i[d+1]-c;o[u++]=h+f*l-g*a,o[u++]=c+f*a+g*l;for(let m=d+2;m<d+n;++m)o[u++]=i[m]}return o&&o.length!=u&&(o.length=u),o}function OE(i,e,t,n,s,r,o,l){l=l||[];const a=o[0],h=o[1];let c=0;for(let u=e;u<t;u+=n){const d=i[u]-a,f=i[u+1]-h;l[c++]=a+s*d,l[c++]=h+r*f;for(let g=u+2;g<u+n;++g)l[c++]=i[g]}return l&&l.length!=c&&(l.length=c),l}function FE(i,e,t,n,s,r,o){o=o||[];let l=0;for(let a=e;a<t;a+=n){o[l++]=i[a]+s,o[l++]=i[a+1]+r;for(let h=a+2;h<a+n;++h)o[l++]=i[h]}return o&&o.length!=l&&(o.length=l),o}const Bd=kt(),DE=[NaN,NaN];class Gc extends di{constructor(){super(),this.extent_=wt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=gm((e,t,n)=>{if(!n)return this.getSimplifiedGeometry(t);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return ge()}closestPointXY(e,t,n,s){return ge()}containsXY(e,t){return this.closestPointXY(e,t,DE,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return ge()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&co(t),this.extentRevision_=this.getRevision()}return Uv(this.extent_,e)}rotate(e,t){ge()}scale(e,t,n){ge()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return ge()}getType(){return ge()}applyTransform(e){ge()}intersectsExtent(e){return ge()}translate(e,t){ge()}transform(e,t){const n=Oe(e),s=n.getUnits()=="tile-pixels"?function(r,o,l){const a=n.getExtent(),h=n.getWorldExtent(),c=Ye(h)/Ye(a);Si(Bd,h[0],h[3],c,-c,0,0,0);const u=Rn(r,0,r.length,l,Bd,o),d=Ti(n,t);return d?d(u,u,l):u}:Ti(n,t);return this.applyTransform(s),this}}class Ln extends Gc{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return bh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return ge()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Wd(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){ge()}setLayout(e,t,n){let s;if(e)s=Wd(e);else{for(let r=0;r<n;++r){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}s=t.length,e=kE(s)}this.layout=e,this.stride=s}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const n=this.getFlatCoordinates();if(n){const s=this.getStride();jm(n,0,n.length,s,e,t,n),this.changed()}}scale(e,t,n){t===void 0&&(t=e),n||(n=$t(this.getExtent()));const s=this.getFlatCoordinates();if(s){const r=this.getStride();OE(s,0,s.length,r,e,t,n,s),this.changed()}}translate(e,t){const n=this.getFlatCoordinates();if(n){const s=this.getStride();FE(n,0,n.length,s,e,t,n),this.changed()}}}function kE(i){let e;return i==2?e="XY":i==3?e="XYZ":i==4&&(e="XYZM"),e}function Wd(i){let e;return i=="XY"?e=2:i=="XYZ"||i=="XYM"?e=3:i=="XYZM"&&(e=4),e}function NE(i,e,t){const n=i.getFlatCoordinates();if(!n)return null;const s=i.getStride();return Rn(n,0,n.length,s,e,t)}function zm(i,e,t,n){let s=0;const r=i[t-n],o=i[t-n+1];let l=0,a=0;for(;e<t;e+=n){const h=i[e]-r,c=i[e+1]-o;s+=a*h-l*c,l=h,a=c}return s/2}function Bm(i,e,t,n){let s=0;for(let r=0,o=t.length;r<o;++r){const l=t[r];s+=zm(i,e,l,n),e=l}return s}function GE(i,e,t,n){let s=0;for(let r=0,o=t.length;r<o;++r){const l=t[r];s+=Bm(i,e,l,n),e=l[l.length-1]}return s}function Ud(i,e,t,n,s,r,o){const l=i[e],a=i[e+1],h=i[t]-l,c=i[t+1]-a;let u;if(h===0&&c===0)u=e;else{const d=((s-l)*h+(r-a)*c)/(h*h+c*c);if(d>1)u=t;else if(d>0){for(let f=0;f<n;++f)o[f]=Ot(i[e+f],i[t+f],d);o.length=n;return}else u=e}for(let d=0;d<n;++d)o[d]=i[u+d];o.length=n}function jh(i,e,t,n,s){let r=i[e],o=i[e+1];for(e+=n;e<t;e+=n){const l=i[e],a=i[e+1],h=qn(r,o,l,a);h>s&&(s=h),r=l,o=a}return s}function zh(i,e,t,n,s){for(let r=0,o=t.length;r<o;++r){const l=t[r];s=jh(i,e,l,n,s),e=l}return s}function VE(i,e,t,n,s){for(let r=0,o=t.length;r<o;++r){const l=t[r];s=zh(i,e,l,n,s),e=l[l.length-1]}return s}function Bh(i,e,t,n,s,r,o,l,a,h,c){if(e==t)return h;let u,d;if(s===0){if(d=qn(o,l,i[e],i[e+1]),d<h){for(u=0;u<n;++u)a[u]=i[e+u];return a.length=n,d}return h}c=c||[NaN,NaN];let f=e+n;for(;f<t;)if(Ud(i,f-n,f,n,o,l,c),d=qn(o,l,c[0],c[1]),d<h){for(h=d,u=0;u<n;++u)a[u]=c[u];a.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(h))/s|0,1);if(r&&(Ud(i,t-n,e,n,o,l,c),d=qn(o,l,c[0],c[1]),d<h)){for(h=d,u=0;u<n;++u)a[u]=c[u];a.length=n}return h}function Wh(i,e,t,n,s,r,o,l,a,h,c){c=c||[NaN,NaN];for(let u=0,d=t.length;u<d;++u){const f=t[u];h=Bh(i,e,f,n,s,r,o,l,a,h,c),e=f}return h}function jE(i,e,t,n,s,r,o,l,a,h,c){c=c||[NaN,NaN];for(let u=0,d=t.length;u<d;++u){const f=t[u];h=Wh(i,e,f,n,s,r,o,l,a,h,c),e=f[f.length-1]}return h}function zE(i,e,t,n){for(let s=0,r=t.length;s<r;++s)i[e++]=t[s];return e}function ta(i,e,t,n){for(let s=0,r=t.length;s<r;++s){const o=t[s];for(let l=0;l<n;++l)i[e++]=o[l]}return e}function Uh(i,e,t,n,s){s=s||[];let r=0;for(let o=0,l=t.length;o<l;++o){const a=ta(i,e,t[o],n);s[r++]=a,e=a}return s.length=r,s}function BE(i,e,t,n,s){s=s||[];let r=0;for(let o=0,l=t.length;o<l;++o){const a=Uh(i,e,t[o],n,s[r]);a.length===0&&(a[0]=e),s[r++]=a,e=a[a.length-1]}return s.length=r,s}function yn(i,e,t,n,s){s=s!==void 0?s:[];let r=0;for(let o=e;o<t;o+=n)s[r++]=i.slice(o,o+n);return s.length=r,s}function Ur(i,e,t,n,s){s=s!==void 0?s:[];let r=0;for(let o=0,l=t.length;o<l;++o){const a=t[o];s[r++]=yn(i,e,a,n,s[r]),e=a}return s.length=r,s}function Vc(i,e,t,n,s){s=s!==void 0?s:[];let r=0;for(let o=0,l=t.length;o<l;++o){const a=t[o];s[r++]=a.length===1&&a[0]===e?[]:Ur(i,e,a,n,s[r]),e=a[a.length-1]}return s.length=r,s}function ia(i,e,t,n,s,r,o){const l=(t-e)/n;if(l<3){for(;e<t;e+=n)r[o++]=i[e],r[o++]=i[e+1];return o}const a=new Array(l);a[0]=1,a[l-1]=1;const h=[e,t-n];let c=0;for(;h.length>0;){const u=h.pop(),d=h.pop();let f=0;const g=i[d],m=i[d+1],_=i[u],p=i[u+1];for(let y=d+n;y<u;y+=n){const v=i[y],C=i[y+1],x=Gv(v,C,g,m,_,p);x>f&&(c=y,f=x)}f>s&&(a[(c-e)/n]=1,d+n<c&&h.push(d,c),c+n<u&&h.push(c,u))}for(let u=0;u<l;++u)a[u]&&(r[o++]=i[e+u*n],r[o++]=i[e+u*n+1]);return o}function Wm(i,e,t,n,s,r,o,l){for(let a=0,h=t.length;a<h;++a){const c=t[a];o=ia(i,e,c,n,s,r,o),l.push(o),e=c}return o}function jn(i,e){return e*Math.round(i/e)}function WE(i,e,t,n,s,r,o){if(e==t)return o;let l=jn(i[e],s),a=jn(i[e+1],s);e+=n,r[o++]=l,r[o++]=a;let h,c;do if(h=jn(i[e],s),c=jn(i[e+1],s),e+=n,e==t)return r[o++]=h,r[o++]=c,o;while(h==l&&c==a);for(;e<t;){const u=jn(i[e],s),d=jn(i[e+1],s);if(e+=n,u==h&&d==c)continue;const f=h-l,g=c-a,m=u-l,_=d-a;if(f*_==g*m&&(f<0&&m<f||f==m||f>0&&m>f)&&(g<0&&_<g||g==_||g>0&&_>g)){h=u,c=d;continue}r[o++]=h,r[o++]=c,l=h,a=c,h=u,c=d}return r[o++]=h,r[o++]=c,o}function Kh(i,e,t,n,s,r,o,l){for(let a=0,h=t.length;a<h;++a){const c=t[a];o=WE(i,e,c,n,s,r,o),l.push(o),e=c}return o}function UE(i,e,t,n,s,r,o,l){for(let a=0,h=t.length;a<h;++a){const c=t[a],u=[];o=Kh(i,e,c,n,s,r,o,u),l.push(u),e=c[c.length-1]}return o}class Kr extends Ln{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Kr(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,n,s){return s<Zs(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Bh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,n,s))}getArea(){return zm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=ia(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Kr(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ta(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ii extends Ln{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new Ii(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,s){const r=this.flatCoordinates,o=qn(e,t,r[0],r[1]);if(o<s){const l=this.stride;for(let a=0;a<l;++a)n[a]=r[a];return n.length=l,o}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Ih(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Sh(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zE(this.flatCoordinates,0,e,this.stride),this.changed()}}function KE(i,e,t,n,s){return!wm(s,function(o){return!Xn(i,e,t,n,o[0],o[1])})}function Xn(i,e,t,n,s,r){let o=0,l=i[t-n],a=i[t-n+1];for(;e<t;e+=n){const h=i[e],c=i[e+1];a<=r?c>r&&(h-l)*(r-a)-(s-l)*(c-a)>0&&o++:c<=r&&(h-l)*(r-a)-(s-l)*(c-a)<0&&o--,l=h,a=c}return o!==0}function Xh(i,e,t,n,s,r){if(t.length===0||!Xn(i,e,t[0],n,s,r))return!1;for(let o=1,l=t.length;o<l;++o)if(Xn(i,t[o-1],t[o],n,s,r))return!1;return!0}function XE(i,e,t,n,s,r){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const a=t[o];if(Xh(i,e,a,n,s,r))return!0;e=a[a.length-1]}return!1}function Hh(i,e,t,n,s,r,o){let l,a,h,c,u,d,f;const g=s[r+1],m=[];for(let y=0,v=t.length;y<v;++y){const C=t[y];for(c=i[C-n],d=i[C-n+1],l=e;l<C;l+=n)u=i[l],f=i[l+1],(g<=d&&f<=g||d<=g&&g<=f)&&(h=(g-d)/(f-d)*(u-c)+c,m.push(h)),c=u,d=f}let _=NaN,p=-1/0;for(m.sort(xi),c=m[0],l=1,a=m.length;l<a;++l){u=m[l];const y=Math.abs(u-c);y>p&&(h=(c+u)/2,Xh(i,e,t,n,h,g)&&(_=h,p=y)),c=u}return isNaN(_)&&(_=s[r]),o?(o.push(_,g,p),o):[_,g,p]}function Um(i,e,t,n,s){let r=[];for(let o=0,l=t.length;o<l;++o){const a=t[o];r=Hh(i,e,a,n,s,2*o,r),e=a[a.length-1]}return r}function Km(i,e,t,n,s){let r;for(e+=n;e<t;e+=n)if(r=s(i.slice(e-n,e),i.slice(e,e+n)),r)return r;return!1}function na(i,e,t,n,s,r){return r=r??xm(wt(),i,e,t,n),Ke(s,r)?r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3]?!0:Km(i,e,t,n,function(o,l){return Kv(s,o,l)}):!1}function HE(i,e,t,n,s){for(let r=0,o=t.length;r<o;++r){if(na(i,e,t[r],n,s))return!0;e=t[r]}return!1}function Xm(i,e,t,n,s){return!!(na(i,e,t,n,s)||Xn(i,e,t,n,s[0],s[1])||Xn(i,e,t,n,s[0],s[3])||Xn(i,e,t,n,s[2],s[1])||Xn(i,e,t,n,s[2],s[3]))}function Hm(i,e,t,n,s){if(!Xm(i,e,t[0],n,s))return!1;if(t.length===1)return!0;for(let r=1,o=t.length;r<o;++r)if(KE(i,t[r-1],t[r],n,s)&&!na(i,t[r-1],t[r],n,s))return!1;return!0}function YE(i,e,t,n,s){for(let r=0,o=t.length;r<o;++r){const l=t[r];if(Hm(i,e,l,n,s))return!0;e=l[l.length-1]}return!1}function ZE(i,e,t,n){for(;e<t-n;){for(let s=0;s<n;++s){const r=i[e+s];i[e+s]=i[t-n+s],i[t-n+s]=r}e+=n,t-=n}}function Yh(i,e,t,n){let s=0,r=i[t-n],o=i[t-n+1];for(;e<t;e+=n){const l=i[e],a=i[e+1];s+=(l-r)*(a+o),r=l,o=a}return s===0?void 0:s>0}function Ym(i,e,t,n,s){s=s!==void 0?s:!1;for(let r=0,o=t.length;r<o;++r){const l=t[r],a=Yh(i,e,l,n);if(r===0){if(s&&a||!s&&!a)return!1}else if(s&&!a||!s&&a)return!1;e=l}return!0}function $E(i,e,t,n,s){for(let r=0,o=t.length;r<o;++r){const l=t[r];if(!Ym(i,e,l,n,s))return!1;l.length&&(e=l[l.length-1])}return!0}function jc(i,e,t,n,s){s=s!==void 0?s:!1;for(let r=0,o=t.length;r<o;++r){const l=t[r],a=Yh(i,e,l,n);(r===0?s&&a||!s&&!a:s&&!a||!s&&a)&&ZE(i,e,l,n),e=l}return e}function Kd(i,e,t,n,s){for(let r=0,o=t.length;r<o;++r)e=jc(i,e,t[r],n,s);return e}function Zm(i,e){const t=[];let n=0,s=0,r;for(let o=0,l=e.length;o<l;++o){const a=e[o],h=Yh(i,n,a,2);if(r===void 0&&(r=h),h===r)t.push(e.slice(s,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[s])}s=o+1,n=a}return t}class qi extends Ln{constructor(e,t,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&n?(this.setFlatCoordinates(t,e),this.ends_=n):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?ri(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new qi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,n,s){return s<Zs(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(zh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Wh(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,n,s))}containsXY(e,t){return Xh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Bm(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),jc(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Ur(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=$t(this.getExtent());this.flatInteriorPoint_=Hh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ii(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Kr(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,n=this.ends_,s=[];let r=0;for(let o=0,l=n.length;o<l;++o){const a=n[o],h=new Kr(t.slice(r,a),e);s.push(h),r=a}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Ym(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=jc(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=Kh(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,n),new qi(t,"XY",n)}getType(){return"Polygon"}intersectsExtent(e){return Hm(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Uh(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function qE(i,e,t,n){t=t||32;const s=[];for(let r=0;r<t;++r)ri(s,$v(i,e,2*Math.PI*r/t,n));return s.push(s[0],s[1]),new qi(s,"XY",[s.length])}function Xd(i){if(ls(i))throw new Error("Cannot create polygon from empty extent");const e=i[0],t=i[1],n=i[2],s=i[3],r=[e,t,e,s,n,s,n,t,e,t];return new qi(r,"XY",[r.length])}function Zh(i,e,t,n){const s=ve(e)/t[0],r=Ye(e)/t[1];return n?Math.min(i,Math.max(s,r)):Math.min(i,Math.min(s,r))}function $h(i,e,t){let n=Math.min(i,e);const s=50;return n*=Math.log(1+s*Math.max(0,i/e-1))/s+1,t&&(n=Math.max(n,t),n/=Math.log(1+s*Math.max(0,t/i-1))/s+1),ze(n,t/2,e*2)}function JE(i,e,t,n){return e=e!==void 0?e:!0,(function(s,r,o,l){if(s!==void 0){const a=i[0],h=i[i.length-1],c=t?Zh(a,t,o,n):a;if(l)return e?$h(s,c,h):ze(s,h,c);const u=Math.min(c,s),d=Math.floor(Xl(i,u,r));return i[d]>c&&d<i.length-1?i[d+1]:i[d]}})}function QE(i,e,t,n,s,r){return n=n!==void 0?n:!0,t=t!==void 0?t:0,(function(o,l,a,h){if(o!==void 0){const c=s?Zh(e,s,a,r):e;if(h)return n?$h(o,c,t):ze(o,t,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(i)-u),f=-l*(.5-u)+.5,g=Math.min(c,o),m=Math.floor(Math.log(e/g)/Math.log(i)+f),_=Math.max(d,m),p=e/Math.pow(i,_);return ze(p,t,c)}})}function Hd(i,e,t,n,s){return t=t!==void 0?t:!0,(function(r,o,l,a){if(r!==void 0){const h=n?Zh(i,n,l,s):i;return!t||!a?ze(r,e,h):$h(r,h,e)}})}function qh(i){if(i!==void 0)return 0}function Yd(i){if(i!==void 0)return i}function ex(i){const e=2*Math.PI/i;return(function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function tx(i){const e=wi(5);return(function(t,n){return n||t===void 0?t:Math.abs(t)<=e?0:t})}const $m=42,Jh=256,Va=0;class pi extends di{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=kh(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Nm(),e.center&&(e.center=Ni(e.center,this.projection_)),e.extent&&(e.extent=Ci(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in qt)delete t[l];this.setProperties(t,!0);const n=nx(e);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=n.minZoom;const s=ix(e),r=n.constraint,o=sx(e);this.constraints_={center:s,resolution:r,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const n=this.getCenterInternal();if(n){const s=e||[0,0,0,0];t=t||[0,0,0,0];const r=this.getResolution(),o=r/2*(s[3]-t[3]+t[1]-s[1]),l=r/2*(s[0]-t[0]+t[2]-s[2]);this.setCenterInternal([n[0]+o,n[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let n=0;n<t.length;++n){let s=arguments[n];s.center&&(s=Object.assign({},s),s.center=Ni(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=Ni(s.anchor,this.getProjection())),t[n]=s}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,n;t>1&&typeof arguments[t-1]=="function"&&(n=arguments[t-1],--t);let s=0;for(;s<t&&!this.isDef();++s){const c=arguments[s];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(s===t){n&&Lo(n,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,a=this.targetRotation_;const h=[];for(;s<t;++s){const c=arguments[s],u={start:r,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||Yv,callback:n};if(c.center&&(u.sourceCenter=o,u.targetCenter=c.center.slice(),o=u.targetCenter),c.zoom!==void 0?(u.sourceResolution=l,u.targetResolution=this.getResolutionForZoom(c.zoom),l=u.targetResolution):c.resolution&&(u.sourceResolution=l,u.targetResolution=c.resolution,l=u.targetResolution),c.rotation!==void 0){u.sourceRotation=a;const d=Jn(c.rotation-a+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=a+d,a=u.targetRotation}rx(u)?u.complete=!0:r+=u.duration,h.push(u)}this.animations_.push(h),this.setHint(je.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[je.ANIMATING]>0}getInteracting(){return this.hints_[je.INTERACTING]>0}cancelAnimations(){this.setHint(je.ANIMATING,-this.hints_[je.ANIMATING]);let e;for(let t=0,n=this.animations_.length;t<n;++t){const s=this.animations_[t];if(s[0].callback&&Lo(s[0].callback,!1),!e)for(let r=0,o=s.length;r<o;++r){const l=s[r];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let n=this.animations_.length-1;n>=0;--n){const s=this.animations_[n];let r=!0;for(let o=0,l=s.length;o<l;++o){const a=s[o];if(a.complete)continue;const h=e-a.start;let c=a.duration>0?h/a.duration:1;c>=1?(a.complete=!0,c=1):r=!1;const u=a.easing(c);if(a.sourceCenter){const d=a.sourceCenter[0],f=a.sourceCenter[1],g=a.targetCenter[0],m=a.targetCenter[1];this.nextCenter_=a.targetCenter;const _=d+u*(g-d),p=f+u*(m-f);this.targetCenter_=[_,p]}if(a.sourceResolution&&a.targetResolution){const d=u===1?a.targetResolution:a.sourceResolution+u*(a.targetResolution-a.sourceResolution);if(a.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,a.anchor)}this.nextResolution_=a.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(a.sourceRotation!==void 0&&a.targetRotation!==void 0){const d=u===1?Jn(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+u*(a.targetRotation-a.sourceRotation);if(a.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,a.anchor)}this.nextRotation_=a.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),t=!0,!a.complete)break}if(r){this.animations_[n]=null,this.setHint(je.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=s[0].callback;o&&Lo(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let n;const s=this.getCenterInternal();return s!==void 0&&(n=[s[0]-t[0],s[1]-t[1]],Lh(n,e-this.getRotation()),Im(n,t)),n}calculateCenterZoom(e,t){let n;const s=this.getCenterInternal(),r=this.getResolution();if(s!==void 0&&r!==void 0){const o=t[0]-e*(t[0]-s[0])/r,l=t[1]-e*(t[1]-s[1])/r;n=[o,l]}return n}getViewportSize_(e){const t=this.viewportSize_;if(e){const n=t[0],s=t[1];return[Math.abs(n*Math.cos(e))+Math.abs(s*Math.sin(e)),Math.abs(n*Math.sin(e))+Math.abs(s*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&kc(e,this.getProjection())}getCenterInternal(){return this.get(qt.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Nh(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();we(t,"The view center is not defined");const n=this.getResolution();we(n!==void 0,"The view resolution is not defined");const s=this.getRotation();return we(s!==void 0,"The view rotation is not defined"),Br(t,n,s,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(qt.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Ci(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const n=ve(e)/t[0],s=Ye(e)/t[1];return Math.max(n,s)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(t/n)/Math.log(e);return(function(r){return t/Math.pow(e,r*s)})}getRotation(){return this.get(qt.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),n=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,r=Math.log(n/s)/t;return(function(o){return Math.log(n/o)/t/r})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const n=this.padding_;return n&&(t=[t[0]-n[1]-n[3],t[1]-n[0]-n[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),n=this.getRotation();let s=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();s=ja(s,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],t,n)}return{center:s.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,n,s;if(this.resolutions_){const r=Xl(this.resolutions_,e,1);t=r,n=this.resolutions_[r],r==this.resolutions_.length-1?s=2:s=n/this.resolutions_[r+1]}else n=this.maxResolution_,s=this.zoomFactor_;return t+Math.log(n/e)/Math.log(s)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=ze(Math.floor(e),0,this.resolutions_.length-2),n=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(n,ze(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let n;if(we(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){we(!ls(e),"Cannot fit empty extent provided as `geometry`");const s=Ci(e,this.getProjection());n=Xd(s)}else if(e.getType()==="Circle"){const s=Ci(e.getExtent(),this.getProjection());n=Xd(s),n.rotate(this.getRotation(),$t(s))}else n=e;this.fitInternal(n,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),n=Math.cos(t),s=Math.sin(-t),r=e.getFlatCoordinates(),o=e.getStride();let l=1/0,a=1/0,h=-1/0,c=-1/0;for(let u=0,d=r.length;u<d;u+=o){const f=r[u]*n-r[u+1]*s,g=r[u]*s+r[u+1]*n;l=Math.min(l,f),a=Math.min(a,g),h=Math.max(h,f),c=Math.max(c,g)}return[l,a,h,c]}fitInternal(e,t){t=t||{};let n=t.size;n||(n=this.getViewportSizeMinusPadding_());const s=t.padding!==void 0?t.padding:[0,0,0,0],r=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let a=this.getResolutionForExtentInternal(l,[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);a=isNaN(a)?o:Math.max(a,o),a=this.getConstrainedResolution(a,r?0:1);const h=this.getRotation(),c=Math.sin(h),u=Math.cos(h),d=$t(l);d[0]+=(s[1]-s[3])/2*a,d[1]+=(s[0]-s[2])/2*a;const f=d[0]*u-d[1]*c,g=d[1]*u+d[0]*c,m=this.getConstrainedCenter([f,g],a),_=t.callback?t.callback:zr;t.duration!==void 0?this.animateInternal({resolution:a,center:m,duration:t.duration,easing:t.easing},_):(this.targetResolution_=a,this.targetCenter_=m,this.applyTargetState_(!1,!0),Lo(_,!0))}centerOn(e,t,n){this.centerOnInternal(Ni(e,this.getProjection()),t,n)}centerOnInternal(e,t,n){this.setCenterInternal(ja(e,t,n,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,n,s){let r;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-n),a=ja(e,s,[l[0]/2+o[3],l[1]/2+o[0]],t,n);r=[e[0]-a[0],e[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=kc(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ni(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const n=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*e,0,s,n);t&&(this.targetCenter_=this.calculateCenterZoom(r,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ni(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const n=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+e,n);t&&(this.targetCenter_=this.calculateCenterRotate(s,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ni(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const n=this.getAnimating()||this.getInteracting()||t,s=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,0,r,n),l=this.constraints_.center(this.targetCenter_,o,r,n,this.calculateCenterShift(this.targetCenter_,o,s,r));this.get(qt.ROTATION)!==s&&this.set(qt.ROTATION,s),this.get(qt.RESOLUTION)!==o&&(this.set(qt.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(qt.CENTER)||!ul(this.get(qt.CENTER),l))&&this.set(qt.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,n){e=e!==void 0?e:200;const s=t||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),l=this.constraints_.resolution(this.targetResolution_,s,o),a=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,r,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=r,this.targetCenter_=a,this.applyTargetState_();return}n=n||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==r||!this.getCenterInternal()||!ul(this.getCenterInternal(),a))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:l,duration:e,easing:$s,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(je.INTERACTING,1)}endInteraction(e,t,n){n=n&&Ni(n,this.getProjection()),this.endInteractionInternal(e,t,n)}endInteractionInternal(e,t,n){this.getInteracting()&&(this.setHint(je.INTERACTING,-1),this.resolveConstraints(e,t,n))}getConstrainedCenter(e,t){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),n)}getConstrainedZoom(e,t){const n=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(n,t))}getConstrainedResolution(e,t){t=t||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,n)}}function Lo(i,e){setTimeout(function(){i(e)},0)}function ix(i){if(i.extent!==void 0){const t=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return Ld(i.extent,i.constrainOnlyCenter,t)}const e=kh(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Ld(t,!1,!1)}return jv}function nx(i){let e,t,n,o=i.minZoom!==void 0?i.minZoom:Va,l=i.maxZoom!==void 0?i.maxZoom:28;const a=i.zoomFactor!==void 0?i.zoomFactor:2,h=i.multiWorld!==void 0?i.multiWorld:!1,c=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,u=i.showFullExtent!==void 0?i.showFullExtent:!1,d=kh(i.projection,"EPSG:3857"),f=d.getExtent();let g=i.constrainOnlyCenter,m=i.extent;if(!h&&!m&&d.isGlobal()&&(g=!1,m=f),i.resolutions!==void 0){const _=i.resolutions;t=_[o],n=_[l]!==void 0?_[l]:_[_.length-1],i.constrainResolution?e=JE(_,c,!g&&m,u):e=Hd(t,n,c,!g&&m,u)}else{const p=(f?Math.max(ve(f),Ye(f)):360*Mh.degrees/d.getMetersPerUnit())/Jh/Math.pow(2,Va),y=p/Math.pow(2,28-Va);t=i.maxResolution,t!==void 0?o=0:t=p/Math.pow(a,o),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=t/Math.pow(a,l):n=p/Math.pow(a,l):n=y),l=o+Math.floor(Math.log(t/n)/Math.log(a)),n=t/Math.pow(a,l-o),i.constrainResolution?e=QE(a,t,n,c,!g&&m,u):e=Hd(t,n,c,!g&&m,u)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:o,zoomFactor:a}}function sx(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const t=i.constrainRotation;return t===void 0||t===!0?tx():t===!1?Yd:typeof t=="number"?ex(t):Yd}return qh}function rx(i){return!(i.sourceCenter&&i.targetCenter&&!ul(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function ja(i,e,t,n,s){const r=Math.cos(-s);let o=Math.sin(-s),l=i[0]*r-i[1]*o,a=i[1]*r+i[0]*o;l+=(e[0]/2-t[0])*n,a+=(t[1]-e[1]/2)*n,o=-o;const h=l*r-a*o,c=a*r+l*o;return[h,c]}const Po="ol-hidden",ox="ol-selectable",sa="ol-unselectable",Qh="ol-control",Zd="ol-collapsed",lx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),$d=["style","variant","weight","size","lineHeight","family"],zc={normal:400,bold:700},Bc=function(i){const e=i.match(lx);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let n=0,s=$d.length;n<s;++n){const r=e[n+1];r!==void 0&&(t[$d[n]]=typeof r=="string"?r.trim():r)}return isNaN(Number(t.weight))&&t.weight in zc&&(t.weight=zc[t.weight]),t.families=t.family.split(/,\s?/).map(n=>n.trim().replace(/^['"]|['"]$/g,"")),t};function qe(i,e,t,n){let s;return t&&t.length?s=t.shift():Ut?s=new class extends OffscreenCanvas{style={}}(i??300,e??150):s=document.createElement("canvas"),i&&(s.width=i),e&&(s.height=e),s.getContext("2d",n)}let za;function gl(){return za||(za=qe(1,1)),za}function uo(i){const e=i.canvas;e.width=1,e.height=1,i.clearRect(0,0,1,1)}function ax(i){let e=i.offsetWidth;const t=getComputedStyle(i);return e+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10),e}function cx(i){let e=i.offsetHeight;const t=getComputedStyle(i);return e+=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10),e}function qd(i,e){const t=e.parentNode;t&&t.replaceChild(i,e)}function qm(i){for(;i.lastChild;)i.lastChild.remove()}function hx(i,e){const t=i.childNodes;for(let n=0;;++n){const s=t[n],r=e[n];if(!s&&!r)break;if(s!==r){if(!s){i.appendChild(r);continue}if(!r){i.removeChild(s),--n;continue}i.insertBefore(r,s)}}}function Jm(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const n=this.childNodes.indexOf(t);if(n===-1)throw new Error("Reference node not found");return this.childNodes.splice(n,0,e),e},style:{}},{get(e,t,n){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,n)}})}function Cn(i){return typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas}class eu extends di{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,n=this.listenerKeys.length;t<n;++t)Ne(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==zr&&this.listenerKeys.push(Ee(e,Vi.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class ux extends eu{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",n=e.tipLabel!==void 0?e.tipLabel:"Attributions",s=e.expandClassName!==void 0?e.expandClassName:t+"-expand",r=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=s):this.label_=l;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(le.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+sa+" "+Qh+(this.collapsed_&&this.collapsible_?" "+Zd:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=h,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),n=new Set(t.flatMap(s=>s.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(s=>n.add(s)):n.add(this.attributions_)),!this.overrideCollapsible_){const s=!t.some(r=>r.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(s)}return Array.from(n)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(s=>mm(()=>s))),n=t.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!bn(t,this.renderedAttributions_)){qm(this.ulElement_);for(let s=0,r=t.length;s<r;++s){const o=document.createElement("li");o.innerHTML=t[s],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Zd),this.collapsed_?qd(this.collapseLabel_,this.label_):qd(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class dx extends eu{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",n=e.label!==void 0?e.label:"",s=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(s));const r=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(le.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+sa+" "+Qh,a=this.element;a.className=l,a.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Po)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const n=t.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:$s}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const n=t.viewState.rotation;if(n!=this.rotation_){const s="rotate("+n+"rad)";if(this.autoHide_){const r=this.element.classList.contains(Po);!r&&n===0?this.element.classList.add(Po):r&&n!==0&&this.element.classList.remove(Po)}this.label_.style.transform=s}this.rotation_=n}}class fx extends eu{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",n=e.delta!==void 0?e.delta:1,s=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",r=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",a=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=s,c.setAttribute("type","button"),c.title=a,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener(le.CLICK,this.handleClick_.bind(this,n),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=h,u.appendChild(typeof l=="string"?document.createTextNode(l):l),u.addEventListener(le.CLICK,this.handleClick_.bind(this,-n),!1);const d=t+" "+sa+" "+Qh,f=this.element;f.className=d,f.appendChild(c),f.appendChild(u),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const n=this.getMap().getView();if(!n)return;const s=n.getZoom();if(s!==void 0){const r=n.getConstrainedZoom(s+e);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:r,duration:this.duration_,easing:$s})):n.setZoom(r)}}}function gx(i){i=i||{};const e=new Wt;return(i.zoom===void 0||i.zoom)&&e.push(new fx(i.zoomOptions)),(i.rotate===void 0||i.rotate)&&e.push(new dx(i.rotateOptions)),(i.attribution===void 0||i.attribution)&&e.push(new ux(i.attributionOptions)),e}class mx{constructor(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let n=t-3;for(;n>0&&this.points_[n+2]>e;)n-=3;const s=this.points_[t+2]-this.points_[n+2];if(s<1e3/60)return!1;const r=this.points_[t]-this.points_[n],o=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Jd={ACTIVE:"active"};class fo extends di{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Jd.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Jd.ACTIVE,e)}setMap(e){this.map_=e}}function _x(i,e,t){const n=i.getCenterInternal();if(n){const s=[n[0]+e[0],n[1]+e[1]];i.animateInternal({duration:t!==void 0?t:250,easing:Zv,center:i.getConstrainedCenter(s)})}}function tu(i,e,t,n){const s=i.getZoom();if(s===void 0)return;const r=i.getConstrainedZoom(s+e),o=i.getResolutionForZoom(r);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:o,anchor:t,duration:n!==void 0?n:250,easing:$s})}class px extends fo{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==We.DBLCLICK){const n=e.originalEvent,s=e.map,r=e.coordinate,o=n.shiftKey?-this.delta_:this.delta_,l=s.getView();tu(l,o,r,this.duration_),n.preventDefault(),t=!0}return!t}}function Wc(i){const e=arguments;return function(t){let n=!0;for(let s=0,r=e.length;s<r&&(n=n&&e[s](t),!!n);++s);return n}}const yx=function(i){const e=i.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Cx=function(i){const e=i.map.getTargetElement(),t=e.getRootNode(),n=i.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(n):e.contains(n)},Qm=function(i){const e=i.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?Cx(i):!0},vx=jr,e_=function(i){const e=i.originalEvent;return"pointerId"in e&&e.button==0&&!(Ov&&_m&&e.ctrlKey)},t_=function(i){const e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Ex=function(i){const e=i.originalEvent;return _m?e.metaKey:e.ctrlKey},xx=function(i){const e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},i_=function(i){const e=i.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Ba=function(i){const e=i.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},wx=function(i){const e=i.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class go extends fo{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==We.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==We.POINTERUP){const n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==We.POINTERDOWN){const n=this.handleDownEvent(e);this.handlingDownUpSequence=n,t=this.stopDown(n)}else e.type==We.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function iu(i){const e=i.length;let t=0,n=0;for(let s=0;s<e;s++)t+=i[s].clientX,n+=i[s].clientY;return{clientX:t/e,clientY:n/e}}class Rx extends go{constructor(e){super({stopDown:Hl}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Wc(t_,wx);this.condition_=e.onFocusOnly?Wc(Qm,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const n=this.targetPointers,s=t.getEventPixel(iu(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const r=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],l=e.map.getView();bm(r,l.getResolution()),Lh(r,l.getRotation()),l.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,n=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),a=t.getCoordinateFromPixelInternal([l[0]-s*Math.cos(r),l[1]-s*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(a),duration:500,easing:$s})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const n=e.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class Tx extends go{constructor(e){e=e||{},super({stopDown:Hl}),this.condition_=e.condition?e.condition:yx,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Ba(e))return;const t=e.map,n=t.getView();if(n.getConstraints().rotation===qh)return;const s=t.getSize(),r=e.pixel,o=Math.atan2(s[1]/2-r[1],r[0]-s[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;n.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return Ba(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Ba(e)&&e_(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class Sx extends Kl{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,n="px",s=this.element_.style;s.left=Math.min(e[0],t[0])+n,s.top=Math.min(e[1],t[1])+n,s.width=Math.abs(t[0]-e[0])+n,s.height=Math.abs(t[1]-e[1])+n}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,s=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new qi([s])}getGeometry(){return this.geometry_}}const us={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ar extends bi{constructor(e,t,n){super(e),this.coordinate=t,this.mapBrowserEvent=n}}class Ix extends go{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new Sx(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??e_,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,n){const s=n[0]-t[0],r=n[1]-t[1];return s*s+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new ar(us.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new ar(t?us.BOXEND:us.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ar(us.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new ar(us.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new ar(us.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class bx extends Ix{constructor(e){e=e||{};const t=e.condition?e.condition:xx;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const n=this.getMap().getView();let s=this.getGeometry();if(this.out_){const r=n.rotatedExtentForGeometry(s),o=n.getResolutionForExtentInternal(r),l=n.getResolution()/o;s=s.clone(),s.scale(l*l)}n.fitInternal(s,{duration:this.duration_,easing:$s})}}const Gn={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class Ax extends fo{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return t_(t)&&i_(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==le.KEYDOWN){const n=e.originalEvent,s=n.key;if(this.condition_(e)&&(s==Gn.DOWN||s==Gn.LEFT||s==Gn.RIGHT||s==Gn.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let a=0,h=0;s==Gn.DOWN?h=-l:s==Gn.LEFT?a=-l:s==Gn.RIGHT?a=l:h=l;const c=[a,h];Lh(c,o.getRotation()),_x(o,c,this.duration_),n.preventDefault(),t=!0}}return!t}}class Lx extends fo{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!Ex(t)&&i_(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==le.KEYDOWN||e.type==le.KEYPRESS){const n=e.originalEvent,s=n.key;if(this.condition_(e)&&(s==="+"||s==="-")){const r=e.map,o=s==="+"?this.delta_:-this.delta_,l=r.getView();tu(l,o,void 0,this.duration_),n.preventDefault(),t=!0}}return!t}}const Px=40,Mx=300;class Ox extends fo{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:vx;this.condition_=e.onFocusOnly?Wc(Qm,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==le.WHEEL)return!0;const n=e.map,s=e.originalEvent;s.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let r=s.deltaY;switch(s.deltaMode){case WheelEvent.DOM_DELTA_LINE:r*=Px;break;case WheelEvent.DOM_DELTA_PAGE:r*=Mx;break}if(r===0)return!1;this.lastDelta_=r;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const l=n.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_?n.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=r;const a=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),a),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let n=-ze(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),tu(t,n,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class Fx extends go{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Hl),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const n=this.targetPointers[0],s=this.targetPointers[1],r=Math.atan2(s.clientY-n.clientY,s.clientX-n.clientX);if(this.lastAngle_!==void 0){const a=r-this.lastAngle_;this.rotationDelta_+=a,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=a}this.lastAngle_=r;const o=e.map,l=o.getView();l.getConstraints().rotation!==qh&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(iu(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class Dx extends go{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Hl),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const n=this.targetPointers[0],s=this.targetPointers[1],r=n.clientX-s.clientX,o=n.clientY-s.clientY,l=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const a=e.map,h=a.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(iu(this.targetPointers))),a.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const n=e.map.getView(),s=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function kx(i){i=i||{};const e=new Wt,t=new mx(-.005,.05,100);return(i.altShiftDragRotate===void 0||i.altShiftDragRotate)&&e.push(new Tx),(i.doubleClickZoom===void 0||i.doubleClickZoom)&&e.push(new px({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan===void 0||i.dragPan)&&e.push(new Rx({onFocusOnly:i.onFocusOnly,kinetic:t})),(i.pinchRotate===void 0||i.pinchRotate)&&e.push(new Fx),(i.pinchZoom===void 0||i.pinchZoom)&&e.push(new Dx({duration:i.zoomDuration})),(i.keyboard===void 0||i.keyboard)&&(e.push(new Ax),e.push(new Lx({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom===void 0||i.mouseWheelZoom)&&e.push(new Ox({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom===void 0||i.shiftDragZoom)&&e.push(new bx({duration:i.zoomDuration})),e}const Pe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class n_ extends di{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Pe.OPACITY]=e.opacity!==void 0?e.opacity:1,we(typeof t[Pe.OPACITY]=="number","Layer opacity must be a number"),t[Pe.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Pe.Z_INDEX]=e.zIndex,t[Pe.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Pe.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Pe.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Pe.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},n=this.getZIndex();return t.opacity=ze(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=n===void 0&&!t.managed?1/0:n,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return ge()}getLayerStatesArray(e){return ge()}getExtent(){return this.get(Pe.EXTENT)}getMaxResolution(){return this.get(Pe.MAX_RESOLUTION)}getMinResolution(){return this.get(Pe.MIN_RESOLUTION)}getMinZoom(){return this.get(Pe.MIN_ZOOM)}getMaxZoom(){return this.get(Pe.MAX_ZOOM)}getOpacity(){return this.get(Pe.OPACITY)}getSourceState(){return ge()}getVisible(){return this.get(Pe.VISIBLE)}getZIndex(){return this.get(Pe.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Pe.EXTENT,e)}setMaxResolution(e){this.set(Pe.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Pe.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Pe.MAX_ZOOM,e)}setMinZoom(e){this.set(Pe.MIN_ZOOM,e)}setOpacity(e){we(typeof e=="number","Layer opacity must be a number"),this.set(Pe.OPACITY,e)}setVisible(e){this.set(Pe.VISIBLE,e)}setZIndex(e){this.set(Pe.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const rn={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class _n extends bi{constructor(e,t){super(e),this.layer=t}}const Wa={LAYERS:"layers"};class Ji extends n_{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let n=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Wa.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new Wt(n.slice(),{unique:!0}):we(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new Wt(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ne),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Ee(e,It.ADD,this.handleLayersAdd_,this),Ee(e,It.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ne);ro(this.listenerKeys_);const t=e.getArray();for(let n=0,s=t.length;n<s;n++){const r=t[n];this.registerLayerListeners_(r),this.dispatchEvent(new _n(rn.ADDLAYER,r))}this.changed()}registerLayerListeners_(e){const t=[Ee(e,Bs.PROPERTYCHANGE,this.handleLayerChange_,this),Ee(e,le.CHANGE,this.handleLayerChange_,this)];e instanceof Ji&&t.push(Ee(e,rn.ADDLAYER,this.handleLayerGroupAdd_,this),Ee(e,rn.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[de(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new _n(rn.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new _n(rn.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new _n(rn.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,n=de(t);this.listenerKeys_[n].forEach(Ne),delete this.listenerKeys_[n],this.dispatchEvent(new _n(rn.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(Wa.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const n=t.getArray();for(let s=0,r=n.length;s<r;++s)this.dispatchEvent(new _n(rn.REMOVELAYER,n[s]))}this.set(Wa.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],n=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const s=this.getLayerState();let r=s.zIndex;!e&&s.zIndex===void 0&&(r=0);for(let o=n,l=t.length;o<l;o++){const a=t[o];a.opacity*=s.opacity,a.visible=a.visible&&s.visible,a.maxResolution=Math.min(a.maxResolution,s.maxResolution),a.minResolution=Math.max(a.minResolution,s.minResolution),a.minZoom=Math.max(a.minZoom,s.minZoom),a.maxZoom=Math.min(a.maxZoom,s.maxZoom),s.extent!==void 0&&(a.extent!==void 0?a.extent=li(a.extent,s.extent):a.extent=s.extent),a.zIndex===void 0&&(a.zIndex=r)}return t}getSourceState(){return"ready"}}const Kt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class Js extends n_{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Pe.SOURCE,this.handleSourcePropertyChange_);const n=e.source?e.source:null;this.setSource(n)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Pe.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ne(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Ee(e,le.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const n=this.getMapInternal();!e&&n&&(e=n.getView()),e instanceof pi?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&n&&(t.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let s;if(t.layerStatesArray){if(s=t.layerStatesArray.find(o=>o.layer===this),!s)return!1}else s=this.getLayerState();const r=this.getExtent();return nu(s,t.viewState)&&(!r||Ke(r,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const n=e instanceof pi?e.getViewStateAndExtent():e;let s=t(n);return Array.isArray(s)||(s=[s]),s}render(e,t){const n=this.getRenderer();return n.prepareFrame(e)?(this.rendered=!0,n.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Pe.MAP,e)}getMapInternal(){return this.get(Pe.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ne(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ne(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Ee(e,Kt.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Ee(this,le.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,n=this.getLayerState(!1);we(!t.some(s=>s.layer===n.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(n)}setSource(e){this.set(Pe.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function nu(i,e){if(!i.visible)return!1;const t=e.resolution;if(t<i.minResolution||t>=i.maxResolution)return!1;const n=e.zoom;return n>i.minZoom&&n<=i.maxZoom}function s_(i,e,t=0,n=i.length-1,s=Nx){for(;n>t;){if(n-t>600){const a=n-t+1,h=e-t+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*(h-a/2<0?-1:1),f=Math.max(t,Math.floor(e-h*u/a+d)),g=Math.min(n,Math.floor(e+(a-h)*u/a+d));s_(i,e,f,g,s)}const r=i[e];let o=t,l=n;for(cr(i,t,e),s(i[n],r)>0&&cr(i,t,n);o<l;){for(cr(i,o,l),o++,l--;s(i[o],r)<0;)o++;for(;s(i[l],r)>0;)l--}s(i[t],r)===0?cr(i,t,l):(l++,cr(i,l,n)),l<=e&&(t=l+1),e<=l&&(n=l-1)}}function cr(i,e,t){const n=i[e];i[e]=i[t],i[t]=n}function Nx(i,e){return i<e?-1:i>e?1:0}let r_=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!Oo(e,t))return n;const s=this.toBBox,r=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],a=t.leaf?s(l):l;Oo(e,a)&&(t.leaf?n.push(l):Ka(e,a)?this._all(l,n):r.push(l))}t=r.pop()}return n}collides(e){let t=this.data;if(!Oo(e,t))return!1;const n=[];for(;t;){for(let s=0;s<t.children.length;s++){const r=t.children[s],o=t.leaf?this.toBBox(r):r;if(Oo(e,o)){if(t.leaf||Ka(e,o))return!0;n.push(r)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=xs([]),this}remove(e,t){if(!e)return this;let n=this.data;const s=this.toBBox(e),r=[],o=[];let l,a,h;for(;n||r.length;){if(n||(n=r.pop(),a=r[r.length-1],l=o.pop(),h=!0),n.leaf){const c=Gx(e,n.children,t);if(c!==-1)return n.children.splice(c,1),r.push(n),this._condense(r),this}!h&&!n.leaf&&Ka(n,s)?(r.push(n),o.push(l),l=0,a=n,n=n.children[0]):a?(l++,n=a.children[l],h=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,s){const r=n-t+1;let o=this._maxEntries,l;if(r<=o)return l=xs(e.slice(t,n+1)),ds(l,this.toBBox),l;s||(s=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,s-1))),l=xs([]),l.leaf=!1,l.height=s;const a=Math.ceil(r/o),h=a*Math.ceil(Math.sqrt(o));Qd(e,t,n,h,this.compareMinX);for(let c=t;c<=n;c+=h){const u=Math.min(c+h-1,n);Qd(e,c,u,a,this.compareMinY);for(let d=c;d<=u;d+=a){const f=Math.min(d+a-1,u);l.children.push(this._build(e,d,f,s-1))}}return ds(l,this.toBBox),l}_chooseSubtree(e,t,n,s){for(;s.push(t),!(t.leaf||s.length-1===n);){let r=1/0,o=1/0,l;for(let a=0;a<t.children.length;a++){const h=t.children[a],c=Ua(h),u=zx(e,h)-c;u<o?(o=u,r=c<r?c:r,l=h):u===o&&c<r&&(r=c,l=h)}t=l||t.children[0]}return t}_insert(e,t,n){const s=n?e:this.toBBox(e),r=[],o=this._chooseSubtree(s,this.data,t,r);for(o.children.push(e),pr(o,s);t>=0&&r[t].children.length>this._maxEntries;)this._split(r,t),t--;this._adjustParentBBoxes(s,r,t)}_split(e,t){const n=e[t],s=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,s);const o=this._chooseSplitIndex(n,r,s),l=xs(n.children.splice(o,n.children.length-o));l.height=n.height,l.leaf=n.leaf,ds(n,this.toBBox),ds(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(n,l)}_splitRoot(e,t){this.data=xs([e,t]),this.data.height=e.height+1,this.data.leaf=!1,ds(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let s,r=1/0,o=1/0;for(let l=t;l<=n-t;l++){const a=_r(e,0,l,this.toBBox),h=_r(e,l,n,this.toBBox),c=Bx(a,h),u=Ua(a)+Ua(h);c<r?(r=c,s=l,o=u<o?u:o):c===r&&u<o&&(o=u,s=l)}return s||n-t}_chooseSplitAxis(e,t,n){const s=e.leaf?this.compareMinX:Vx,r=e.leaf?this.compareMinY:jx,o=this._allDistMargin(e,t,n,s),l=this._allDistMargin(e,t,n,r);o<l&&e.children.sort(s)}_allDistMargin(e,t,n,s){e.children.sort(s);const r=this.toBBox,o=_r(e,0,t,r),l=_r(e,n-t,n,r);let a=Mo(o)+Mo(l);for(let h=t;h<n-t;h++){const c=e.children[h];pr(o,e.leaf?r(c):c),a+=Mo(o)}for(let h=n-t-1;h>=t;h--){const c=e.children[h];pr(l,e.leaf?r(c):c),a+=Mo(l)}return a}_adjustParentBBoxes(e,t,n){for(let s=n;s>=0;s--)pr(t[s],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():ds(e[t],this.toBBox)}};function Gx(i,e,t){if(!t)return e.indexOf(i);for(let n=0;n<e.length;n++)if(t(i,e[n]))return n;return-1}function ds(i,e){_r(i,0,i.children.length,e,i)}function _r(i,e,t,n,s){s||(s=xs(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r=e;r<t;r++){const o=i.children[r];pr(s,i.leaf?n(o):o)}return s}function pr(i,e){return i.minX=Math.min(i.minX,e.minX),i.minY=Math.min(i.minY,e.minY),i.maxX=Math.max(i.maxX,e.maxX),i.maxY=Math.max(i.maxY,e.maxY),i}function Vx(i,e){return i.minX-e.minX}function jx(i,e){return i.minY-e.minY}function Ua(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Mo(i){return i.maxX-i.minX+(i.maxY-i.minY)}function zx(i,e){return(Math.max(e.maxX,i.maxX)-Math.min(e.minX,i.minX))*(Math.max(e.maxY,i.maxY)-Math.min(e.minY,i.minY))}function Bx(i,e){const t=Math.max(i.minX,e.minX),n=Math.max(i.minY,e.minY),s=Math.min(i.maxX,e.maxX),r=Math.min(i.maxY,e.maxY);return Math.max(0,s-t)*Math.max(0,r-n)}function Ka(i,e){return i.minX<=e.minX&&i.minY<=e.minY&&e.maxX<=i.maxX&&e.maxY<=i.maxY}function Oo(i,e){return e.minX<=i.maxX&&e.minY<=i.maxY&&e.maxX>=i.minX&&e.maxY>=i.minY}function xs(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Qd(i,e,t,n,s){const r=[e,t];for(;r.length;){if(t=r.pop(),e=r.pop(),t-e<=n)continue;const o=e+Math.ceil((t-e)/n/2)*n;s_(i,o,e,t,s),r.push(e,o,o,t)}}const su=[NaN,NaN,NaN,0];let Xa;function Wx(){return Xa||(Xa=qe(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Xa}const Ux=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Kx=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Xx=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Hx=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Fo(i,e){return i.endsWith("%")?Number(i.substring(0,i.length-1))/e:Number(i)}function Pr(i){throw new Error('failed to parse "'+i+'" as color')}function o_(i){if(i.toLowerCase().startsWith("rgb")){const r=i.match(Kx)||i.match(Ux)||i.match(Xx);if(r){const o=r[4],l=100/255;return[ze(Fo(r[1],l)+.5|0,0,255),ze(Fo(r[2],l)+.5|0,0,255),ze(Fo(r[3],l)+.5|0,0,255),o!==void 0?ze(Fo(o,100),0,1):1]}Pr(i)}if(i.startsWith("#")){if(Hx.test(i)){const r=i.substring(1),o=r.length<=4?1:2,l=[0,0,0,255];for(let a=0,h=r.length;a<h;a+=o){let c=parseInt(r.substring(a,a+o),16);o===1&&(c+=c<<4),l[a/o]=c}return l[3]=l[3]/255,l}Pr(i)}const e=Wx();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=i,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=i,e.fillStyle===t&&Pr(i));const n=e.fillStyle;if(n.startsWith("#")||n.startsWith("rgba"))return o_(n);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const s=Array.from(e.getImageData(0,0,1,1).data);return s[3]=ao(s[3]/255,3),s}function Yx(i){return typeof i=="string"?i:ou(i)}const Zx=1024,hr={};let Ha=0;function $x(i){if(i.length===4)return i;const e=i.slice();return e[3]=1,e}function Ya(i){return i>.0031308?Math.pow(i,1/2.4)*269.025-14.025:i*3294.6}function Za(i){return i>.2068965?Math.pow(i,3):(i-4/29)*(108/841)}function $a(i){return i>10.314724?Math.pow((i+14.025)/269.025,2.4):i/3294.6}function qa(i){return i>.0088564?Math.pow(i,1/3):i/(108/841)+4/29}function ef(i){const e=$a(i[0]),t=$a(i[1]),n=$a(i[2]),s=qa(e*.222488403+t*.716873169+n*.06060791),r=500*(qa(e*.452247074+t*.399439023+n*.148375274)-s),o=200*(s-qa(e*.016863605+t*.117638439+n*.865350722)),l=Math.atan2(o,r)*(180/Math.PI);return[116*s-16,Math.sqrt(r*r+o*o),l<0?l+360:l,i[3]]}function qx(i){const e=(i[0]+16)/116,t=i[1],n=i[2]*Math.PI/180,s=Za(e),r=Za(e+t/500*Math.cos(n)),o=Za(e-t/200*Math.sin(n)),l=Ya(r*3.021973625-s*1.617392459-o*.404875592),a=Ya(r*-.943766287+s*1.916279586+o*.027607165),h=Ya(r*.069407491-s*.22898585+o*1.159737864);return[ze(l+.5|0,0,255),ze(a+.5|0,0,255),ze(h+.5|0,0,255),i[3]]}function ru(i){if(i==="none")return su;if(hr.hasOwnProperty(i))return hr[i];if(Ha>=Zx){let t=0;for(const n in hr)(t++&3)===0&&(delete hr[n],--Ha)}const e=o_(i);e.length!==4&&Pr(i);for(const t of e)isNaN(t)&&Pr(i);return hr[i]=e,++Ha,e}function Us(i){return Array.isArray(i)?i:ru(i)}function ou(i){let e=i[0];e!=(e|0)&&(e=e+.5|0);let t=i[1];t!=(t|0)&&(t=t+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const s=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+e+","+t+","+n+","+s+")"}function tf(i){return i[0]>0&&i[1]>0}function Jx(i,e,t){return t===void 0&&(t=[0,0]),t[0]=i[0]*e+.5|0,t[1]=i[1]*e+.5|0,t}function gt(i,e){return Array.isArray(i)?i:(e===void 0?e=[i,i]:(e[0]=i,e[1]=i),e)}let as=0;const Et=1<<as++,Ce=1<<as++,bt=1<<as++,ei=1<<as++,ss=1<<as++,yr=1<<as++,Do=Math.pow(2,as)-1,lu={[Et]:"boolean",[Ce]:"number",[bt]:"string",[ei]:"color",[ss]:"number[]",[yr]:"size"},Qx=Object.keys(lu).map(Number).sort(xi);function ew(i){return i in lu}function Cr(i){const e=[];for(const t of Qx)vr(i,t)&&e.push(lu[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function vr(i,e){return(i&e)===e}function on(i,e){return i===e}class Qe{constructor(e,t){if(!ew(e))throw new Error(`literal expressions must have a specific type, got ${Cr(e)}`);this.type=e,this.value=t}}class tw{constructor(e,t,...n){this.type=e,this.operator=t,this.args=n}}function l_(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function at(i,e,t){switch(typeof i){case"boolean":{if(on(e,bt))return new Qe(bt,i?"true":"false");if(!vr(e,Et))throw new Error(`got a boolean, but expected ${Cr(e)}`);return new Qe(Et,i)}case"number":{if(on(e,yr))return new Qe(yr,gt(i));if(on(e,Et))return new Qe(Et,!!i);if(on(e,bt))return new Qe(bt,i.toString());if(!vr(e,Ce))throw new Error(`got a number, but expected ${Cr(e)}`);return new Qe(Ce,i)}case"string":{if(on(e,ei))return new Qe(ei,ru(i));if(on(e,Et))return new Qe(Et,!!i);if(!vr(e,bt))throw new Error(`got a string, but expected ${Cr(e)}`);return new Qe(bt,i)}}if(!Array.isArray(i))throw new Error("expression must be an array or a primitive value");if(i.length===0)throw new Error("empty expression");if(typeof i[0]=="string")return dw(i,e,t);for(const n of i)if(typeof n!="number")throw new Error("expected an array of numbers");if(on(e,yr)){if(i.length!==2)throw new Error(`expected an array of two values for a size, got ${i.length}`);return new Qe(yr,i)}if(on(e,ei)){if(i.length===3)return new Qe(ei,[...i,1]);if(i.length===4)return new Qe(ei,i);throw new Error(`expected an array of 3 or 4 values for a color, got ${i.length}`)}if(!vr(e,ss))throw new Error(`got an array of numbers, but expected ${Cr(e)}`);return new Qe(ss,i)}const D={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},iw={[D.Get]:ce(fe(1,1/0),nf),[D.Var]:ce(fe(1,1),nw),[D.Has]:ce(fe(1,1/0),nf),[D.Id]:ce(sw,fs),[D.Concat]:ce(fe(2,1/0),Se(bt)),[D.GeometryType]:ce(rw,fs),[D.LineMetric]:ce(fs),[D.Resolution]:ce(Ja,fs),[D.Zoom]:ce(Ja,fs),[D.Time]:ce(Ja,fs),[D.Any]:ce(fe(2,1/0),Se(Et)),[D.All]:ce(fe(2,1/0),Se(Et)),[D.Not]:ce(fe(1,1),Se(Et)),[D.Equal]:ce(fe(2,2),Se(Do)),[D.NotEqual]:ce(fe(2,2),Se(Do)),[D.GreaterThan]:ce(fe(2,2),Se(Ce)),[D.GreaterThanOrEqualTo]:ce(fe(2,2),Se(Ce)),[D.LessThan]:ce(fe(2,2),Se(Ce)),[D.LessThanOrEqualTo]:ce(fe(2,2),Se(Ce)),[D.Multiply]:ce(fe(2,1/0),sf),[D.Coalesce]:ce(fe(2,1/0),sf),[D.Divide]:ce(fe(2,2),Se(Ce)),[D.Add]:ce(fe(2,1/0),Se(Ce)),[D.Subtract]:ce(fe(2,2),Se(Ce)),[D.Clamp]:ce(fe(3,3),Se(Ce)),[D.Mod]:ce(fe(2,2),Se(Ce)),[D.Pow]:ce(fe(2,2),Se(Ce)),[D.Abs]:ce(fe(1,1),Se(Ce)),[D.Floor]:ce(fe(1,1),Se(Ce)),[D.Ceil]:ce(fe(1,1),Se(Ce)),[D.Round]:ce(fe(1,1),Se(Ce)),[D.Sin]:ce(fe(1,1),Se(Ce)),[D.Cos]:ce(fe(1,1),Se(Ce)),[D.Atan]:ce(fe(1,2),Se(Ce)),[D.Sqrt]:ce(fe(1,1),Se(Ce)),[D.Match]:ce(fe(4,1/0),rf,lw),[D.Between]:ce(fe(3,3),Se(Ce)),[D.Interpolate]:ce(fe(6,1/0),rf,aw),[D.Case]:ce(fe(3,1/0),ow,cw),[D.In]:ce(fe(2,2),hw),[D.Number]:ce(fe(1,1/0),Se(Do)),[D.String]:ce(fe(1,1/0),Se(Do)),[D.Array]:ce(fe(1,1/0),Se(Ce)),[D.Color]:ce(fe(1,4),Se(Ce)),[D.Band]:ce(fe(1,3),Se(Ce)),[D.Palette]:ce(fe(2,2),uw),[D.ToString]:ce(fe(1,1),Se(Et|Ce|bt|ei))};function nf(i,e,t){const n=i.length-1,s=new Array(n);for(let r=0;r<n;++r){const o=i[r+1];switch(typeof o){case"number":{s[r]=new Qe(Ce,o);break}case"string":{s[r]=new Qe(bt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}r===0&&t.properties.add(String(o))}return s}function nw(i,e,t){const n=i[1];if(typeof n!="string")throw new Error("expected a string argument for var operation");return t.variables.add(n),[new Qe(bt,n)]}function sw(i,e,t){t.featureId=!0}function rw(i,e,t){t.geometryType=!0}function Ja(i,e,t){t.mapState=!0}function fs(i,e,t){const n=i[0];if(i.length!==1)throw new Error(`expected no arguments for ${n} operation`);return[]}function fe(i,e){return function(t,n,s){const r=t[0],o=t.length-1;if(i===e){if(o!==i){const l=i===1?"":"s";throw new Error(`expected ${i} argument${l} for ${r}, got ${o}`)}}else if(o<i||o>e){const l=e===1/0?`${i} or more`:`${i} to ${e}`;throw new Error(`expected ${l} arguments for ${r}, got ${o}`)}}}function sf(i,e,t){const n=i.length-1,s=new Array(n);for(let r=0;r<n;++r){const o=at(i[r+1],e,t);s[r]=o}return s}function Se(i){return function(e,t,n){const s=e.length-1,r=new Array(s);for(let o=0;o<s;++o){const l=at(e[o+1],i,n);r[o]=l}return r}}function ow(i,e,t){const n=i[0],s=i.length-1;if(s%2===0)throw new Error(`expected an odd number of arguments for ${n}, got ${s} instead`)}function rf(i,e,t){const n=i[0],s=i.length-1;if(s%2===1)throw new Error(`expected an even number of arguments for operation ${n}, got ${s} instead`)}function lw(i,e,t){const n=i.length-1,s=bt|Ce|Et,r=at(i[1],s,t),o=at(i[i.length-1],e,t),l=new Array(n-2);for(let a=0;a<n-2;a+=2){try{const h=at(i[a+2],r.type,t);l[a]=h}catch(h){throw new Error(`failed to parse argument ${a+1} of match expression: ${h.message}`)}try{const h=at(i[a+3],o.type,t);l[a+1]=h}catch(h){throw new Error(`failed to parse argument ${a+2} of match expression: ${h.message}`)}}return[r,...l,o]}function aw(i,e,t){const n=i[1];let s;switch(n[0]){case"linear":s=1;break;case"exponential":const a=n[1];if(typeof a!="number"||a<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(a)} instead`);s=a;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(n)}`)}const r=new Qe(Ce,s);let o;try{o=at(i[2],Ce,t)}catch(a){throw new Error(`failed to parse argument 1 in interpolate expression: ${a.message}`)}const l=new Array(i.length-3);for(let a=0;a<l.length;a+=2){try{const h=at(i[a+3],Ce,t);l[a]=h}catch(h){throw new Error(`failed to parse argument ${a+2} for interpolate expression: ${h.message}`)}try{const h=at(i[a+4],e,t);l[a+1]=h}catch(h){throw new Error(`failed to parse argument ${a+3} for interpolate expression: ${h.message}`)}}return[r,o,...l]}function cw(i,e,t){const n=at(i[i.length-1],e,t),s=new Array(i.length-1);for(let r=0;r<s.length-1;r+=2){try{const o=at(i[r+1],Et,t);s[r]=o}catch(o){throw new Error(`failed to parse argument ${r} of case expression: ${o.message}`)}try{const o=at(i[r+2],n.type,t);s[r+1]=o}catch(o){throw new Error(`failed to parse argument ${r+1} of case expression: ${o.message}`)}}return s[s.length-1]=n,s}function hw(i,e,t){let n=i[2];if(!Array.isArray(n))throw new Error('the second argument for the "in" operator must be an array');let s;if(typeof n[0]=="string"){if(n[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(n[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');n=n[1],s=bt}else s=Ce;const r=new Array(n.length);for(let l=0;l<r.length;l++)try{const a=at(n[l],s,t);r[l]=a}catch(a){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${a.message}`)}return[at(i[1],s,t),...r]}function uw(i,e,t){let n;try{n=at(i[1],Ce,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const s=i[2];if(!Array.isArray(s))throw new Error("the second argument of palette must be an array");const r=new Array(s.length);for(let o=0;o<r.length;o++){let l;try{l=at(s[o],ei,t)}catch(a){throw new Error(`failed to parse color at index ${o} in palette expression: ${a.message}`)}if(!(l instanceof Qe))throw new Error(`the palette color at index ${o} must be a literal value`);r[o]=l}return[n,...r]}function ce(...i){return function(e,t,n){const s=e[0];let r;for(let o=0;o<i.length;o++){const l=i[o](e,t,n);if(o==i.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");r=l}}return new tw(t,s,...r)}}function dw(i,e,t){const n=i[0],s=iw[n];if(!s)throw new Error(`unknown operator: ${n}`);return s(i,e,t)}function a_(i){if(!i)return"";const e=i.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return a_(i.getGeometries()[0]);default:return""}}function c_(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function tn(i,e,t){const n=at(i,e,t);return ui(n)}function ui(i,e){if(i instanceof Qe){if(i.type===ei&&typeof i.value=="string"){const n=ru(i.value);return function(){return n}}return function(){return i.value}}const t=i.operator;switch(t){case D.Number:case D.String:case D.Coalesce:return fw(i);case D.Get:case D.Var:case D.Has:return gw(i);case D.Id:return n=>n.featureId;case D.GeometryType:return n=>n.geometryType;case D.Concat:{const n=i.args.map(s=>ui(s));return s=>"".concat(...n.map(r=>r(s).toString()))}case D.Resolution:return n=>n.resolution;case D.Any:case D.All:case D.Between:case D.In:case D.Not:return _w(i);case D.Equal:case D.NotEqual:case D.LessThan:case D.LessThanOrEqualTo:case D.GreaterThan:case D.GreaterThanOrEqualTo:return mw(i);case D.Multiply:case D.Divide:case D.Add:case D.Subtract:case D.Clamp:case D.Mod:case D.Pow:case D.Abs:case D.Floor:case D.Ceil:case D.Round:case D.Sin:case D.Cos:case D.Atan:case D.Sqrt:return pw(i);case D.Case:return yw(i);case D.Match:return Cw(i);case D.Interpolate:return vw(i);case D.ToString:return Ew(i);default:throw new Error(`Unsupported operator ${t}`)}}function fw(i,e){const t=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=ui(i.args[r]);switch(t){case D.Coalesce:return r=>{for(let o=0;o<n;++o){const l=s[o](r);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case D.Number:case D.String:return r=>{for(let o=0;o<n;++o){const l=s[o](r);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function gw(i,e){const n=i.args[0].value;switch(i.operator){case D.Get:return s=>{const r=i.args;let o=s.properties[n];for(let l=1,a=r.length;l<a;++l){const c=r[l].value;o=o[c]}return o};case D.Var:return s=>s.variables[n];case D.Has:return s=>{const r=i.args;if(!(n in s.properties))return!1;let o=s.properties[n];for(let l=1,a=r.length;l<a;++l){const c=r[l].value;if(!o||!Object.hasOwn(o,c))return!1;o=o[c]}return!0};default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function mw(i,e){const t=i.operator,n=ui(i.args[0]),s=ui(i.args[1]);switch(t){case D.Equal:return r=>n(r)===s(r);case D.NotEqual:return r=>n(r)!==s(r);case D.LessThan:return r=>n(r)<s(r);case D.LessThanOrEqualTo:return r=>n(r)<=s(r);case D.GreaterThan:return r=>n(r)>s(r);case D.GreaterThanOrEqualTo:return r=>n(r)>=s(r);default:throw new Error(`Unsupported comparison operator ${t}`)}}function _w(i,e){const t=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=ui(i.args[r]);switch(t){case D.Any:return r=>{for(let o=0;o<n;++o)if(s[o](r))return!0;return!1};case D.All:return r=>{for(let o=0;o<n;++o)if(!s[o](r))return!1;return!0};case D.Between:return r=>{const o=s[0](r),l=s[1](r),a=s[2](r);return o>=l&&o<=a};case D.In:return r=>{const o=s[0](r);for(let l=1;l<n;++l)if(o===s[l](r))return!0;return!1};case D.Not:return r=>!s[0](r);default:throw new Error(`Unsupported logical operator ${t}`)}}function pw(i,e){const t=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=ui(i.args[r]);switch(t){case D.Multiply:return r=>{let o=1;for(let l=0;l<n;++l)o*=s[l](r);return o};case D.Divide:return r=>s[0](r)/s[1](r);case D.Add:return r=>{let o=0;for(let l=0;l<n;++l)o+=s[l](r);return o};case D.Subtract:return r=>s[0](r)-s[1](r);case D.Clamp:return r=>{const o=s[0](r),l=s[1](r);if(o<l)return l;const a=s[2](r);return o>a?a:o};case D.Mod:return r=>s[0](r)%s[1](r);case D.Pow:return r=>Math.pow(s[0](r),s[1](r));case D.Abs:return r=>Math.abs(s[0](r));case D.Floor:return r=>Math.floor(s[0](r));case D.Ceil:return r=>Math.ceil(s[0](r));case D.Round:return r=>Math.round(s[0](r));case D.Sin:return r=>Math.sin(s[0](r));case D.Cos:return r=>Math.cos(s[0](r));case D.Atan:return n===2?r=>Math.atan2(s[0](r),s[1](r)):r=>Math.atan(s[0](r));case D.Sqrt:return r=>Math.sqrt(s[0](r));default:throw new Error(`Unsupported numeric operator ${t}`)}}function yw(i,e){const t=i.args.length,n=new Array(t);for(let s=0;s<t;++s)n[s]=ui(i.args[s]);return s=>{for(let r=0;r<t-1;r+=2)if(n[r](s))return n[r+1](s);return n[t-1](s)}}function Cw(i,e){const t=i.args.length,n=new Array(t);for(let s=0;s<t;++s)n[s]=ui(i.args[s]);return s=>{const r=n[0](s);for(let o=1;o<t-1;o+=2)if(r===n[o](s))return n[o+1](s);return n[t-1](s)}}function vw(i,e){const t=i.args.length,n=new Array(t);for(let s=0;s<t;++s)n[s]=ui(i.args[s]);return s=>{const r=n[0](s),o=n[1](s);let l,a;for(let h=2;h<t;h+=2){const c=n[h](s);let u=n[h+1](s);const d=Array.isArray(u);if(d&&(u=$x(u)),c>=o)return h===2?u:d?xw(r,o,l,a,c,u):Er(r,o,l,a,c,u);l=c,a=u}return a}}function Ew(i,e){const t=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=ui(i.args[r]);if(t===D.ToString)return r=>{const o=s[0](r);return i.args[0].type===ei?ou(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Er(i,e,t,n,s,r){const o=s-t;if(o===0)return n;const l=e-t,a=i===1?l/o:(Math.pow(i,l)-1)/(Math.pow(i,o)-1);return n+a*(r-n)}function xw(i,e,t,n,s,r){if(s-t===0)return n;const l=ef(n),a=ef(r);let h=a[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const c=[Er(i,e,t,l[0],s,a[0]),Er(i,e,t,l[1],s,a[1]),l[2]+Er(i,e,t,0,s,h),Er(i,e,t,n[3],s,r[3])];return qx(c)}const te={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class au extends oo{constructor(e,t,n,s){super(),this.extent=e,this.pixelRatio_=n,this.resolution=t,this.state=typeof s=="function"?te.IDLE:s,this.image_=null,this.loader=typeof s=="function"?s:null}changed(){this.dispatchEvent(le.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==te.IDLE&&this.loader){this.state=te.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;mm(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(n=>{"image"in n&&(this.image_=n.image),"extent"in n&&(this.extent=n.extent),"resolution"in n&&(this.resolution=n.resolution),"pixelRatio"in n&&(this.pixelRatio_=n.pixelRatio),(n instanceof HTMLImageElement||ym&&n instanceof ImageBitmap||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement)&&(this.image_=n),this.state=te.LOADED}).catch(n=>{this.state=te.ERROR,console.error(n)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function ww(i,e,t){const n=i;let s=!0,r=!1,o=!1;const l=[ll(n,le.LOAD,function(){o=!0,r||e()})];return n.src&&Th?(r=!0,n.decode().then(function(){s&&e()}).catch(function(a){s&&(o?e():t())})):l.push(ll(n,le.ERROR,t)),function(){s=!1,l.forEach(Ne)}}function Rw(i,e){return new Promise((t,n)=>{function s(){o(),t(i)}function r(){o(),n(new Error("Image load error"))}function o(){i.removeEventListener("load",s),i.removeEventListener("error",r)}i.addEventListener("load",s),i.addEventListener("error",r)})}function h_(i,e){return e&&(i.src=e),i.src&&Th?new Promise((t,n)=>i.decode().then(()=>t(i)).catch(s=>i.complete&&i.width?t(i):n(s))):Rw(i)}function ra(i,e){return e&&(i.src=e),i.src&&Th&&ym?i.decode().then(()=>createImageBitmap(i)).catch(t=>{if(i.complete&&i.width)return i;throw t}):h_(i)}class Tw{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,n){const s=Qa(e,t,n);return s in this.cache_?this.cache_[s]:null}getPattern(e,t,n){const s=Qa(e,t,n);return s in this.patternCache_?this.patternCache_[s]:null}set(e,t,n,s,r){const o=Qa(e,t,n),l=o in this.cache_;this.cache_[o]=s,r&&(s.getImageState()===te.IDLE&&s.load(),s.getImageState()===te.LOADING?s.ready().then(()=>{this.patternCache_[o]=gl().createPattern(s.getImage(1),"repeat")}):this.patternCache_[o]=gl().createPattern(s.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function Qa(i,e,t){const n=t?Us(t):"null";return e+":"+i+":"+n}const Xt=new Tw;let ur=null;class u_ extends oo{constructor(e,t,n,s,r){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=n,this.canvas_={},this.color_=r,this.imageState_=s===void 0?te.IDLE:s,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===te.LOADED){ur||(ur=qe(1,1,void 0,{willReadFrequently:!0})),ur.drawImage(this.image_,0,0);try{ur.getImageData(0,0,1,1),this.tainted_=!1}catch{ur=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(le.CHANGE)}handleImageError_(){this.imageState_=te.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=te.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],n=qe(e,t);n.fillRect(0,0,e,t),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===te.IDLE){this.image_||this.initializeImage_(),this.imageState_=te.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&h_(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==te.LOADED)return;const t=this.image_,n=qe(Math.ceil(t.width*e),Math.ceil(t.height*e)),s=n.canvas;n.scale(e,e),n.drawImage(t,0,0),n.globalCompositeOperation="multiply",n.fillStyle=Yx(this.color_),n.fillRect(0,0,s.width/e,s.height/e),n.globalCompositeOperation="destination-in",n.drawImage(t,0,0),this.canvas_[e]=s}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===te.LOADED||this.imageState_===te.ERROR)e();else{const t=()=>{(this.imageState_===te.LOADED||this.imageState_===te.ERROR)&&(this.removeEventListener(le.CHANGE,t),e())};this.addEventListener(le.CHANGE,t)}})),this.ready_}}function ml(i,e,t,n,s,r){let o=e===void 0?void 0:Xt.get(e,t,s);return o||(o=new u_(i,i&&"src"in i?i.src||void 0:e,t,n,s),Xt.set(e,t,s,o,r)),r&&o&&!Xt.getPattern(e,t,s)&&Xt.set(e,t,s,o,r),o}function vi(i){return i?Array.isArray(i)?ou(i):typeof i=="object"&&"src"in i?Sw(i):i:null}function Sw(i){if(!i.offset||!i.size)return Xt.getPattern(i.src,"anonymous",i.color);const e=i.src+":"+i.offset,t=Xt.getPattern(e,void 0,i.color);if(t)return t;const n=Xt.get(i.src,"anonymous",null);if(n.getImageState()!==te.LOADED)return null;const s=qe(i.size[0],i.size[1]);return s.drawImage(n.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),ml(s.canvas,e,void 0,te.LOADED,i.color,!0),Xt.getPattern(e,void 0,i.color)}const d_="10px sans-serif",At="#000",Ks="round",Ki=[],Xi=0,Xs="round",Xr=10,Hr="#000",Yr="center",_l="middle",Hn=[0,0,0,0],Zr=1,ws=new di;let dr=null,of;const Uc={},Iw=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function bw(i,e,t){return`${i} ${e} 16px "${t}"`}const Aw=(function(){let e,t;async function n(r){await t.ready;const o=await t.load(r);if(o.length===0)return!1;const l=Bc(r),a=l.families[0].toLowerCase(),h=l.weight;return o.some(c=>{const u=c.family.replace(/^['"]|['"]$/g,"").toLowerCase(),d=zc[c.weight]||c.weight;return u===a&&c.style===l.style&&d==h})}async function s(){await t.ready;let r=!0;const o=ws.getProperties(),l=Object.keys(o).filter(a=>o[a]<100);for(let a=l.length-1;a>=0;--a){const h=l[a];let c=o[h];c<100&&(await n(h)?(ro(Uc),ws.set(h,100)):(c+=10,ws.set(h,c,!0),c<100&&(r=!1)))}e=void 0,r||(e=setTimeout(s,100))}return async function(r){t||(t=Ut?self.fonts:document.fonts);const o=Bc(r);if(!o)return;const l=o.families;let a=!1;for(const h of l){if(Iw.has(h))continue;const c=bw(o.style,o.weight,h);ws.get(c)===void 0&&(ws.set(c,0,!0),a=!0)}a&&(clearTimeout(e),e=setTimeout(s,100))}})(),Lw=(function(){let i;return function(e){let t=Uc[e];if(t==null){if(Ut){const n=Bc(e),s=f_(e,"g");t=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=e,document.body.appendChild(i),t=i.offsetHeight,document.body.removeChild(i);Uc[e]=t}return t}})();function f_(i,e){return dr||(dr=qe(1,1)),i!=of&&(dr.font=i,of=dr.font),dr.measureText(e)}function g_(i,e){return f_(i,e).width}function lf(i,e,t){if(e in t)return t[e];const n=e.split(`
`).reduce((s,r)=>Math.max(s,g_(i,r)),0);return t[e]=n,n}function Pw(i,e){const t=[],n=[],s=[];let r=0,o=0,l=0,a=0;for(let h=0,c=e.length;h<=c;h+=2){const u=e[h];if(u===`
`||h===c){r=Math.max(r,o),s.push(o),o=0,l+=a,a=0;continue}const d=e[h+1]||i.font,f=g_(d,u);t.push(f),o+=f;const g=Lw(d);n.push(g),a=Math.max(a,g)}return{width:r,height:l,widths:t,heights:n,lineWidths:s}}function Mw(i,e,t,n,s,r,o,l,a,h,c){i.save(),t!==1&&(i.globalAlpha===void 0?i.globalAlpha=u=>u.globalAlpha*=t:i.globalAlpha*=t),e&&i.transform.apply(i,e),n.contextInstructions?(i.translate(a,h),i.scale(c[0],c[1]),Ow(n,i)):c[0]<0||c[1]<0?(i.translate(a,h),i.scale(c[0],c[1]),i.drawImage(n,s,r,o,l,0,0,o,l)):i.drawImage(n,s,r,o,l,a,h,o*c[0],l*c[1]),i.restore()}function Ow(i,e){const t=i.contextInstructions;for(let n=0,s=t.length;n<s;n+=2)Array.isArray(t[n+1])?e[t[n]].apply(e,t[n+1]):e[t[n]]=t[n+1]}class oa{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=gt(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new oa({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ge()}getImage(e){return ge()}getHitDetectionImage(){return ge()}getPixelRatio(e){return 1}getImageState(){return ge()}getImageSize(){return ge()}getOrigin(){return ge()}getSize(){return ge()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=gt(e)}listenImageChange(e){ge()}load(){ge()}unlistenImageChange(e){ge()}ready(){return Promise.resolve()}}class la extends oa{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?te.LOADING:te.LOADED,this.imageState_===te.LOADING&&this.ready().then(()=>this.imageState_=te.LOADED),this.render()}clone(){const e=this.getScale(),t=new la({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),n=this.getScaleArray();return[e[0]/2-t[0]/n[0],e[1]/2+t[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),n=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let s=Xt.get(n,null,null)?.getImage(1);if(!s){const r=this.renderOptions_,o=Math.ceil(r.size*e),l=qe(o,o);this.draw_(r,l,e),s=l.canvas,Xt.set(n,null,null,new u_(s,void 0,null,te.LOADED,null))}return s}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,n){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let s=this.radius,r=this.radius2_===void 0?s:this.radius2_;if(s<r){const T=s;s=r,r=T}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,a=r*Math.sin(l),h=Math.sqrt(r*r-a*a),c=s-h,u=Math.sqrt(a*a+c*c),d=u/a;if(e==="miter"&&d<=n)return d*t;const f=t/2/d,g=t/2*(c/u),_=Math.sqrt((s+f)*(s+f)+g*g)-s;if(this.radius2_===void 0||e==="bevel")return _*2;const p=s*Math.sin(l),y=Math.sqrt(s*s-p*p),v=r-y,x=Math.sqrt(p*p+v*v)/p;if(x<=n){const T=x*t/2-r-s;return 2*Math.max(_,T)}return _*2}createRenderOptions(){let e=Ks,t=Xs,n=0,s=null,r=0,o,l=0;this.stroke_&&(o=vi(this.stroke_.getColor()??Hr),l=this.stroke_.getWidth()??Zr,s=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??Xs,e=this.stroke_.getLineCap()??Ks,n=this.stroke_.getMiterLimit()??Xr);const a=this.calculateLineJoinSize_(t,l,n),h=Math.max(this.radius,this.radius2_||0),c=Math.ceil(2*h+a);return{strokeStyle:o,strokeWidth:l,size:c,lineCap:e,lineDash:s,lineDashOffset:r,lineJoin:t,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,n){if(t.scale(n,n),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let s=this.fill_.getColor();s===null&&(s=At),t.fillStyle=vi(s),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let n=this.fill_.getColor(),s=0;typeof n=="string"&&(n=Us(n)),n===null?s=1:Array.isArray(n)&&(s=n.length===4?n[3]:1),s===0&&(t=qe(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const n=this.radius;if(t===1/0)e.arc(0,0,n,0,2*Math.PI);else{const s=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(t*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const a=r+l*o,h=l%2===0?n:s;e.lineTo(h*Math.cos(a),h*Math.sin(a))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=At,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class aa extends la{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new aa({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Sn{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Sn({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=ml(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===te.IDLE&&t.load(),t.getImageState()===te.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?de(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Us(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function af(i,e,t,n){return t!==void 0&&n!==void 0?[t/i,n/e]:t!==void 0?t/i:n!==void 0?n/e:1}class In extends oa{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,n=e.rotation!==void 0?e.rotation:0,s=e.scale!==void 0?e.scale:1,r=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:n,scale:s,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:r,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;we(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||de(o)),we(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),we(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let a;if(e.src!==void 0?a=te.IDLE:o!==void 0&&("complete"in o?o.complete?a=o.src?te.LOADED:te.IDLE:a=te.LOADING:a=te.LOADED),this.color_=e.color!==void 0?Us(e.color):null,this.iconImage_=ml(o,l,this.crossOrigin_,a,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,c;if(e.size)[h,c]=e.size;else{const u=this.getImage(1);if(u.width&&u.height)h=u.width,c=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(af(f[0],f[1],e.width,e.height))};this.listenImageChange(d);return}}h!==void 0&&this.setScale(af(h,c,e.width,e.height))}}clone(){let e,t,n;return this.initialOptions_?(t=this.initialOptions_.width,n=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new In({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=s[0]),this.anchorYUnits_=="fraction"&&(e[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+s[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),n=this.getScaleArray();return[e[0]-t[0]/n[0],e[1]+t[1]/n[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),n=this.iconImage_.getSize();if(!t||!n)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=n[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=n[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=ml(null,e,this.crossOrigin_,te.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==te.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==te.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(le.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(le.CHANGE,e)}ready(){return this.iconImage_.ready()}}class rs{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new rs({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class Ri{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=cf,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Ri({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=cf,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function Fw(i){let e;if(typeof i=="function")e=i;else{let t;Array.isArray(i)?t=i:(we(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[i]),e=function(){return t}}return e}let ec=null;function m_(i,e){if(!ec){const t=new Sn({color:"rgba(255,255,255,0.4)"}),n=new rs({color:"#3399CC",width:1.25});ec=[new Ri({image:new aa({fill:t,stroke:n,radius:5}),fill:t,stroke:n})]}return ec}function cf(i){return i.getGeometry()}const Dw="#333";class $r{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=gt(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Sn({color:Dw}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new $r({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Sn?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=gt(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}function kw(i){return!0}function Nw(i){const e=l_(),t=Gw(i,e),n=c_();return function(s,r){if(n.properties=s.getPropertiesInternal(),n.resolution=r,e.featureId){const o=s.getId();o!==void 0?n.featureId=o:n.featureId=null}return e.geometryType&&(n.geometryType=a_(s.getGeometry())),t(n)}}function hf(i){const e=l_(),t=i.length,n=new Array(t);for(let o=0;o<t;++o)n[o]=Kc(i[o],e);const s=c_(),r=new Array(t);return function(o,l){if(s.properties=o.getPropertiesInternal(),s.resolution=l,e.featureId){const h=o.getId();h!==void 0?s.featureId=h:s.featureId=null}let a=0;for(let h=0;h<t;++h){const c=n[h](s);c&&(r[a]=c,a+=1)}return r.length=a,r}}function Gw(i,e){const t=i.length,n=new Array(t);for(let s=0;s<t;++s){const r=i[s],o="filter"in r?tn(r.filter,Et,e):kw;let l;if(Array.isArray(r.style)){const a=r.style.length;l=new Array(a);for(let h=0;h<a;++h)l[h]=Kc(r.style[h],e)}else l=[Kc(r.style,e)];n[s]={filter:o,styles:l}}return function(s){const r=[];let o=!1;for(let l=0;l<t;++l){const a=n[l].filter;if(a(s)&&!(i[l].else&&o)){o=!0;for(const h of n[l].styles){const c=h(s);c&&r.push(c)}}}return r}}function Kc(i,e){const t=qr(i,"",e),n=Jr(i,"",e),s=Vw(i,e),r=jw(i,e),o=Pt(i,"z-index",e);if(!t&&!n&&!s&&!r&&!es(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const l=new Ri;return function(a){let h=!0;if(t){const c=t(a);c&&(h=!1),l.setFill(c)}if(n){const c=n(a);c&&(h=!1),l.setStroke(c)}if(s){const c=s(a);c&&(h=!1),l.setText(c)}if(r){const c=r(a);c&&(h=!1),l.setImage(c)}return o&&l.setZIndex(o(a)),h?null:l}}function qr(i,e,t){let n;if(e+"fill-pattern-src"in i)n=Uw(i,e+"fill-",t);else{if(i[e+"fill-color"]==="none")return r=>null;n=cu(i,e+"fill-color",t)}if(!n)return null;const s=new Sn;return function(r){const o=n(r);return o===su?null:(s.setColor(o),s)}}function Jr(i,e,t){const n=Pt(i,e+"stroke-width",t),s=cu(i,e+"stroke-color",t);if(!n&&!s)return null;const r=Bi(i,e+"stroke-line-cap",t),o=Bi(i,e+"stroke-line-join",t),l=__(i,e+"stroke-line-dash",t),a=Pt(i,e+"stroke-line-dash-offset",t),h=Pt(i,e+"stroke-miter-limit",t),c=new rs;return function(u){if(s){const d=s(u);if(d===su)return null;c.setColor(d)}if(n&&c.setWidth(n(u)),r){const d=r(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(d)}return l&&c.setLineDash(l(u)),a&&c.setLineDashOffset(a(u)),h&&c.setMiterLimit(h(u)),c}}function Vw(i,e){const t="text-",n=Bi(i,t+"value",e);if(!n)return null;const s=qr(i,t,e),r=qr(i,t+"background-",e),o=Jr(i,t,e),l=Jr(i,t+"background-",e),a=Bi(i,t+"font",e),h=Pt(i,t+"max-angle",e),c=Pt(i,t+"offset-x",e),u=Pt(i,t+"offset-y",e),d=Ds(i,t+"overflow",e),f=Bi(i,t+"placement",e),g=Pt(i,t+"repeat",e),m=ca(i,t+"scale",e),_=Ds(i,t+"rotate-with-view",e),p=Pt(i,t+"rotation",e),y=Bi(i,t+"align",e),v=Bi(i,t+"justify",e),C=Bi(i,t+"baseline",e),x=Ds(i,t+"keep-upright",e),T=__(i,t+"padding",e),I=ha(i,t+"declutter-mode"),L=new $r({declutterMode:I});return function(b){if(L.setText(n(b)),s&&L.setFill(s(b)),r&&L.setBackgroundFill(r(b)),o&&L.setStroke(o(b)),l&&L.setBackgroundStroke(l(b)),a&&L.setFont(a(b)),h&&L.setMaxAngle(h(b)),c&&L.setOffsetX(c(b)),u&&L.setOffsetY(u(b)),d&&L.setOverflow(d(b)),f){const G=f(b);if(G!=="point"&&G!=="line")throw new Error("Expected point or line for text-placement");L.setPlacement(G)}if(g&&L.setRepeat(g(b)),m&&L.setScale(m(b)),_&&L.setRotateWithView(_(b)),p&&L.setRotation(p(b)),y){const G=y(b);if(G!=="left"&&G!=="center"&&G!=="right"&&G!=="end"&&G!=="start")throw new Error("Expected left, right, center, start, or end for text-align");L.setTextAlign(G)}if(v){const G=v(b);if(G!=="left"&&G!=="right"&&G!=="center")throw new Error("Expected left, right, or center for text-justify");L.setJustify(G)}if(C){const G=C(b);if(G!=="bottom"&&G!=="top"&&G!=="middle"&&G!=="alphabetic"&&G!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");L.setTextBaseline(G)}return T&&L.setPadding(T(b)),x&&L.setKeepUpright(x(b)),L}}function jw(i,e){return"icon-src"in i?zw(i,e):"shape-points"in i?Bw(i,e):"circle-radius"in i?Ww(i,e):null}function zw(i,e){const t="icon-",n=t+"src",s=p_(i[n],n),r=pl(i,t+"anchor",e),o=ca(i,t+"scale",e),l=Pt(i,t+"opacity",e),a=pl(i,t+"displacement",e),h=Pt(i,t+"rotation",e),c=Ds(i,t+"rotate-with-view",e),u=df(i,t+"anchor-origin"),d=ff(i,t+"anchor-x-units"),f=ff(i,t+"anchor-y-units"),g=Yw(i,t+"color"),m=Xw(i,t+"cross-origin"),_=Hw(i,t+"offset"),p=df(i,t+"offset-origin"),y=yl(i,t+"width"),v=yl(i,t+"height"),C=Kw(i,t+"size"),x=ha(i,t+"declutter-mode"),T=new In({src:s,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:m,offset:_,offsetOrigin:p,height:v,width:y,size:C,declutterMode:x});return function(I){return l&&T.setOpacity(l(I)),a&&T.setDisplacement(a(I)),h&&T.setRotation(h(I)),c&&T.setRotateWithView(c(I)),o&&T.setScale(o(I)),r&&T.setAnchor(r(I)),T}}function Bw(i,e){const t="shape-",n=t+"points",s=t+"radius",r=Xc(i[n],n),o=Xc(i[s],s),l=qr(i,t,e),a=Jr(i,t,e),h=ca(i,t+"scale",e),c=pl(i,t+"displacement",e),u=Pt(i,t+"rotation",e),d=Ds(i,t+"rotate-with-view",e),f=yl(i,t+"radius2"),g=yl(i,t+"angle"),m=ha(i,t+"declutter-mode"),_=new la({points:r,radius:o,radius2:f,angle:g,declutterMode:m});return function(p){return l&&_.setFill(l(p)),a&&_.setStroke(a(p)),c&&_.setDisplacement(c(p)),u&&_.setRotation(u(p)),d&&_.setRotateWithView(d(p)),h&&_.setScale(h(p)),_}}function Ww(i,e){const t="circle-",n=qr(i,t,e),s=Jr(i,t,e),r=Pt(i,t+"radius",e),o=ca(i,t+"scale",e),l=pl(i,t+"displacement",e),a=Pt(i,t+"rotation",e),h=Ds(i,t+"rotate-with-view",e),c=ha(i,t+"declutter-mode"),u=new aa({radius:5,declutterMode:c});return function(d){return r&&u.setRadius(r(d)),n&&u.setFill(n(d)),s&&u.setStroke(s(d)),l&&u.setDisplacement(l(d)),a&&u.setRotation(a(d)),h&&u.setRotateWithView(h(d)),o&&u.setScale(o(d)),u}}function Pt(i,e,t){if(!(e in i))return;const n=tn(i[e],Ce,t);return function(s){return Xc(n(s),e)}}function Bi(i,e,t){if(!(e in i))return null;const n=tn(i[e],bt,t);return function(s){return p_(n(s),e)}}function Uw(i,e,t){const n=Bi(i,e+"pattern-src",t),s=uf(i,e+"pattern-offset",t),r=uf(i,e+"pattern-size",t),o=cu(i,e+"color",t);return function(l){return{src:n(l),offset:s&&s(l),size:r&&r(l),color:o&&o(l)}}}function Ds(i,e,t){if(!(e in i))return null;const n=tn(i[e],Et,t);return function(s){const r=n(s);if(typeof r!="boolean")throw new Error(`Expected a boolean for ${e}`);return r}}function cu(i,e,t){if(!(e in i))return null;const n=tn(i[e],ei,t);return function(s){return y_(n(s),e)}}function __(i,e,t){if(!(e in i))return null;const n=tn(i[e],ss,t);return function(s){return mo(n(s),e)}}function pl(i,e,t){if(!(e in i))return null;const n=tn(i[e],ss,t);return function(s){const r=mo(n(s),e);if(r.length!==2)throw new Error(`Expected two numbers for ${e}`);return r}}function uf(i,e,t){if(!(e in i))return null;const n=tn(i[e],ss,t);return function(s){return C_(n(s),e)}}function ca(i,e,t){if(!(e in i))return null;const n=tn(i[e],ss|Ce,t);return function(s){return Zw(n(s),e)}}function yl(i,e){const t=i[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function Kw(i,e){const t=i[e];if(t!==void 0){if(typeof t=="number")return gt(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function Xw(i,e){const t=i[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function df(i,e){const t=i[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function ff(i,e){const t=i[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function Hw(i,e){const t=i[e];if(t!==void 0)return mo(t,e)}function ha(i,e){const t=i[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Yw(i,e){const t=i[e];if(t!==void 0)return y_(t,e)}function mo(i,e){if(!Array.isArray(i))throw new Error(`Expected an array for ${e}`);const t=i.length;for(let n=0;n<t;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${e}`);return i}function p_(i,e){if(typeof i!="string")throw new Error(`Expected a string for ${e}`);return i}function Xc(i,e){if(typeof i!="number")throw new Error(`Expected a number for ${e}`);return i}function y_(i,e){if(typeof i=="string")return i;const t=mo(i,e),n=t.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function C_(i,e){const t=mo(i,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function Zw(i,e){return typeof i=="number"?i:C_(i,e)}const gf={RENDER_ORDER:"renderOrder"};class ua extends Js{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(gf.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const n=this.getDeclutter();n in e.declutter||(e.declutter[n]=new r_(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(gf.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?m_:e;const t=$w(e);this.styleFunction_=e===null?void 0:Fw(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function $w(i){if(i===void 0)return m_;if(!i)return null;if(typeof i=="function"||i instanceof Ri)return i;if(!Array.isArray(i))return hf([i]);if(i.length===0)return[];const e=i.length,t=i[0];if(t instanceof Ri){const s=new Array(e);for(let r=0;r<e;++r){const o=i[r];if(!(o instanceof Ri))throw new Error("Expected a list of style instances");s[r]=o}return s}if("style"in t){const s=new Array(e);for(let r=0;r<e;++r){const o=i[r];if(!("style"in o))throw new Error("Expected a list of rules with a style property");s[r]=o}return Nw(s)}return hf(i)}class v_ extends bi{constructor(e,t,n,s){super(e),this.inversePixelTransform=t,this.frameState=n,this.context=s}}class qw extends Kl{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){ge()}calculateMatrices2D(e){const t=e.viewState,n=e.coordinateToPixelTransform,s=e.pixelToCoordinateTransform;Si(n,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Vm(s,n)}forEachFeatureAtCoordinate(e,t,n,s,r,o,l,a){let h;const c=t.viewState;function u(C,x,T,I){return r.call(o,x,C?T:null,I)}const d=c.projection,f=Ph(e.slice(),d),g=[[0,0]];if(d.canWrapX()&&s){const C=d.getExtent(),x=ve(C);g.push([-x,0],[x,0])}const m=t.layerStatesArray,_=m.length,p=[],y=[];for(let C=0;C<g.length;C++)for(let x=_-1;x>=0;--x){const T=m[x],I=T.layer;if(I.hasRenderer()&&nu(T,c)&&l.call(a,I)){const L=I.getRenderer(),b=I.getSource();if(L&&b){const G=b.getWrapX()?f:e,W=u.bind(null,T.managed);y[0]=G[0]+g[C][0],y[1]=G[1]+g[C][1],h=L.forEachFeatureAtCoordinate(y,t,n,W,p)}if(h)return h}}if(p.length===0)return;const v=1/p.length;return p.forEach((C,x)=>C.distanceSq+=x*v),p.sort((C,x)=>C.distanceSq-x.distanceSq),p.some(C=>h=C.callback(C.feature,C.layer,C.geometry)),h}hasFeatureAtCoordinate(e,t,n,s,r,o){return this.forEachFeatureAtCoordinate(e,t,n,s,jr,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(e){ge()}scheduleExpireIconCache(e){Xt.canExpireCache()&&e.postRenderFunctions.push(Jw)}}function Jw(i,e){Xt.expire()}class Qw extends qw{constructor(e){super(e),this.fontChangeListenerKey_=Ee(ws,Bs.PROPERTYCHANGE,e.redrawText,e),this.element_=Ut?Jm():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=sa+" ol-layers";const n=e.getViewport();n&&n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const n=this.getMap();if(n.hasListener(e)){const s=new v_(e,void 0,t);n.dispatchEvent(s)}}disposeInternal(){Ne(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Kt.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,c)=>h.zIndex-c.zIndex);t.some(h=>h.layer instanceof ua&&h.layer.getDeclutter())&&(e.declutter={});const s=e.viewState;this.children_.length=0;const r=[];let o=null;for(let h=0,c=t.length;h<c;++h){const u=t[h];e.layerIndex=h;const d=u.layer,f=d.getSourceState();if(!nu(u,s)||f!="ready"&&f!="undefined"){d.unrender();continue}const g=d.render(e,o);g&&(g!==o&&(this.children_.push(g),o=g),r.push(u))}this.declutter(e,r),hx(this.element_,this.children_);const a=this.getMap().getTargetElement();if(Cn(a)){const h=a.getContext("2d");for(const c of this.children_){const u=c.firstElementChild||c,d=c.style.backgroundColor;if(d&&(!Cn(u)||u.width>0)&&(h.fillStyle=d,h.fillRect(0,0,a.width,a.height)),Cn(u)&&u.width>0){const f=c.style.opacity||u.style.opacity;h.globalAlpha=f===""?1:Number(f);const g=u.style.transform;if(g)h.setTransform(...Nc(g));else{const m=parseFloat(u.style.width)/u.width,_=parseFloat(u.style.height)/u.height;h.setTransform(m,0,0,_,0,0)}h.drawImage(u,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Kt.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let n=t.length-1;n>=0;--n){const s=t[n],r=s.layer;r.getDeclutter()&&r.renderDeclutter(e,s)}t.forEach(n=>n.layer.renderDeferred(e))}}}function E_(i){if(i instanceof Js){i.setMapInternal(null);return}i instanceof Ji&&i.getLayers().forEach(E_)}function x_(i,e){if(i instanceof Js){i.setMapInternal(e);return}if(i instanceof Ji){const t=i.getLayers().getArray();for(let n=0,s=t.length;n<s;++n)x_(t[n],e)}}let e1=class extends di{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=t1(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:pm,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=kt(),this.pixelToCoordinateTransform_=kt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ut||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ut||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ut?new Wt:gx()),this.interactions=t.interactions||(Ut?new Wt:kx({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new kv(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ut.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ut.VIEW,this.handleViewChanged_),this.addChangeListener(ut.SIZE,this.handleSizeChanged_),this.addChangeListener(ut.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const n=this;e.view&&!(e.view instanceof pi)&&e.view.then(function(s){n.setView(new pi(s))}),this.controls.addEventListener(It.ADD,s=>{s.element.setMap(this)}),this.controls.addEventListener(It.REMOVE,s=>{s.element.setMap(null)}),this.interactions.addEventListener(It.ADD,s=>{s.element.setMap(this)}),this.interactions.addEventListener(It.REMOVE,s=>{s.element.setMap(null)}),this.overlays_.addEventListener(It.ADD,s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener(It.REMOVE,s=>{const r=s.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){x_(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,n){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const r=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:jr,l=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,r,l,t,null,o,null)}getFeaturesAtPixel(e,t){const n=[];return this.forEachFeatureAtPixel(e,function(s){n.push(s)},t),n}getAllLayers(){const e=[];function t(n){n.forEach(function(s){s instanceof Ji?t(s.getLayers()):e.push(s)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const s=t.layerFilter!==void 0?t.layerFilter:jr,r=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,o,s,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const n=this.viewport_.getBoundingClientRect(),s=this.getSize(),r=n.width/s[0],o=n.height/s[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-n.left)/r,(l.clientY-n.top)/o]}getTarget(){return this.get(ut.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return kc(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?$e(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ut.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Wt){t.setLayers(e);return}const n=t.getLayers();n.clear(),n.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,n=e.length;t<n;++t){const s=e[t];if(!s.visible)continue;const r=s.layer.getRenderer();if(r&&!r.ready)return!0;const o=s.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ni(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?$e(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ut.SIZE)}getView(){return this.get(ut.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,n,s){return Nv(this.frameState_,e,t,n,s)}handleBrowserEvent(e,t){t=t||e.type;const n=new un(t,this,e);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,n=t.type;if(n===Ac.POINTERDOWN||n===le.WHEEL||n===le.KEYDOWN){const s=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():s,o=t.target,l=r instanceof ShadowRoot?r.host===o?r.host.ownerDocument:r:r===s?s.documentElement:r;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const s=this.getInteractions().getArray().slice();for(let r=s.length-1;r>=0;r--){const o=s[r];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let s=this.maxTilesLoading_,r=s;if(e){const o=e.viewHints;if(o[je.ANIMATING]||o[je.INTERACTING]){const l=Date.now()-e.time>8;s=l?0:8,r=l?0:2}}t.getTilesLoading()<s&&(t.reprioritize(),t.loadMoreTiles(s,r))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Kt.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Kt.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Es(Vi.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Es(Vi.LOADSTART,this,e))));const n=this.postRenderFunctions_;if(e)for(let s=0,r=n.length;s<r;++s)n[s](this,e);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,s=this.targetChangeHandlerKeys_.length;n<s;++n)Ne(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(le.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(le.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Cn(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Cn(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Qw(this)),!Cn(t)){this.mapBrowserEventHandler_=new Fv(this,this.moveTolerance_);for(const s in We)this.mapBrowserEventHandler_.addEventListener(We[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(le.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(le.WHEEL,this.boundHandleBrowserEvent_,Cm?{passive:!1}:!1);let n;if(this.keyboardEventTarget_)n=this.keyboardEventTarget_;else{const s=t.getRootNode();n=s instanceof ShadowRoot?s.host:t}if(this.targetChangeHandlerKeys_=[Ee(n,le.KEYDOWN,this.handleBrowserEvent,this),Ee(n,le.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const s=t.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ne(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ne(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Ee(e,Bs.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ee(e,le.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ne),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new _n("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Ee(e,Bs.PROPERTYCHANGE,this.render,this),Ee(e,le.CHANGE,this.render,this),Ee(e,"addlayer",this.handleLayerAdd_,this),Ee(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,n=e.length;t<n;++t){const s=e[t].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){E_(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),n=this.getView(),s=this.frameState_;let r=null;if(t!==void 0&&tf(t)&&n&&n.isDef()){const o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=n.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Br(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:de(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const a=isNaN(l.nextRotation)?l.rotation:l.nextRotation;r.nextExtent=Br(l.nextCenter,l.nextResolution,a,t)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),s&&(!this.previousExtent_||!ls(this.previousExtent_)&&!ns(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Es(Vi.MOVESTART,this,s)),this.previousExtent_=co(this.previousExtent_)),this.previousExtent_&&!r.viewHints[je.ANIMATING]&&!r.viewHints[je.INTERACTING]&&!ns(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Es(Vi.MOVEEND,this,r)),vm(r.extent,this.previousExtent_))),this.dispatchEvent(new Es(Vi.POSTRENDER,this,r)),this.renderComplete_=(this.hasListener(Vi.LOADSTART)||this.hasListener(Vi.LOADEND)||this.hasListener(Kt.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new _n("removelayer",t)),this.set(ut.LAYERGROUP,e)}setSize(e){this.set(ut.SIZE,e)}setTarget(e){this.set(ut.TARGET,e)}setView(e){if(!e||e instanceof pi){this.set(ut.VIEW,e);return}this.set(ut.VIEW,new pi);const t=this;e.then(function(n){t.setView(new pi(n))})}updateSize(){const e=this.getTargetElement();let t;if(e){let s,r;if(Cn(e))s=e.width,r=e.height;else{const o=getComputedStyle(e);s=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),r=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(s)&&!isNaN(r)&&(t=[Math.max(0,s),Math.max(0,r)],!tf(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Pm("No map visible because the map container's width or height are 0."))}const n=this.getSize();t&&(!n||!bn(t,n))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function t1(i){let e=null;i.keyboardEventTarget!==void 0&&(e=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const t={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new Ji({layers:i.layers});t[ut.LAYERGROUP]=n,t[ut.TARGET]=i.target,t[ut.VIEW]=i.view instanceof pi?i.view:new pi;let s;i.controls!==void 0&&(Array.isArray(i.controls)?s=new Wt(i.controls.slice()):(we(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=i.controls));let r;i.interactions!==void 0&&(Array.isArray(i.interactions)?r=new Wt(i.interactions.slice()):(we(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),r=i.interactions));let o;return i.overlays!==void 0?Array.isArray(i.overlays)?o=new Wt(i.overlays.slice()):(we(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=i.overlays):o=new Wt,{controls:s,interactions:r,keyboardEventTarget:e,overlays:o,values:t}}class _o extends oo{constructor(e,t,n){super(),n=n||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(le.CHANGE)}release(){this.setState($.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==$.EMPTY){if(this.state!==$.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){ge()}getAlpha(e,t){if(!this.transition_)return 1;let n=this.transitionStarts_[e];if(!n)n=t,this.transitionStarts_[e]=n;else if(n===-1)return 1;const s=t-n+1e3/60;return s>=this.transition_?1:Am(s/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Hc(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}const i1=new Error("disposed"),n1=[256,256];class mf extends _o{constructor(e){const t=$.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Hc(this.data_);return e?[e.width,e.height]:n1}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==$.IDLE&&this.state!==$.ERROR)return;this.state=$.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=$.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=$.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(i1),this.controller_=null),super.disposeInternal()}}class w_ extends _o{constructor(e,t,n,s,r,o){super(e,t,o),this.crossOrigin_=s,this.src_=n,this.key=n,this.image_,Ut?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,s!==null&&(this.image_.crossOrigin=s)),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(e){this.image_=e,this.state=$.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=$.ERROR,this.unlistenImage_(),this.image_=s1(),this.changed()}handleImageLoad_(){if(Ut)this.state=$.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=$.LOADED:this.state=$.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==$.ERROR&&(this.state=$.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==$.IDLE&&(this.state=$.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=ww(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function s1(){const i=qe(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class hu{constructor(e,t,n,s){this.minX=e,this.maxX=t,this.minY=n,this.maxY=s}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function gs(i,e,t,n,s){return s!==void 0?(s.minX=i,s.maxX=e,s.minY=t,s.maxY=n,s):new hu(i,e,t,n)}let tc;const ks=[];function _f(i,e,t,n,s){i.beginPath(),i.moveTo(0,0),i.lineTo(e,t),i.lineTo(n,s),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(e,n)+1,Math.max(t,s)),i.restore()}function ic(i,e){return Math.abs(i[e*4]-210)>2||Math.abs(i[e*4+3]-.75*255)>2}function r1(){if(tc===void 0){const i=qe(6,6,ks);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",_f(i,4,5,4,0),_f(i,4,5,0,5);const e=i.getImageData(0,0,3,3).data;tc=ic(e,0)||ic(e,4)||ic(e,8),uo(i),ks.push(i.canvas)}return tc}function Qr(i,e,t,n){const s=qs(t,e,i);let r=Vd(e,n,t);const o=e.getMetersPerUnit();o!==void 0&&(r*=o);const l=i.getMetersPerUnit();l!==void 0&&(r/=l);const a=i.getExtent();if(!a||is(a,s)){const h=Vd(i,r,s)/r;isFinite(h)&&h>0&&(r/=h)}return r}function o1(i,e,t,n){const s=$t(t);let r=Qr(i,e,s,n);return(!isFinite(r)||r<=0)&&wm(t,function(o){return r=Qr(i,e,o,n),isFinite(r)&&r>0}),r}function R_(i,e,t,n,s,r,o,l,a,h,c,u,d,f){const g=qe(Math.round(t*i),Math.round(t*e),ks);if(u||(g.imageSmoothingEnabled=!1),a.length===0)return g.canvas;g.scale(t,t);function m(x){return Math.round(x*t)/t}g.globalCompositeOperation="lighter";const _=wt();a.forEach(function(x,T,I){Em(_,x.extent)});let p;const y=t/n,v=(u?1:1+Math.pow(2,-24))/y;if(!d||a.length!==1||h!==0){if(p=qe(Math.round(ve(_)*y),Math.round(Ye(_)*y),ks),u||(p.imageSmoothingEnabled=!1),s&&f){const x=(s[0]-_[0])*y,T=-(s[3]-_[3])*y,I=ve(s)*y,L=Ye(s)*y;p.rect(x,T,I,L),p.clip()}a.forEach(function(x,T,I){if(x.image.width>0&&x.image.height>0){if(x.clipExtent){p.save();const A=(x.clipExtent[0]-_[0])*y,S=-(x.clipExtent[3]-_[3])*y,O=ve(x.clipExtent)*y,U=Ye(x.clipExtent)*y;p.rect(u?A:Math.round(A),u?S:Math.round(S),u?O:Math.round(A+O)-Math.round(A),u?U:Math.round(S+U)-Math.round(S)),p.clip()}const L=(x.extent[0]-_[0])*y,b=-(x.extent[3]-_[3])*y,G=ve(x.extent)*y,W=Ye(x.extent)*y;p.drawImage(x.image,h,h,x.image.width-2*h,x.image.height-2*h,u?L:Math.round(L),u?b:Math.round(b),u?G:Math.round(L+G)-Math.round(L),u?W:Math.round(b+W)-Math.round(b)),x.clipExtent&&p.restore()}})}const C=An(o);return l.getTriangles().forEach(function(x,T,I){const L=x.source,b=x.target;let G=L[0][0],W=L[0][1],A=L[1][0],S=L[1][1],O=L[2][0],U=L[2][1];const N=m((b[0][0]-C[0])/r),z=m(-(b[0][1]-C[1])/r),V=m((b[1][0]-C[0])/r),J=m(-(b[1][1]-C[1])/r),se=m((b[2][0]-C[0])/r),ae=m(-(b[2][1]-C[1])/r),j=G,xe=W;G=0,W=0,A-=j,S-=xe,O-=j,U-=xe;const ye=[[A,S,0,0,V-N],[O,U,0,0,se-N],[0,0,A,S,J-z],[0,0,O,U,ae-z]],Le=Vv(ye);if(!Le)return;if(g.save(),g.beginPath(),r1()||!u){g.moveTo(V,J);const P=4,q=N-V,Y=z-J;for(let Q=0;Q<P;Q++)g.lineTo(V+m((Q+1)*q/P),J+m(Q*Y/(P-1))),Q!=P-1&&g.lineTo(V+m((Q+1)*q/P),J+m((Q+1)*Y/(P-1)));g.lineTo(se,ae)}else g.moveTo(V,J),g.lineTo(N,z),g.lineTo(se,ae);g.clip(),g.transform(Le[0],Le[2],Le[1],Le[3],N,z),g.translate(_[0]-j,_[3]-xe);let De;if(p)De=p.canvas,g.scale(v,-v);else{const P=a[0],q=P.extent;De=P.image,g.scale(ve(q)/De.width,-Ye(q)/De.height)}g.drawImage(De,0,0),g.restore()}),p&&(uo(p),ks.push(p.canvas)),c&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,l.getTriangles().forEach(function(x,T,I){const L=x.target,b=(L[0][0]-C[0])/r,G=-(L[0][1]-C[1])/r,W=(L[1][0]-C[0])/r,A=-(L[1][1]-C[1])/r,S=(L[2][0]-C[0])/r,O=-(L[2][1]-C[1])/r;g.beginPath(),g.moveTo(W,A),g.lineTo(b,G),g.lineTo(S,O),g.closePath(),g.stroke()}),g.restore()),g.canvas}const l1=10,pf=.25;class T_{constructor(e,t,n,s,r,o,l){this.sourceProj_=e,this.targetProj_=t;let a={};const h=l?wE(v=>$e(l,qs(v,this.targetProj_,this.sourceProj_))):Ti(this.targetProj_,this.sourceProj_);this.transformInv_=function(v){const C=v[0]+"/"+v[1];return a[C]||(a[C]=h(v)),a[C]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&ve(s)>=ve(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ve(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ve(this.targetProj_.getExtent()):null;const c=An(n),u=$l(n),d=Zl(n),f=Yl(n),g=this.transformInv_(c),m=this.transformInv_(u),_=this.transformInv_(d),p=this.transformInv_(f),y=l1+(o?Math.max(0,Math.ceil(Math.log2(Mc(n)/(o*o*256*256)))):0);if(this.addQuad_(c,u,d,f,g,m,_,p,y),this.wrapsXInSource_){let v=1/0;this.triangles_.forEach(function(C,x,T){v=Math.min(v,C.source[0][0],C.source[1][0],C.source[2][0])}),this.triangles_.forEach(C=>{if(Math.max(C.source[0][0],C.source[1][0],C.source[2][0])-v>this.sourceWorldWidth_/2){const x=[[C.source[0][0],C.source[0][1]],[C.source[1][0],C.source[1][1]],[C.source[2][0],C.source[2][1]]];x[0][0]-v>this.sourceWorldWidth_/2&&(x[0][0]-=this.sourceWorldWidth_),x[1][0]-v>this.sourceWorldWidth_/2&&(x[1][0]-=this.sourceWorldWidth_),x[2][0]-v>this.sourceWorldWidth_/2&&(x[2][0]-=this.sourceWorldWidth_);const T=Math.min(x[0][0],x[1][0],x[2][0]);Math.max(x[0][0],x[1][0],x[2][0])-T<this.sourceWorldWidth_/2&&(C.source=x)}})}a={}}addTriangle_(e,t,n,s,r,o){this.triangles_.push({source:[s,r,o],target:[e,t,n]})}addQuad_(e,t,n,s,r,o,l,a,h){const c=hl([r,o,l,a]),u=this.sourceWorldWidth_?ve(c)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const _=hl([e,t,n,s]);g=ve(_)/this.targetWorldWidth_>pf||g}!f&&this.sourceProj_.isGlobal()&&u&&(g=u>pf||g)}if(!g&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!Ke(c,this.maxSourceExtent_))return;let m=0;if(!g&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(a[0])||!isFinite(a[1]))){if(h>0)g=!0;else if(m=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(a[0])||!isFinite(a[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(h>0){if(!g){const _=[(e[0]+n[0])/2,(e[1]+n[1])/2],p=this.transformInv_(_);let y;f?y=(Jn(r[0],d)+Jn(l[0],d))/2-Jn(p[0],d):y=(r[0]+l[0])/2-p[0];const v=(r[1]+l[1])/2-p[1];g=y*y+v*v>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){const _=[(t[0]+n[0])/2,(t[1]+n[1])/2],p=this.transformInv_(_),y=[(s[0]+e[0])/2,(s[1]+e[1])/2],v=this.transformInv_(y);this.addQuad_(e,t,_,y,r,o,p,v,h-1),this.addQuad_(y,_,n,s,v,p,l,a,h-1)}else{const _=[(e[0]+t[0])/2,(e[1]+t[1])/2],p=this.transformInv_(_),y=[(n[0]+s[0])/2,(n[1]+s[1])/2],v=this.transformInv_(y);this.addQuad_(e,_,y,s,r,p,v,a,h-1),this.addQuad_(_,t,n,y,p,o,l,v,h-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(m&11)==0&&this.addTriangle_(e,n,s,r,l,a),(m&14)==0&&this.addTriangle_(e,n,t,r,l,o),m&&((m&13)==0&&this.addTriangle_(t,s,e,o,a,r),(m&7)==0&&this.addTriangle_(t,s,n,o,a,l))}calculateSourceExtent(){const e=wt();return this.triangles_.forEach(function(t,n,s){const r=t.source;Ar(e,r[0]),Ar(e,r[1]),Ar(e,r[2])}),e}getTriangles(){return this.triangles_}}const S_=.5;class I_ extends _o{constructor(e,t,n,s,r,o,l,a,h,c,u,d){super(r,$.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=l,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=s,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const f=s.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let m=this.sourceTileGrid_.getExtent();const _=g?li(f,g):f;if(Mc(_)===0){this.state=$.EMPTY;return}const p=e.getExtent();p&&(m?m=li(m,p):m=p);const y=s.getResolution(this.wrappedTileCoord_[0]),v=o1(e,n,_,y);if(!isFinite(v)||v<=0){this.state=$.EMPTY;return}const C=c!==void 0?c:S_;if(this.triangulation_=new T_(e,n,_,m,v*C,y),this.triangulation_.getTriangles().length===0){this.state=$.EMPTY;return}this.sourceZ_=t.getZForResolution(v);let x=this.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(x[1]=ze(x[1],m[1],m[3]),x[3]=ze(x[3],m[1],m[3])):x=li(x,m)),!Mc(x))this.state=$.EMPTY;else{let T=0,I=0;e.canWrapX()&&(T=ve(p),I=Math.floor((x[0]-p[0])/T)),Sm(x.slice(),e,!0).forEach(b=>{const G=t.getTileRangeForExtentAndZ(b,this.sourceZ_);for(let W=G.minX;W<=G.maxX;W++)for(let A=G.minY;A<=G.maxY;A++){const S=h(this.sourceZ_,W,A,l);if(S){const O=I*T;this.sourceTiles_.push({tile:S,offset:O})}}++I}),this.sourceTiles_.length===0&&(this.state=$.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const n=t.tile;if(n&&n.getState()==$.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);s[0]+=t.offset,s[2]+=t.offset;const r=this.clipExtent_?.slice();r&&(r[0]+=t.offset,r[2]+=t.offset),e.push({extent:s,clipExtent:r,image:n.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=$.ERROR;else{const t=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(t),s=typeof n=="number"?n:n[0],r=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=R_(s,r,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=$.LOADED}this.changed()}load(){if(this.state==$.IDLE){this.state=$.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const n=t.getState();if(n==$.IDLE||n==$.LOADING){e++;const s=Ee(t,le.CHANGE,r=>{const o=t.getState();(o==$.LOADED||o==$.ERROR||o==$.EMPTY)&&(Ne(s),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},n,s){t.getState()==$.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ne),this.sourcesListenerKeys_=null}release(){this.canvas_&&(uo(this.canvas_.getContext("2d")),ks.push(this.canvas_),this.canvas_=null),super.release()}}class Cl{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Kl&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const n=this.entries_[e];return we(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(e){const t=this.entries_[e];return we(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e}getValues(){const e=new Array(this.count_);let t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){we(!(e in this.entries_),"Tried to set a value for a key that is used already");const n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_}setSize(e){this.highWaterMark=e}}function vl(i,e,t,n){return n!==void 0?(n[0]=i,n[1]=e,n[2]=t,n):[i,e,t]}function a1(i,e,t){return i+"/"+e+"/"+t}function $o(i,e,t,n,s){return`${de(i)},${e},${a1(t,n,s)}`}function b_(i){return c1(i[0],i[1],i[2])}function c1(i,e,t){return(e<<i)+t}function h1(i,e){const t=i[0],n=i[1],s=i[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const r=e.getFullTileRange(t);return r?r.containsXY(n,s):!0}class uu{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(gl(),{get:(e,t)=>{if(typeof gl()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,n)=>(this.push_(t,n),!0)})}push_(...e){const t=this.instructions_,n=this.zIndex+this.offset_;t[n]||(t[n]=[]),t[n].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let n=0,s=t.length;n<s;++n){const r=t[n];if(typeof r=="function"){r(e);continue}const o=t[++n];if(typeof e[r]=="function")e[r](...o);else{if(typeof o=="function"){e[r]=o(e);continue}e[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const u1=5;class d1 extends lo{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=u1}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return ge()}getData(e){return null}prepareFrame(e){return ge()}renderFrame(e,t){return ge()}forEachFeatureAtCoordinate(e,t,n,s,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===te.LOADED||t.getState()===te.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=te.LOADED&&t!=te.ERROR&&e.addEventListener(le.CHANGE,this.boundHandleImageChange_),t==te.IDLE&&(e.load(),t=e.getState()),t==te.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const yf=[];let Rs=null;function f1(){Rs=qe(1,1,void 0,{willReadFrequently:!0})}class du extends d1{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=kt(),this.pixelTransform=kt(),this.inversePixelTransform=kt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,n){Rs||f1(),Rs.clearRect(0,0,1,1);let s;try{Rs.drawImage(e,t,n,1,1,0,0,1,1),s=Rs.getImageData(0,0,1,1).data}catch{return Rs=null,null}return s}getBackground(e){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(e.viewState.resolution)),n||void 0}useContainer(e,t,n){const s=this.getLayer().getClassName();let r,o;if(e&&e.className===s&&(!n||e&&e.style.backgroundColor&&bn(Us(e.style.backgroundColor),Us(n)))){const l=e.firstElementChild;Cn(l)&&(o=l.getContext("2d"))}if(o&&ME(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=Ut?Jm():document.createElement("div"),r.className=s;let l=r.style;l.position="absolute",l.width="100%",l.height="100%",o=qe();const a=o.canvas;r.appendChild(a),l=a.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(e,t,n){const s=An(n),r=$l(n),o=Zl(n),l=Yl(n);$e(t.coordinateToPixelTransform,s),$e(t.coordinateToPixelTransform,r),$e(t.coordinateToPixelTransform,o),$e(t.coordinateToPixelTransform,l);const a=this.inversePixelTransform;$e(a,s),$e(a,r),$e(a,o),$e(a,l),e.save(),e.beginPath(),e.moveTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const n=e.extent,s=e.viewState.resolution,r=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ve(n)/s*o),a=Math.round(Ye(n)/s*o);Si(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,r,-l/2,-a/2),Vm(this.inversePixelTransform,this.pixelTransform);const h=PE(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const c=this.context.canvas;c.width!=l||c.height!=a?(c.width=l,c.height=a):this.context.clearRect(0,0,l,a),h!==c.style.transform&&(c.style.transform=h)}}dispatchRenderEvent_(e,t,n){const s=this.getLayer();if(s.hasListener(e)){const r=new v_(e,this.inversePixelTransform,n,t);s.dispatchEvent(r)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Kt.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Kt.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new uu),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Kt.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Kt.POSTRENDER,this.context,e))}getRenderTransform(e,t,n,s,r,o,l){const a=r/2,h=o/2,c=s/t,u=-c,d=-e[0]+l,f=-e[1];return Si(this.tempTransform,a,h,c,u,-n,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function nc(i,e,t){if(!(t in i))return i[t]=new Set([e]),!0;const n=i[t],s=n.has(e);return s||n.add(e),!s}function g1(i,e,t){const n=i[t];return n?n.delete(e):!1}function Cf(i,e){const t=i.layerStatesArray[i.layerIndex];t.extent&&(e=li(e,Ci(t.extent,i.viewState.projection)));const n=t.layer.getRenderSource();if(!n.getWrapX()){const s=n.getTileGridForProjection(i.viewState.projection).getExtent();s&&(e=li(e,s))}return e}class A_ extends du{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=wt(),this.tempTileRange_=new hu(0,0,0,0),this.tempTileCoord_=vl(0,0,0);const n=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new Cl(n),this.sourceTileCache_=null,this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Cl(512)),this.sourceTileCache_}getOrCreateTile(e,t,n,s){const r=this.tileCache_,l=this.getLayer().getSource(),a=$o(l,l.getKey(),e,t,n);let h;if(r.containsKey(a))h=r.get(a);else{const c=s.viewState.projection,u=l.getProjection();if(h=l.getTile(e,t,n,s.pixelRatio,c,!u||vt(u,c)?void 0:this.getSourceTileCache()),!h)return null;r.set(a,h)}return h}getTile(e,t,n,s){const r=this.getOrCreateTile(e,t,n,s);return r||null}getData(e){const t=this.frameState;if(!t)return null;const n=this.getLayer(),s=$e(t.pixelToCoordinateTransform,e.slice()),r=n.getExtent();if(r&&!is(r,s))return null;const o=t.viewState,l=n.getRenderSource(),a=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let c=a.getZForResolution(o.resolution);c>=a.getMinZoom();--c){const u=a.getTileCoordForCoordAndZ(s,c),d=this.getTile(c,u[1],u[2],t);if(!d||d.getState()!==$.LOADED)continue;const f=a.getOrigin(c),g=gt(a.getTileSize(c)),m=a.getResolution(c);let _;if(d instanceof w_||d instanceof I_)_=d.getImage();else if(d instanceof mf){if(_=Hc(d.getData()),!_)continue}else continue;const p=Math.floor(h*((s[0]-f[0])/m-u[1]*g[0])),y=Math.floor(h*((f[1]-s[1])/m-u[2]*g[1])),v=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(_,p+v,y+v)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const n=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==n&&(this.renderedSourceRevision_=n,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=n,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,n,s,r){const o=e.viewState,l=this.getLayer(),a=l.getRenderSource(),h=a.getTileGridForProjection(o.projection),c=de(a);c in e.wantedTiles||(e.wantedTiles[c]={});const u=e.wantedTiles[c],d=l.getMapInternal(),f=Math.max(n-r,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),a.zDirection)),g=o.rotation,m=g?Rm(o.center,o.resolution,g,e.size):void 0;for(let _=n;_>=f;--_){const p=h.getTileRangeForExtentAndZ(t,_,this.tempTileRange_),y=h.getResolution(_);for(let v=p.minX;v<=p.maxX;++v)for(let C=p.minY;C<=p.maxY;++C){if(g&&!h.tileCoordIntersectsViewport([_,v,C],m))continue;const x=this.getTile(_,v,C,e);if(!x||!nc(s,x,_))continue;const I=x.getKey();if(u[I]=!0,x.getState()===$.IDLE&&!e.tileQueue.isKeyQueued(I)){const L=vl(_,v,C,this.tempTileCoord_);e.tileQueue.enqueue([x,c,h.getTileCoordCenter(L),y])}}}}findStaleTile_(e,t){const n=this.tileCache_,s=e[0],r=e[1],o=e[2],l=this.getStaleKeys();for(let a=0;a<l.length;++a){const h=$o(this.getLayer().getSource(),l[a],s,r,o);if(n.containsKey(h)){const c=n.peek(h);if(c.getState()===$.LOADED)return c.endTransition(de(this)),nc(t,c,s),!0}}return!1}findAltTiles_(e,t,n,s){const r=e.getTileRangeForTileCoordAndZ(t,n,this.tempTileRange_);if(!r)return!1;let o=!0;const l=this.tileCache_,a=this.getLayer().getRenderSource(),h=a.getKey();for(let c=r.minX;c<=r.maxX;++c)for(let u=r.minY;u<=r.maxY;++u){const d=$o(a,h,n,c,u);let f=!1;if(l.containsKey(d)){const g=l.peek(d);g.getState()===$.LOADED&&(nc(s,g,n),f=!0)}f||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const n=e.layerStatesArray[e.layerIndex],s=e.viewState,r=s.projection,o=s.resolution,l=s.center,a=e.pixelRatio,h=this.getLayer(),c=h.getSource(),u=c.getTileGridForProjection(r),d=u.getZForResolution(o,c.zDirection),f=u.getResolution(d),g=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==g&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=g):this.renderedSourceKey_=g;let m=e.extent;const _=c.getTilePixelRatio(a);this.prepareContainer(e,t);const p=this.context.canvas.width,y=this.context.canvas.height,v=n.extent&&Ci(n.extent);v&&(m=li(m,Ci(n.extent)));const C=f*p/2/_,x=f*y/2/_,T=[l[0]-C,l[1]-x,l[0]+C,l[1]+x],I={};this.renderedTiles.length=0;const L=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const V=u.getZForResolution(s.nextResolution,c.zDirection),J=Cf(e,e.nextExtent);this.enqueueTiles(e,J,V,I,L)}const b=Cf(e,m);if(this.enqueueTiles(e,b,d,I,0),L>0&&setTimeout(()=>{this.enqueueTiles(e,b,d-1,I,L-1)},0),!(d in I))return this.container;const G=de(this),W=e.time;for(const V of I[d]){const J=V.getState();if(J===$.EMPTY)continue;const se=V.tileCoord;if(J===$.LOADED&&V.getAlpha(G,W)===1){V.endTransition(G);continue}if(J!==$.ERROR&&(this.renderComplete=!1),this.findStaleTile_(se,I)){g1(I,V,d),e.animate=!0;continue}if(this.findAltTiles_(u,se,d+1,I))continue;const xe=u.getMinZoom();for(let ye=d-1;ye>=xe&&!this.findAltTiles_(u,se,ye,I);--ye);}const A=f/o*a/_,S=this.getRenderContext(e);Si(this.tempTransform,p/2,y/2,A,A,0,-p/2,-y/2),n.extent&&this.clipUnrotated(S,e,v),c.getInterpolate()||(S.imageSmoothingEnabled=!1),this.preRender(S,e);const O=Object.keys(I).map(Number);O.sort(xi);let U;const N=[],z=[];for(let V=O.length-1;V>=0;--V){const J=O[V],se=c.getTilePixelSize(J,a,r),j=u.getResolution(J)/f,xe=se[0]*j*A,ye=se[1]*j*A,Le=u.getTileCoordForCoordAndZ(An(T),J),De=u.getTileCoordExtent(Le),P=$e(this.tempTransform,[_*(De[0]-T[0])/f,_*(T[3]-De[3])/f]),q=_*c.getGutterForProjection(r);for(const Y of I[J]){if(Y.getState()!==$.LOADED)continue;const Q=Y.tileCoord,me=Le[1]-Q[1],E=Math.round(P[0]-(me-1)*xe),w=Le[2]-Q[2],R=Math.round(P[1]-(w-1)*ye),M=Math.round(P[0]-me*xe),k=Math.round(P[1]-w*ye),F=E-M,Z=R-k,H=O.length===1;let K=!1;U=[M,k,M+F,k,M+F,k+Z,M,k+Z];for(let B=0,ie=N.length;B<ie;++B)if(!H&&J<z[B]){const X=N[B];Ke([M,k,M+F,k+Z],[X[0],X[3],X[4],X[7]])&&(K||(S.save(),K=!0),S.beginPath(),S.moveTo(U[0],U[1]),S.lineTo(U[2],U[3]),S.lineTo(U[4],U[5]),S.lineTo(U[6],U[7]),S.moveTo(X[6],X[7]),S.lineTo(X[4],X[5]),S.lineTo(X[2],X[3]),S.lineTo(X[0],X[1]),S.clip())}N.push(U),z.push(J),this.drawTile(Y,e,M,k,F,Z,q,H),K&&S.restore(),this.renderedTiles.unshift(Y),this.updateUsedTiles(e.usedTiles,c,Y)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!ns(this.renderedExtent_,T),this.renderedExtent_=T,this.renderedPixelRatio=a,this.postRender(this.context,e),n.extent&&S.restore(),S.imageSmoothingEnabled=!0,this.renderComplete){const V=(J,se)=>{const ae=de(c),j=se.wantedTiles[ae],xe=j?Object.keys(j).length:0;this.updateCacheSize(xe),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(V)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,n,s,r,o,l,a){let h;if(e instanceof mf){if(h=Hc(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const c=this.getRenderContext(t),u=de(this),d=t.layerStatesArray[t.layerIndex],f=d.opacity*(a?e.getAlpha(u,t.time):1),g=f!==c.globalAlpha;g&&(c.save(),c.globalAlpha=f),c.drawImage(h,l,l,h.width-2*l,h.height-2*l,n,s,r,o),g&&c.restore(),f!==d.opacity?t.animate=!0:a&&e.endTransition(u)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,n){const s=de(t);s in e||(e[s]={}),e[s][n.getKey()]=!0}}const vn={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class m1 extends Js{constructor(e){e=e||{};const t=Object.assign({},e),n=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(vn.PRELOAD)}setPreload(e){this.set(vn.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(vn.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(vn.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Yc extends m1{constructor(e){super(e)}createRenderer(){return new A_(this,{cacheSize:this.getCacheSize()})}}const ms=[0,0,0],ln=5;class fu{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,we(Lv(this.resolutions_,(s,r)=>r-s),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let s=0,r=this.resolutions_.length-1;s<r;++s)if(!t)t=this.resolutions_[s]/this.resolutions_[s+1];else if(this.resolutions_[s]/this.resolutions_[s+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,we(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=e.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=An(n)),we(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,we(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Jh,we(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((s,r)=>{const o=new hu(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(n){const l=this.getTileRangeForExtentAndZ(n,r);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):n&&this.calculateTileRanges_(n)}forEachTileCoord(e,t,n){const s=this.getTileRangeForExtentAndZ(e,t);for(let r=s.minX,o=s.maxX;r<=o;++r)for(let l=s.minY,a=s.maxY;l<=a;++l)n([t,r,l])}forEachTileCoordParentTileRange(e,t,n,s){let r,o,l,a=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):a=this.getTileCoordExtent(e,s);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),r=gs(o,o,l,l,n)):r=this.getTileRangeForExtentAndZ(a,h,n),t(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const r=e[1]*2,o=e[2]*2;return gs(r,r+1,o,o+1,t)}const s=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;const s=e[0],r=e[1],o=e[2];if(t===s)return gs(r,o,r,o,n);if(this.zoomFactor_){const a=Math.pow(this.zoomFactor_,t-s),h=Math.floor(r*a),c=Math.floor(o*a);if(t<s)return gs(h,h,c,c,n);const u=Math.floor(a*(r+1))-1,d=Math.floor(a*(o+1))-1;return gs(h,u,c,d,n)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,n)}getTileRangeForExtentAndZ(e,t,n){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,ms);const s=ms[1],r=ms[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,ms);const o=ms[1],l=ms[2];return gs(s,o,r,l,n)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),n=this.getResolution(e[0]),s=gt(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*s[0]*n,t[1]-(e[2]+.5)*s[1]*n]}getTileCoordExtent(e,t){const n=this.getOrigin(e[0]),s=this.getResolution(e[0]),r=gt(this.getTileSize(e[0]),this.tmpSize_),o=n[0]+e[1]*r[0]*s,l=n[1]-(e[2]+1)*r[1]*s,a=o+r[0]*s,h=l+r[1]*s;return $i(o,l,a,h,t)}getTileCoordForCoordAndResolution(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)}getTileCoordForXYAndResolution_(e,t,n,s,r){const o=this.getZForResolution(n),l=n/this.getResolution(o),a=this.getOrigin(o),h=gt(this.getTileSize(o),this.tmpSize_);let c=l*(e-a[0])/n/h[0],u=l*(a[1]-t)/n/h[1];return s?(c=pn(c,ln)-1,u=pn(u,ln)-1):(c=Ts(c,ln),u=Ts(u,ln)),vl(o,c,u,r)}getTileCoordForXYAndZ_(e,t,n,s,r){const o=this.getOrigin(n),l=this.getResolution(n),a=gt(this.getTileSize(n),this.tmpSize_);let h=(e-o[0])/l/a[0],c=(o[1]-t)/l/a[1];return s?(h=pn(h,ln)-1,c=pn(c,ln)-1):(h=Ts(h,ln),c=Ts(c,ln)),vl(n,h,c,r)}getTileCoordForCoordAndZ(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const n=Xl(this.resolutions_,e,t||0);return ze(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Xm(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,n=new Array(t);for(let s=this.minZoom;s<t;++s)n[s]=this.getTileRangeForExtentAndZ(e,s);this.fullTileRanges_=n}}function da(i){let e=i.getDefaultTileGrid();return e||(e=y1(i),i.setDefaultTileGrid(e)),e}function _1(i,e,t){const n=e[0],s=i.getTileCoordCenter(e),r=fa(t);if(!is(r,s)){const o=ve(r),l=Math.ceil((r[0]-s[0])/o);return s[0]+=o*l,i.getTileCoordForCoordAndZ(s,n)}return e}function p1(i,e,t,n){n=n!==void 0?n:"top-left";const s=P_(i,e,t);return new fu({extent:i,origin:Wv(i,n),resolutions:s,tileSize:t})}function L_(i){const e=i||{},t=e.extent||Oe("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:P_(t,e.maxZoom,e.tileSize,e.maxResolution)};return new fu(n)}function P_(i,e,t,n){e=e!==void 0?e:$m,t=gt(t!==void 0?t:Jh);const s=Ye(i),r=ve(i);n=n>0?n:Math.max(r/t[0],s/t[1]);const o=e+1,l=new Array(o);for(let a=0;a<o;++a)l[a]=n/Math.pow(2,a);return l}function y1(i,e,t,n){const s=fa(i);return p1(s,e,t,n)}function fa(i){i=Oe(i);let e=i.getExtent();if(!e){const t=180*Mh.degrees/i.getMetersPerUnit();e=$i(-t,-t,t,t)}return e}function gu(i,e){const t=[];Object.keys(e).forEach(function(s){e[s]!==null&&e[s]!==void 0&&t.push(s+"="+encodeURIComponent(e[s]))});const n=t.join("&");return i=i.replace(/[?&]$/,""),i+=i.includes("?")?"&":"?",i+n}const C1=/\{z\}/g,v1=/\{x\}/g,E1=/\{y\}/g,x1=/\{-y\}/g;function w1(i,e,t,n,s){return i.replace(C1,e.toString()).replace(v1,t.toString()).replace(E1,n.toString()).replace(x1,function(){if(s===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(s-n).toString()})}function R1(i){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(i);if(t){const n=t[1].charCodeAt(0),s=t[2].charCodeAt(0);let r;for(r=n;r<=s;++r)e.push(i.replace(t[0],String.fromCharCode(r)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(i),t){const n=parseInt(t[2],10);for(let s=parseInt(t[1],10);s<=n;s++)e.push(i.replace(t[0],s.toString()));return e}return e.push(i),e}function T1(i,e){return(function(t,n,s){if(!t)return;let r;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(r=l.getHeight()-1)}return w1(i,o,t[1],t[2],r)})}function M_(i,e){const t=i.length,n=new Array(t);for(let s=0;s<t;++s)n[s]=T1(i[s],e);return S1(n)}function S1(i){return i.length===1?i[0]:(function(e,t,n){if(!e)return;const s=b_(e),r=Jn(s,i.length);return i[r](e,t,n)})}class mu extends di{constructor(e){super(),this.projection=Oe(e.projection),this.attributions_=vf(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(n,s){t.viewResolver=n,t.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=vf(e),this.changed()}setState(e){this.state_=e,this.changed()}}function vf(i){return i?typeof i=="function"?i:(Array.isArray(i)||(i=[i]),e=>i):null}class I1 extends mu{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&gt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||de(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,n,s,r,o){return ge()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:da(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,n){const s=this.getTileGridForProjection(n),r=this.getTilePixelRatio(t),o=gt(s.getTileSize(e),this.tmpSize);return r==1?o:Jx(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const n=t!==void 0?t:this.getProjection(),s=t!==void 0?this.getTileGridForProjection(n):this.tileGrid||this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(e=_1(s,e,n)),h1(e,s)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class b1 extends bi{constructor(e,t){super(e),this.tile=t}}const sc={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class ga extends I1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===ga.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,n=de(t),s=t.getState();let r;s==$.LOADING?(this.tileLoadingKeys_[n]=!0,r=sc.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],r=s==$.ERROR?sc.TILELOADERROR:s==$.LOADED?sc.TILELOADEND:void 0),r!=null&&this.dispatchEvent(new b1(r,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=R1(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(M_(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,n){}}class _u extends ga{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:A1,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:w_,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!vt(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||vt(t,e)))return this.tileGrid;const n=de(e);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=da(e)),this.tileGridForProjection[n]}createTile_(e,t,n,s,r,o){const l=[e,t,n],a=this.getTileCoordForTileUrlFunction(l,r),h=a?this.tileUrlFunction(a,s,r):void 0,c=new this.tileClass(l,h!==void 0?$.IDLE:$.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(le.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,t,n,s,r,o){const l=this.getProjection();if(!l||!r||vt(l,r))return this.getTileInternal(e,t,n,s,l||r);const a=[e,t,n],h=this.getKey(),c=this.getTileGridForProjection(l),u=this.getTileGridForProjection(r),d=this.getTileCoordForTileUrlFunction(a,r),f=new I_(l,c,r,u,a,d,this.getTilePixelRatio(s),this.getGutter(),(g,m,_,p)=>this.getTileInternal(g,m,_,p,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=h,f}getTileInternal(e,t,n,s,r,o){const l=this.getKey(),a=$o(this,l,e,t,n);if(o&&o.containsKey(a))return o.get(a);const h=this.createTile_(e,t,n,s,r,l);return o?.set(a,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const n=Oe(e);if(n){const s=de(n);s in this.tileGridForProjection||(this.tileGridForProjection[s]=t)}}}function A1(i,e){if(Ut){const t=i.getCrossOrigin();let n="same-origin",s="same-origin";t==="anonymous"||t===""?(n="cors",s="omit"):t==="use-credentials"&&(n="cors",s="include"),fetch(e,{mode:n,credentials:s}).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}`);return r.blob()}).then(r=>createImageBitmap(r)).then(r=>{const o=i.getImage();o.width=r.width,o.height=r.height,o.getContext("2d").drawImage(r,0,0),r.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{i.getImage().dispatchEvent(new Event("error"))});return}i.getImage().src=e}class Ef extends _u{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",n=e.tileGrid!==void 0?e.tileGrid:L_({extent:fa(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}class O_{drawCustom(e,t,n,s,r){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,n){}drawFeature(e,t,n){}drawGeometryCollection(e,t,n){}drawLineString(e,t,n){}drawMultiLineString(e,t,n){}drawMultiPoint(e,t,n){}drawMultiPolygon(e,t,n){}drawPoint(e,t,n){}drawPolygon(e,t,n){}drawText(e,t,n){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const re={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},ko=[re.FILL],En=[re.STROKE],Yn=[re.BEGIN_PATH],xf=[re.CLOSE_PATH];class po extends O_{constructor(e,t,n,s){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(n){return n*t})}appendFlatPointCoordinates(e,t){const n=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let l=0,a=e.length;l<a;l+=t)s[0]=e[l],s[1]=e[l+1],is(n,s)&&(r[o++]=s[0],r[o++]=s[1]);return o}appendFlatLineCoordinates(e,t,n,s,r,o){const l=this.coordinates;let a=l.length;const h=this.getBufferedMaxExtent();o&&(t+=s);let c=e[t],u=e[t+1];const d=this.tmpCoordinate_;let f=!0,g,m,_;for(g=t+s;g<n;g+=s)d[0]=e[g],d[1]=e[g+1],_=Pc(h,d),_!==m?(f&&(l[a++]=c,l[a++]=u,f=!1),l[a++]=d[0],l[a++]=d[1]):_===tt.INTERSECTING?(l[a++]=d[0],l[a++]=d[1],f=!1):f=!0,c=d[0],u=d[1],m=_;return(r&&f||g===t+s)&&(l[a++]=c,l[a++]=u),a}drawCustomCoordinates_(e,t,n,s,r){for(let o=0,l=n.length;o<l;++o){const a=n[o],h=this.appendFlatLineCoordinates(e,t,a,s,!1,!1);r.push(h),t=a}return t}drawCustom(e,t,n,s,r){this.beginGeometry(e,t,r);const o=e.getType(),l=e.getStride(),a=this.coordinates.length;let h,c,u,d,f;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),d=[];const g=e.getEndss();f=0;for(let m=0,_=g.length;m<_;++m){const p=[];f=this.drawCustomCoordinates_(h,f,g[m],l,p),d.push(p)}this.instructions.push([re.CUSTOM,a,d,e,n,Vc,r]),this.hitDetectionInstructions.push([re.CUSTOM,a,d,e,s||n,Vc,r]);break;case"Polygon":case"MultiLineString":u=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),f=this.drawCustomCoordinates_(h,0,e.getEnds(),l,u),this.instructions.push([re.CUSTOM,a,u,e,n,Ur,r]),this.hitDetectionInstructions.push([re.CUSTOM,a,u,e,s||n,Ur,r]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([re.CUSTOM,a,c,e,n,yn,r]),this.hitDetectionInstructions.push([re.CUSTOM,a,c,e,s||n,yn,r]);break;case"MultiPoint":h=e.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,l),c>a&&(this.instructions.push([re.CUSTOM,a,c,e,n,yn,r]),this.hitDetectionInstructions.push([re.CUSTOM,a,c,e,s||n,yn,r]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([re.CUSTOM,a,c,e,n,void 0,r]),this.hitDetectionInstructions.push([re.CUSTOM,a,c,e,s||n,void 0,r]);break}this.endGeometry(t)}beginGeometry(e,t,n){this.beginGeometryInstruction1_=[re.BEGIN_GEOMETRY,t,0,e,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[re.BEGIN_GEOMETRY,t,0,e,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const n=e.length;let s,r,o=-1;for(t=0;t<n;++t)s=e[t],r=s[0],r==re.END_GEOMETRY?o=t:r==re.BEGIN_GEOMETRY&&(s[2]=t,Av(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const n=e.getColor();t.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,t.fillStyle=vi(n||At)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const n=e.getColor();t.strokeStyle=vi(n||Hr);const s=e.getLineCap();t.lineCap=s!==void 0?s:Ks;const r=e.getLineDash();t.lineDash=r?r.slice():Ki;const o=e.getLineDashOffset();t.lineDashOffset=o||Xi;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:Xs;const a=e.getWidth();t.lineWidth=a!==void 0?a:Zr;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Xr,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const n=this.state;this.fillStyleToState(e,n),this.strokeStyleToState(t,n)}createFill(e){const t=e.fillStyle,n=[re.SET_FILL_STYLE,t];return typeof t!="string"&&n.push(e.fillPatternScale),n}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[re.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const n=e.fillStyle;(typeof n!="string"||e.currentFillStyle!=n)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=n)}updateStrokeStyle(e,t){const n=e.strokeStyle,s=e.lineCap,r=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,a=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=n||e.currentLineCap!=s||r!=e.currentLineDash&&!bn(e.currentLineDash,r)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=a||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=n,e.currentLineCap=s,e.currentLineDash=r,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=a,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[re.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=vm(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;oi(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class L1 extends po{constructor(e,t,n,s){super(e,t,n,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,n){if(!this.image_||this.maxExtent&&!is(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,n);const s=e.getFlatCoordinates(),r=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,r);this.instructions.push([re.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([re.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,n){if(!this.image_)return;this.beginGeometry(e,t,n);const s=e.getFlatCoordinates(),r=[];for(let a=0,h=s.length;a<h;a+=e.getStride())(!this.maxExtent||is(this.maxExtent,s.slice(a,a+2)))&&r.push(s[a],s[a+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,2);this.instructions.push([re.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([re.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const n=e.getAnchor(),s=e.getSize(),r=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=e.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=s[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class P1 extends po{constructor(e,t,n,s){super(e,t,n,s)}drawFlatCoordinates_(e,t,n,s){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,n,s,!1,!1),l=[re.MOVE_TO_LINE_TO,r,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),n}drawLineString(e,t,n){const s=this.state,r=s.strokeStyle,o=s.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(e,t,n),this.hitDetectionInstructions.push([re.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Ki,Xi],Yn);const l=e.getFlatCoordinates(),a=e.getStride();this.drawFlatCoordinates_(l,0,l.length,a),this.hitDetectionInstructions.push(En),this.endGeometry(t)}drawMultiLineString(e,t,n){const s=this.state,r=s.strokeStyle,o=s.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(e,t,n),this.hitDetectionInstructions.push([re.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Ki,Xi],Yn);const l=e.getEnds(),a=e.getFlatCoordinates(),h=e.getStride();let c=0;for(let u=0,d=l.length;u<d;++u)c=this.drawFlatCoordinates_(a,c,l[u],h);this.hitDetectionInstructions.push(En),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(En),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(En),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Yn)}}class wf extends po{constructor(e,t,n,s){super(e,t,n,s)}drawFlatCoordinatess_(e,t,n,s){const r=this.state,o=r.fillStyle!==void 0,l=r.strokeStyle!==void 0,a=n.length;this.instructions.push(Yn),this.hitDetectionInstructions.push(Yn);for(let h=0;h<a;++h){const c=n[h],u=this.coordinates.length,d=this.appendFlatLineCoordinates(e,t,c,s,!0,!l),f=[re.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),l&&(this.instructions.push(xf),this.hitDetectionInstructions.push(xf)),t=c}return o&&(this.instructions.push(ko),this.hitDetectionInstructions.push(ko)),l&&(this.instructions.push(En),this.hitDetectionInstructions.push(En)),t}drawCircle(e,t,n){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([re.SET_FILL_STYLE,At]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([re.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Ki,Xi]);const l=e.getFlatCoordinates(),a=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,a,!1,!1);const c=[re.CIRCLE,h];this.instructions.push(Yn,c),this.hitDetectionInstructions.push(Yn,c),s.fillStyle!==void 0&&(this.instructions.push(ko),this.hitDetectionInstructions.push(ko)),s.strokeStyle!==void 0&&(this.instructions.push(En),this.hitDetectionInstructions.push(En)),this.endGeometry(t)}drawPolygon(e,t,n){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([re.SET_FILL_STYLE,At]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([re.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Ki,Xi]);const l=e.getEnds(),a=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(a,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,n){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([re.SET_FILL_STYLE,At]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([re.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Ki,Xi]);const l=e.getEndss(),a=e.getOrientedFlatCoordinates(),h=e.getStride();let c=0;for(let u=0,d=l.length;u<d;++u)c=this.drawFlatCoordinatess_(a,c,l[u],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let n=0,s=t.length;n<s;++n)t[n]=jn(t[n],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function M1(i,e,t,n,s){const r=[];let o=t,l=0,a=e.slice(t,2);for(;l<i&&o+s<n;){const[h,c]=a.slice(-2),u=e[o+s],d=e[o+s+1],f=Math.sqrt((u-h)*(u-h)+(d-c)*(d-c));if(l+=f,l>=i){const g=(i-l+f)/f,m=Ot(h,u,g),_=Ot(c,d,g);a.push(m,_),r.push(a),a=[m,_],l==i&&(o+=s),l=0}else if(l<i)a.push(e[o+s],e[o+s+1]),o+=s;else{const g=f-l,m=Ot(h,u,g/f),_=Ot(c,d,g/f);a.push(m,_),r.push(a),a=[m,_],l=0,o+=s}}return l>0&&r.push(a),r}function O1(i,e,t,n,s){let r=t,o=t,l=0,a=0,h=t,c,u,d,f,g,m,_,p,y,v;for(u=t;u<n;u+=s){const C=e[u],x=e[u+1];g!==void 0&&(y=C-g,v=x-m,f=Math.sqrt(y*y+v*v),_!==void 0&&(a+=d,c=Math.acos((_*y+p*v)/(d*f)),c>i&&(a>l&&(l=a,r=h,o=u),a=0,h=u-s)),d=f,_=y,p=v),g=C,m=x}return a+=f,a>l?[h,u]:[r,o]}const El={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class F1 extends po{constructor(e,t,n,s){super(e,t,n,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[At]={fillStyle:At},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,n){const s=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!s&&!r)return;const l=this.coordinates;let a=l.length;const h=e.getType();let c=null,u=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ke(this.maxExtent,e.getExtent()))return;let d;if(c=e.getFlatCoordinates(),h=="LineString")d=[c.length];else if(h=="MultiLineString")d=e.getEnds();else if(h=="Polygon")d=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const _=e.getEndss();d=[];for(let p=0,y=_.length;p<y;++p)d.push(_[p][0])}this.beginGeometry(e,t,n);const f=o.repeat,g=f?void 0:o.textAlign;let m=0;for(let _=0,p=d.length;_<p;++_){let y;f?y=M1(f*this.resolution,c,m,d[_],u):y=[c.slice(m,d[_])];for(let v=0,C=y.length;v<C;++v){const x=y[v];let T=0,I=x.length;if(g==null){const b=O1(o.maxAngle,x,0,x.length,2);T=b[0],I=b[1]}for(let b=T;b<I;b+=u)l.push(x[b],x[b+1]);const L=l.length;m=d[_],this.drawChars_(a,L),a=L}}this.endGeometry(t)}else{let d=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=e.getFlatCoordinates();break;case"LineString":c=e.getFlatMidpoint();break;case"Circle":c=e.getCenter();break;case"MultiLineString":c=e.getFlatMidpoints(),u=2;break;case"Polygon":c=e.getFlatInteriorPoint(),o.overflow||d.push(c[2]/this.resolution),u=3;break;case"MultiPolygon":const C=e.getFlatInteriorPoints();c=[];for(let x=0,T=C.length;x<T;x+=3)o.overflow||d.push(C[x+2]/this.resolution),c.push(C[x],C[x+1]);if(c.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(c,u);if(f===a)return;if(d&&(f-a)/2!==c.length/u){let C=a/2;d=d.filter((x,T)=>{const I=l[(C+T)*2]===c[T*u]&&l[(C+T)*2+1]===c[T*u+1];return I||--C,I})}this.saveTextStates_();const g=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,m=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,n);let _=o.padding;if(_!=Hn&&(o.scale[0]<0||o.scale[1]<0)){let C=o.padding[0],x=o.padding[1],T=o.padding[2],I=o.padding[3];o.scale[0]<0&&(x=-x,I=-I),o.scale[1]<0&&(C=-C,T=-T),_=[C,x,T,I]}const p=this.pixelRatio;this.instructions.push([re.DRAW_IMAGE,a,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,_==Hn?Hn:_.map(function(C){return C*p}),g,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const y=1/p,v=g?g.slice(0):null;v&&(v[1]=At),this.hitDetectionInstructions.push([re.DRAW_IMAGE,a,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[y,y],NaN,this.declutterMode_,this.declutterImageWithText_,_,v,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?At:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,n=this.textFillState_,s=this.strokeKey_;e&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:t.font,textAlign:t.textAlign||Yr,justify:t.justify,textBaseline:t.textBaseline||_l,scale:t.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(e,t){const n=this.textStrokeState_,s=this.textState_,r=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,h=El[s.textBaseline],c=this.textOffsetY_*a,u=this.text_,d=n?n.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([re.DRAW_CHARS,e,t,h,s.overflow,l,s.maxAngle,a,c,r,d*a,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([re.DRAW_CHARS,e,t,h,s.overflow,l&&At,s.maxAngle,a,c,r,d*a,u,o,1/a,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let n,s,r;if(!e)this.text_="";else{const o=e.getFill();o?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=vi(o.getColor()||At)):(s=null,this.textFillState_=s);const l=e.getStroke();if(!l)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const m=l.getLineDash(),_=l.getLineDashOffset(),p=l.getWidth(),y=l.getMiterLimit();r.lineCap=l.getLineCap()||Ks,r.lineDash=m?m.slice():Ki,r.lineDashOffset=_===void 0?Xi:_,r.lineJoin=l.getLineJoin()||Xs,r.lineWidth=p===void 0?Zr:p,r.miterLimit=y===void 0?Xr:y,r.strokeStyle=vi(l.getColor()||Hr)}n=this.textState_;const a=e.getFont()||d_;Aw(a);const h=e.getScaleArray();n.overflow=e.getOverflow(),n.font=a,n.maxAngle=e.getMaxAngle(),n.placement=e.getPlacement(),n.textAlign=e.getTextAlign(),n.repeat=e.getRepeat(),n.justify=e.getJustify(),n.textBaseline=e.getTextBaseline()||_l,n.backgroundFill=e.getBackgroundFill(),n.backgroundStroke=e.getBackgroundStroke(),n.padding=e.getPadding()||Hn,n.scale=h===void 0?[1,1]:h;const c=e.getOffsetX(),u=e.getOffsetY(),d=e.getRotateWithView(),f=e.getKeepUpright(),g=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=g===void 0?0:g,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:de(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=s&&s.fillStyle?typeof s.fillStyle=="string"?s.fillStyle:"|"+de(s.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const D1={Circle:wf,Default:po,Image:L1,LineString:P1,Polygon:wf,Text:F1};class F_{constructor(e,t,n,s){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=s,this.resolution_=n,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const n=this.buildersByZIndex_[t];for(const s in n){const r=n[s].finish();e[t][s]=r}}return e}getBuilder(e,t){const n=e!==void 0?e.toString():"0";let s=this.buildersByZIndex_[n];s===void 0&&(s={},this.buildersByZIndex_[n]=s);let r=s[t];if(r===void 0){const o=D1[t];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[t]=r}return r}}function pu(i,e,t,n){let s=i[e],r=i[e+1],o=0;for(let l=e+n;l<t;l+=n){const a=i[l],h=i[l+1];o+=Math.sqrt((a-s)*(a-s)+(h-r)*(h-r)),s=a,r=h}return o}function k1(i,e,t,n,s,r,o,l,a,h,c,u,d=!0){let f=i[e],g=i[e+1],m=0,_=0,p=0,y=0;function v(){m=f,_=g,e+=n,f=i[e],g=i[e+1],y+=p,p=Math.sqrt((f-m)*(f-m)+(g-_)*(g-_))}do v();while(e<t-n&&y+p<r);let C=p===0?0:(r-y)/p;const x=Ot(m,f,C),T=Ot(_,g,C),I=e-n,L=y,b=r+l*a(h,s,c);for(;e<t-n&&y+p<b;)v();C=p===0?0:(b-y)/p;const G=Ot(m,f,C),W=Ot(_,g,C);let A=!1;if(d)if(u){const z=[x,T,G,W];jm(z,0,4,2,u,z,z),A=z[0]>z[2]}else A=x>G;const S=Math.PI,O=[],U=I+n===e;e=I,p=0,y=L,f=i[e],g=i[e+1];let N;if(U){v(),N=Math.atan2(g-_,f-m),A&&(N+=N>0?-S:S);const z=(G+x)/2,V=(W+T)/2;return O[0]=[z,V,(b-r)/2,N,s],O}s=s.replace(/\n/g," ");for(let z=0,V=s.length;z<V;){v();let J=Math.atan2(g-_,f-m);if(A&&(J+=J>0?-S:S),N!==void 0){let Le=J-N;if(Le+=Le>S?-2*S:Le<-S?2*S:0,Math.abs(Le)>o)return null}N=J;const se=z;let ae=0;for(;z<V;++z){const Le=A?V-z-1:z,De=l*a(h,s[Le],c);if(e+n<t&&y+p<r+ae+De/2)break;ae+=De}if(z===se)continue;const j=A?s.substring(V-se,V-z):s.substring(se,z);C=p===0?0:(r+ae/2-y)/p;const xe=Ot(m,f,C),ye=Ot(_,g,C);O.push([xe,ye,ae/2,J,j]),r+=ae}return O}const _s=wt(),an=[],Di=[],ki=[],cn=[];function Rf(i){return i[3].declutterBox}const Tf=new RegExp("[-----]");function rc(i,e){return e==="start"?e=Tf.test(i)?"right":"left":e==="end"&&(e=Tf.test(i)?"left":"right"),El[e]}function N1(i,e,t){return t>0&&i.push(`
`,""),i.push(e,""),i}function G1(i,e,t){return t%2===0&&(i+=e),i}class V1{constructor(e,t,n,s,r){this.overlaps=n,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=kt(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new uu:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,n,s){const r=e+t+n+s;if(this.labels_[r])return this.labels_[r];const o=s?this.strokeStates[s]:null,l=n?this.fillStates[n]:null,a=this.textStates[t],h=this.pixelRatio,c=[a.scale[0]*h,a.scale[1]*h],u=a.justify?El[a.justify]:rc(Array.isArray(e)?e[0]:e,a.textAlign||Yr),d=s&&o.lineWidth?o.lineWidth:0,f=Array.isArray(e)?e:String(e).split(`
`).reduce(N1,[]),{width:g,height:m,widths:_,heights:p,lineWidths:y}=Pw(a,f),v=g+d,C=[],x=(v+2)*c[0],T=(m+d)*c[1],I={width:x<0?Math.floor(x):Math.ceil(x),height:T<0?Math.floor(T):Math.ceil(T),contextInstructions:C};(c[0]!=1||c[1]!=1)&&C.push("scale",c),s&&(C.push("strokeStyle",o.strokeStyle),C.push("lineWidth",d),C.push("lineCap",o.lineCap),C.push("lineJoin",o.lineJoin),C.push("miterLimit",o.miterLimit),C.push("setLineDash",[o.lineDash]),C.push("lineDashOffset",o.lineDashOffset)),n&&C.push("fillStyle",l.fillStyle),C.push("textBaseline","middle"),C.push("textAlign","center");const L=.5-u;let b=u*v+L*d;const G=[],W=[];let A=0,S=0,O=0,U=0,N;for(let z=0,V=f.length;z<V;z+=2){const J=f[z];if(J===`
`){S+=A,A=0,b=u*v+L*d,++U;continue}const se=f[z+1]||a.font;se!==N&&(s&&G.push("font",se),n&&W.push("font",se),N=se),A=Math.max(A,p[O]);const ae=[J,b+L*_[O]+u*(_[O]-y[U]),.5*(d+A)+S];b+=_[O],s&&G.push("strokeText",ae),n&&W.push("fillText",ae),++O}return Array.prototype.push.apply(C,G),Array.prototype.push.apply(C,W),this.labels_[r]=I,I}replayTextBackground_(e,t,n,s,r,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,n),e.lineTo.apply(e,s),e.lineTo.apply(e,r),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,n,s,r,o,l,a,h,c,u,d,f,g,m,_){l*=d[0],a*=d[1];let p=n-l,y=s-a;const v=r+h>e?e-h:r,C=o+c>t?t-c:o,x=g[3]+v*d[0]+g[1],T=g[0]+C*d[1]+g[2],I=p-g[3],L=y-g[0];(m||u!==0)&&(an[0]=I,cn[0]=I,an[1]=L,Di[1]=L,Di[0]=I+x,ki[0]=Di[0],ki[1]=L+T,cn[1]=ki[1]);let b;return u!==0?(b=Si(kt(),n,s,1,1,u,-n,-s),$e(b,an),$e(b,Di),$e(b,ki),$e(b,cn),$i(Math.min(an[0],Di[0],ki[0],cn[0]),Math.min(an[1],Di[1],ki[1],cn[1]),Math.max(an[0],Di[0],ki[0],cn[0]),Math.max(an[1],Di[1],ki[1],cn[1]),_s)):$i(Math.min(I,I+x),Math.min(L,L+T),Math.max(I,I+x),Math.max(L,L+T),_s),f&&(p=Math.round(p),y=Math.round(y)),{drawImageX:p,drawImageY:y,drawImageW:v,drawImageH:C,originX:h,originY:c,declutterBox:{minX:_s[0],minY:_s[1],maxX:_s[2],maxY:_s[3],value:_},canvasTransform:b,scale:d}}replayImageOrLabel_(e,t,n,s,r,o,l){const a=!!(o||l),h=s.declutterBox,c=l?l[2]*s.scale[0]/2:0;return h.minX-c<=t[0]&&h.maxX+c>=0&&h.minY-c<=t[1]&&h.maxY+c>=0&&(a&&this.replayTextBackground_(e,an,Di,ki,cn,o,l),Mw(e,s.canvasTransform,r,n,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const n=$e(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;e.save(),e.translate(n[0]%s,n[1]%s),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,n,s){const r=this.textStates[t],o=this.createLabel(e,t,s,n),l=this.strokeStates[n],a=this.pixelRatio,h=rc(Array.isArray(e)?e[0]:e,r.textAlign||Yr),c=El[r.textBaseline||_l],u=l&&l.lineWidth?l.lineWidth:0,d=o.width/a-2*r.scale[0],f=h*d+2*(.5-h)*u,g=c*o.height/a+2*(.5-c)*u;return{label:o,anchorX:f,anchorY:g}}execute_(e,t,n,s,r,o,l,a){const h=this.zIndexContext_;let c;this.pixelCoordinates_&&bn(n,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Rn(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),IE(this.renderedTransform_,n));let u=0;const d=s.length;let f=0,g,m,_,p,y,v,C,x,T,I,L,b,G,W=0,A=0;const S=this.coordinateCache_,O=this.viewRotation_,U=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,N={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},z=this.instructions!=s||this.overlaps?0:200;let V,J,se,ae;for(;u<d;){const j=s[u];switch(j[0]){case re.BEGIN_GEOMETRY:V=j[1],ae=j[3],V.getGeometry()?l!==void 0&&!Ke(l,ae.getExtent())?u=j[2]+1:++u:u=j[2],h&&(h.zIndex=j[4]);break;case re.BEGIN_PATH:W>z&&(this.fill_(e),W=0),A>z&&(e.stroke(),A=0),!W&&!A&&(e.beginPath(),y=NaN,v=NaN),++u;break;case re.CIRCLE:f=j[1];const ye=c[f],Le=c[f+1],De=c[f+2],P=c[f+3],q=De-ye,Y=P-Le,Q=Math.sqrt(q*q+Y*Y);e.moveTo(ye+Q,Le),e.arc(ye,Le,Q,0,2*Math.PI,!0),++u;break;case re.CLOSE_PATH:e.closePath(),++u;break;case re.CUSTOM:f=j[1],g=j[2];const me=j[3],E=j[4],w=j[5];N.geometry=me,N.feature=V,u in S||(S[u]=[]);const R=S[u];w?w(c,f,g,2,R):(R[0]=c[f],R[1]=c[f+1],R.length=2),h&&(h.zIndex=j[6]),E(R,N),++u;break;case re.DRAW_IMAGE:f=j[1],g=j[2],T=j[3],m=j[4],_=j[5];let M=j[6];const k=j[7],F=j[8],Z=j[9],H=j[10];let K=j[11];const B=j[12];let ie=j[13];p=j[14]||"declutter";const X=j[15];if(!T&&j.length>=20){I=j[19],L=j[20],b=j[21],G=j[22];const Gt=this.drawLabelWithPointPlacement_(I,L,b,G);T=Gt.label,j[3]=T;const Mn=j[23];m=(Gt.anchorX-Mn)*this.pixelRatio,j[4]=m;const Vt=j[24];_=(Gt.anchorY-Vt)*this.pixelRatio,j[5]=_,M=T.height,j[6]=M,ie=T.width,j[13]=ie}let ne;j.length>25&&(ne=j[25]);let oe,_e,Re;j.length>17?(oe=j[16],_e=j[17],Re=j[18]):(oe=Hn,_e=null,Re=null),H&&U?K+=O:!H&&!U&&(K-=O);let Te=0;for(;f<g;f+=2){if(ne&&ne[Te++]<ie/this.pixelRatio)continue;const Gt=this.calculateImageOrLabelDimensions_(T.width,T.height,c[f],c[f+1],ie,M,m,_,F,Z,K,B,r,oe,!!_e||!!Re,V),Mn=[e,t,T,Gt,k,_e,Re];if(a){let Vt,fi,jt;if(X){const Be=g-f;if(!X[Be]){X[Be]={args:Mn,declutterMode:p};continue}const _t=X[Be];Vt=_t.args,fi=_t.declutterMode,delete X[Be],jt=Rf(Vt)}let Ai,Li;if(Vt&&(fi!=="declutter"||!a.collides(jt))&&(Ai=!0),(p!=="declutter"||!a.collides(Gt.declutterBox))&&(Li=!0),fi==="declutter"&&p==="declutter"){const Be=Ai&&Li;Ai=Be,Li=Be}Ai&&(fi!=="none"&&a.insert(jt),this.replayImageOrLabel_.apply(this,Vt)),Li&&(p!=="none"&&a.insert(Gt.declutterBox),this.replayImageOrLabel_.apply(this,Mn))}else this.replayImageOrLabel_.apply(this,Mn)}++u;break;case re.DRAW_CHARS:const nt=j[1],st=j[2],Rt=j[3],Nt=j[4];G=j[5];const Pn=j[6],Qs=j[7],ct=j[8];b=j[9];const Tt=j[10];I=j[11],Array.isArray(I)&&(I=I.reduce(G1,"")),L=j[12];const er=[j[13],j[13]];p=j[14]||"declutter";const Co=j[15],ya=this.textStates[L],tr=ya.font,ir=[ya.scale[0]*Qs,ya.scale[1]*Qs];let nr;tr in this.widths_?nr=this.widths_[tr]:(nr={},this.widths_[tr]=nr);const xu=pu(c,nt,st,2),wu=Math.abs(ir[0])*lf(tr,I,nr);if(Nt||wu<=xu){const Gt=this.textStates[L].textAlign,Mn=(xu-wu)*rc(I,Gt),Vt=k1(c,nt,st,2,I,Mn,Pn,Math.abs(ir[0]),lf,tr,nr,U?0:this.viewRotation_,Co);e:if(Vt){const fi=[];let jt,Ai,Li,Be,_t;if(b)for(jt=0,Ai=Vt.length;jt<Ai;++jt){_t=Vt[jt],Li=_t[4],Be=this.createLabel(Li,L,"",b),m=_t[2]+(ir[0]<0?-Tt:Tt),_=Rt*Be.height+(.5-Rt)*2*Tt*ir[1]/ir[0]-ct;const Pi=this.calculateImageOrLabelDimensions_(Be.width,Be.height,_t[0],_t[1],Be.width,Be.height,m,_,0,0,_t[3],er,!1,Hn,!1,V);if(a&&p==="declutter"&&a.collides(Pi.declutterBox))break e;fi.push([e,t,Be,Pi,1,null,null])}if(G)for(jt=0,Ai=Vt.length;jt<Ai;++jt){_t=Vt[jt],Li=_t[4],Be=this.createLabel(Li,L,G,""),m=_t[2],_=Rt*Be.height-ct;const Pi=this.calculateImageOrLabelDimensions_(Be.width,Be.height,_t[0],_t[1],Be.width,Be.height,m,_,0,0,_t[3],er,!1,Hn,!1,V);if(a&&p==="declutter"&&a.collides(Pi.declutterBox))break e;fi.push([e,t,Be,Pi,1,null,null])}a&&p!=="none"&&a.load(fi.map(Rf));for(let Pi=0,np=fi.length;Pi<np;++Pi)this.replayImageOrLabel_.apply(this,fi[Pi])}}++u;break;case re.END_GEOMETRY:if(o!==void 0){V=j[1];const Gt=o(V,ae,p);if(Gt)return Gt}++u;break;case re.FILL:z?W++:this.fill_(e),++u;break;case re.MOVE_TO_LINE_TO:for(f=j[1],g=j[2],J=c[f],se=c[f+1],e.moveTo(J,se),y=J+.5|0,v=se+.5|0,f+=2;f<g;f+=2)J=c[f],se=c[f+1],C=J+.5|0,x=se+.5|0,(f==g-2||C!==y||x!==v)&&(e.lineTo(J,se),y=C,v=x);++u;break;case re.SET_FILL_STYLE:this.alignAndScaleFill_=j[2],W&&(this.fill_(e),W=0,A&&(e.stroke(),A=0)),e.fillStyle=j[1],++u;break;case re.SET_STROKE_STYLE:A&&(e.stroke(),A=0),this.setStrokeStyle_(e,j),++u;break;case re.STROKE:z?A++:e.stroke(),++u;break;default:++u;break}}W&&this.fill_(e),A&&e.stroke()}execute(e,t,n,s,r,o){this.viewRotation_=s,this.execute_(e,t,n,this.instructions,r,void 0,void 0,o)}executeHitDetection(e,t,n,s,r){return this.viewRotation_=n,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,s,r)}}const Wn=["Polygon","Circle","LineString","Image","Text","Default"],xl=["Image","Text"],j1=Wn.filter(i=>!xl.includes(i));class D_{constructor(e,t,n,s,r,o,l){this.maxExtent_=e,this.overlaps_=s,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=kt(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,l)}clip(e,t){const n=this.getClipCoords(t);e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(n[2],n[3]),e.lineTo(n[4],n[5]),e.lineTo(n[6],n[7]),e.clip()}createExecutors_(e,t){for(const n in e){let s=this.executorsByZIndex_[n];s===void 0&&(s={},this.executorsByZIndex_[n]=s);const r=e[n];for(const o in r){const l=r[o];s[o]=new V1(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const n=this.executorsByZIndex_[t];for(let s=0,r=e.length;s<r;++s)if(e[s]in n)return!0}return!1}forEachFeatureAtCoordinate(e,t,n,s,r,o){s=Math.round(s);const l=s*2+1,a=Si(this.hitDetectionTransform_,s+.5,s+.5,1/t,-1/t,-n,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=qe(l,l));const c=this.hitDetectionContext_;c.canvas.width!==l||c.canvas.height!==l?(c.canvas.width=l,c.canvas.height=l):h||c.clearRect(0,0,l,l);let u;this.renderBuffer_!==void 0&&(u=wt(),Ar(u,e),oi(u,t*(this.renderBuffer_+s),u));const d=z1(s);let f;function g(x,T,I){const L=c.getImageData(0,0,l,l).data;for(let b=0,G=d.length;b<G;b++)if(L[d[b]]>0){if(!o||I==="none"||f!=="Image"&&f!=="Text"||o.includes(x)){const W=(d[b]-3)/4,A=s-W%l,S=s-(W/l|0),O=r(x,T,A*A+S*S);if(O)return O}c.clearRect(0,0,l,l);break}}const m=Object.keys(this.executorsByZIndex_).map(Number);m.sort(xi);let _,p,y,v,C;for(_=m.length-1;_>=0;--_){const x=m[_].toString();for(y=this.executorsByZIndex_[x],p=Wn.length-1;p>=0;--p)if(f=Wn[p],v=y[f],v!==void 0&&(C=v.executeHitDetection(c,a,n,g,u),C))return C}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const n=t[0],s=t[1],r=t[2],o=t[3],l=[n,s,n,o,r,o,r,s];return Rn(l,0,8,2,e,l),l}isEmpty(){return es(this.executorsByZIndex_)}execute(e,t,n,s,r,o,l){const a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(l?bv:xi),o=o||Wn;const h=Wn.length;for(let c=0,u=a.length;c<u;++c){const d=a[c].toString(),f=this.executorsByZIndex_[d];for(let g=0,m=o.length;g<m;++g){const _=o[g],p=f[_];if(p!==void 0){const y=l===null?void 0:p.getZIndexContext(),v=y?y.getContext():e,C=this.maxExtent_&&_!=="Image"&&_!=="Text";if(C&&(v.save(),this.clip(v,n)),!y||_==="Text"||_==="Image"?p.execute(v,t,n,s,r,l):y.pushFunction(x=>p.execute(x,t,n,s,r,l)),C&&v.restore(),y){y.offset();const x=a[c]*h+Wn.indexOf(_);this.deferredZIndexContexts_[x]||(this.deferredZIndexContexts_[x]=[]),this.deferredZIndexContexts_[x].push(y)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(xi);for(let n=0,s=t.length;n<s;++n)e[t[n]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),e[t[n]].length=0}}const oc={};function z1(i){if(oc[i]!==void 0)return oc[i];const e=i*2+1,t=i*i,n=new Array(t+1);for(let r=0;r<=i;++r)for(let o=0;o<=i;++o){const l=r*r+o*o;if(l>t)break;let a=n[l];a||(a=[],n[l]=a),a.push(((i+r)*e+(i+o))*4+3),r>0&&a.push(((i-r)*e+(i+o))*4+3),o>0&&(a.push(((i+r)*e+(i-o))*4+3),r>0&&a.push(((i-r)*e+(i-o))*4+3))}const s=[];for(let r=0,o=n.length;r<o;++r)n[r]&&s.push(...n[r]);return oc[i]=s,s}class k_ extends O_{constructor(e,t,n,s,r,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=n,this.transform_=s,this.transformRotation_=s?ao(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=kt()}drawImages_(e,t,n,s){if(!this.image_)return;const r=Rn(e,t,n,s,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,a=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=a*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let c=0,u=r.length;c<u;c+=2){const d=r[c]-this.imageAnchorX_,f=r[c+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=d+this.imageAnchorX_,m=f+this.imageAnchorY_;Si(l,g,m,1,1,h,-g,-m),o.save(),o.transform.apply(o,l),o.translate(g,m),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=a)}drawText_(e,t,n,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Rn(e,t,n,s,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<n;t+=s){const a=r[t]+this.textOffsetX_,h=r[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(a-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,a,h),this.textFillState_&&o.fillText(this.text_,a,h))}}moveToLineTo_(e,t,n,s,r){const o=this.context_,l=Rn(e,t,n,s,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let a=l.length;r&&(a-=2);for(let h=2;h<a;h+=2)o.lineTo(l[h],l[h+1]);return r&&o.closePath(),n}drawRings_(e,t,n,s){for(let r=0,o=n.length;r<o;++r)t=this.moveToLineTo_(e,t,n[r],s,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=NE(e,this.transform_,this.pixelCoordinates_),n=t[2]-t[0],s=t[3]-t[1],r=Math.sqrt(n*n+s*s),o=this.context_;o.beginPath(),o.arc(t[0],t[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const n=t.getGeometryFunction()(e);n&&(this.setStyle(t),this.drawGeometry(n))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let n=0,s=t.length;n<s;++n)this.drawGeometry(t[n])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),n=e.getStride();this.image_&&this.drawImages_(t,0,t.length,n),this.text_!==""&&this.drawText_(t,0,t.length,n)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),n=e.getStride();this.image_&&this.drawImages_(t,0,t.length,n),this.text_!==""&&this.drawText_(t,0,t.length,n)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,n=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(n,0,n.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Ke(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,s=e.getFlatCoordinates();let r=0;const o=e.getEnds(),l=e.getStride();n.beginPath();for(let a=0,h=o.length;a<h;++a)r=this.moveToLineTo_(s,r,o[a],l,!1);n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,n=e.getOrientedFlatCoordinates();let s=0;const r=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,a=r.length;l<a;++l){const h=r[l];s=this.drawRings_(n,s,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,n=this.contextFillState_;n?n.fillStyle!=e.fillStyle&&(n.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=e.lineCap&&(n.lineCap=e.lineCap,t.lineCap=e.lineCap),bn(n.lineDash,e.lineDash)||t.setLineDash(n.lineDash=e.lineDash),n.lineDashOffset!=e.lineDashOffset&&(n.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),n.lineJoin!=e.lineJoin&&(n.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),n.lineWidth!=e.lineWidth&&(n.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),n.miterLimit!=e.miterLimit&&(n.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),n.strokeStyle!=e.strokeStyle&&(n.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,n=this.contextTextState_,s=e.textAlign?e.textAlign:Yr;n?(n.font!=e.font&&(n.font=e.font,t.font=e.font),n.textAlign!=s&&(n.textAlign=s,t.textAlign=s),n.textBaseline!=e.textBaseline&&(n.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=s,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:s,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const n=e.getColor();this.fillState_={fillStyle:vi(n||At)}}if(!t)this.strokeState_=null;else{const n=t.getColor(),s=t.getLineCap(),r=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),a=t.getWidth(),h=t.getMiterLimit(),c=r||Ki;this.strokeState_={lineCap:s!==void 0?s:Ks,lineDash:this.pixelRatio_===1?c:c.map(u=>u*this.pixelRatio_),lineDashOffset:(o||Xi)*this.pixelRatio_,lineJoin:l!==void 0?l:Xs,lineWidth:(a!==void 0?a:Zr)*this.pixelRatio_,miterLimit:h!==void 0?h:Xr,strokeStyle:vi(n||Hr)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const n=e.getPixelRatio(this.pixelRatio_),s=e.getAnchor(),r=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*n,this.imageAnchorY_=s[1]*n,this.imageHeight_=t[1]*n,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=t[0]*n}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const f=t.getColor();this.textFillState_={fillStyle:vi(f||At)}}const n=e.getStroke();if(!n)this.textStrokeState_=null;else{const f=n.getColor(),g=n.getLineCap(),m=n.getLineDash(),_=n.getLineDashOffset(),p=n.getLineJoin(),y=n.getWidth(),v=n.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:Ks,lineDash:m||Ki,lineDashOffset:_||Xi,lineJoin:p!==void 0?p:Xs,lineWidth:y!==void 0?y:Zr,miterLimit:v!==void 0?v:Xr,strokeStyle:vi(f||Hr)}}const s=e.getFont(),r=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),a=e.getRotation(),h=e.getScaleArray(),c=e.getText(),u=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:s!==void 0?s:d_,textAlign:u!==void 0?u:Yr,textBaseline:d!==void 0?d:_l},this.text_=c!==void 0?Array.isArray(c)?c.reduce((f,g,m)=>f+=m%2?" ":g,""):c:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=a!==void 0?a:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const Ft=.5;function N_(i,e,t,n,s,r,o,l,a){const h=a?Nh(s):s,c=i[0]*Ft,u=i[1]*Ft,d=qe(c,u);d.imageSmoothingEnabled=!1;const f=d.canvas,g=new k_(d,Ft,s,null,o,l,a?ea(TE(),a):null),m=t.length,_=Math.floor((256*256*256-1)/m),p={};for(let v=1;v<=m;++v){const C=t[v-1],x=C.getStyleFunction()||n;if(!x)continue;let T=x(C,r);if(!T)continue;Array.isArray(T)||(T=[T]);const L=(v*_).toString(16).padStart(7,"#00000");for(let b=0,G=T.length;b<G;++b){const W=T[b],A=W.getGeometryFunction()(C);if(!A||!Ke(h,A.getExtent()))continue;const S=W.clone(),O=S.getFill();O&&O.setColor(L);const U=S.getStroke();U&&(U.setColor(L),U.setLineDash(null)),S.setText(void 0);const N=W.getImage();if(N){const se=N.getImageSize();if(!se)continue;const ae=qe(se[0],se[1],void 0,{alpha:!1}),j=ae.canvas;ae.fillStyle=L,ae.fillRect(0,0,j.width,j.height),S.setImage(new In({img:j,anchor:N.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:N.getOrigin(),opacity:1,size:N.getSize(),scale:N.getScale(),rotation:N.getRotation(),rotateWithView:N.getRotateWithView()}))}const z=S.getZIndex()||0;let V=p[z];V||(V={},p[z]=V,V.Polygon=[],V.Circle=[],V.LineString=[],V.Point=[]);const J=A.getType();if(J==="GeometryCollection"){const se=A.getGeometriesArrayRecursive();for(let ae=0,j=se.length;ae<j;++ae){const xe=se[ae];V[xe.getType().replace("Multi","")].push(xe,S)}}else V[J.replace("Multi","")].push(A,S)}}const y=Object.keys(p).map(Number).sort(xi);for(let v=0,C=y.length;v<C;++v){const x=p[y[v]];for(const T in x){const I=x[T];for(let L=0,b=I.length;L<b;L+=2){g.setStyle(I[L+1]);for(let G=0,W=e.length;G<W;++G)g.setTransform(e[G]),g.drawGeometry(I[L])}}}return d.getImageData(0,0,f.width,f.height)}function G_(i,e,t){const n=[];if(t){const s=Math.floor(Math.round(i[0])*Ft),r=Math.floor(Math.round(i[1])*Ft),o=(ze(s,0,t.width-1)+ze(r,0,t.height-1)*t.width)*4,l=t.data[o],a=t.data[o+1],c=t.data[o+2]+256*(a+256*l),u=Math.floor((256*256*256-1)/e.length);c&&c%u===0&&n.push(e[c/u-1])}return n}const B1=.5,V_={Point:$1,LineString:H1,Polygon:J1,MultiPoint:q1,MultiLineString:Y1,MultiPolygon:Z1,GeometryCollection:X1,Circle:U1};function W1(i,e){return parseInt(de(i),10)-parseInt(de(e),10)}function Zc(i,e){const t=j_(i,e);return t*t}function j_(i,e){return B1*i/e}function U1(i,e,t,n,s){const r=t.getFill(),o=t.getStroke();if(r||o){const a=i.getBuilder(t.getZIndex(),"Circle");a.setFillStrokeStyle(r,o),a.drawCircle(e,n,s)}const l=t.getText();if(l&&l.getText()){const a=i.getBuilder(t.getZIndex(),"Text");a.setTextStyle(l),a.drawText(e,n)}}function wl(i,e,t,n,s,r,o,l){const a=[],h=t.getImage();if(h){let d=!0;const f=h.getImageState();f==te.LOADED||f==te.ERROR?d=!1:f==te.IDLE&&h.load(),d&&a.push(h.ready())}const c=t.getFill();c&&c.loading()&&a.push(c.ready());const u=a.length>0;return u&&Promise.all(a).then(()=>s(null)),K1(i,e,t,n,r,o,l),u}function K1(i,e,t,n,s,r,o){const l=t.getGeometryFunction()(e);if(!l)return;const a=l.simplifyTransformed(n,s);if(t.getRenderer())z_(i,a,t,e,o);else{const c=V_[a.getType()];c(i,a,t,e,o,r)}}function z_(i,e,t,n,s){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,a=o.length;l<a;++l)z_(i,o[l],t,n,s);return}i.getBuilder(t.getZIndex(),"Default").drawCustom(e,n,t.getRenderer(),t.getHitDetectionRenderer(),s)}function X1(i,e,t,n,s,r){const o=e.getGeometriesArray();let l,a;for(l=0,a=o.length;l<a;++l){const h=V_[o[l].getType()];h(i,o[l],t,n,s,r)}}function H1(i,e,t,n,s){const r=t.getStroke();if(r){const l=i.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,r),l.drawLineString(e,n,s)}const o=t.getText();if(o&&o.getText()){const l=i.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,n,s)}}function Y1(i,e,t,n,s){const r=t.getStroke();if(r){const l=i.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,r),l.drawMultiLineString(e,n,s)}const o=t.getText();if(o&&o.getText()){const l=i.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,n,s)}}function Z1(i,e,t,n,s){const r=t.getFill(),o=t.getStroke();if(o||r){const a=i.getBuilder(t.getZIndex(),"Polygon");a.setFillStrokeStyle(r,o),a.drawMultiPolygon(e,n,s)}const l=t.getText();if(l&&l.getText()){const a=i.getBuilder(t.getZIndex(),"Text");a.setTextStyle(l),a.drawText(e,n,s)}}function $1(i,e,t,n,s,r){const o=t.getImage(),l=t.getText(),a=l&&l.getText(),h=r&&o&&a?{}:void 0;if(o){if(o.getImageState()!=te.LOADED)return;const c=i.getBuilder(t.getZIndex(),"Image");c.setImageStyle(o,h),c.drawPoint(e,n,s)}if(a){const c=i.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l,h),c.drawText(e,n,s)}}function q1(i,e,t,n,s,r){const o=t.getImage(),l=o&&o.getOpacity()!==0,a=t.getText(),h=a&&a.getText(),c=r&&l&&h?{}:void 0;if(l){if(o.getImageState()!=te.LOADED)return;const u=i.getBuilder(t.getZIndex(),"Image");u.setImageStyle(o,c),u.drawMultiPoint(e,n,s)}if(h){const u=i.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(e,n,s)}}function J1(i,e,t,n,s){const r=t.getFill(),o=t.getStroke();if(r||o){const a=i.getBuilder(t.getZIndex(),"Polygon");a.setFillStrokeStyle(r,o),a.drawPolygon(e,n,s)}const l=t.getText();if(l&&l.getText()){const a=i.getBuilder(t.getZIndex(),"Text");a.setTextStyle(l),a.drawText(e,n,s)}}class Q1 extends du{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=wt(),this.wrappedRenderedExtent_=wt(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,n){const s=t.extent,r=t.viewState,o=r.center,l=r.resolution,a=r.projection,h=r.rotation,c=a.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=t.pixelRatio,g=t.viewHints,m=!(g[je.ANIMATING]||g[je.INTERACTING]),_=this.context,p=Math.round(ve(s)/l*f),y=Math.round(Ye(s)/l*f),v=u.getWrapX()&&a.canWrapX(),C=v?ve(c):null,x=v?Math.ceil((s[2]-c[2])/C)+1:1;let T=v?Math.floor((s[0]-c[0])/C):0;do{let I=this.getRenderTransform(o,l,0,f,p,y,T*C);t.declutter&&(I=I.slice(0)),e.execute(_,[_.canvas.width,_.canvas.height],I,h,m,n===void 0?Wn:n?xl:j1,n?d&&t.declutter[d]:void 0)}while(++T<x)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=qe(this.context.canvas.width,this.context.canvas.height,yf))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,uo(this.context),yf.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const n=e.layerStatesArray[e.layerIndex];this.opacity_=n.opacity;const s=e.viewState;this.prepareContainer(e,t);const r=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Kt.PRERENDER)||this.getLayer().hasListener(Kt.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(r,e),s.projection,this.clipped_=!1,l&&n.extent&&this.clipping){const a=Ci(n.extent);l=Ke(a,e.extent),this.clipped_=l&&!yi(a,e.extent),this.clipped_&&this.clipUnrotated(r,e,a)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&r.restore(),this.postRender(r,e),this.renderedRotation_!==s.rotation&&(this.renderedRotation_=s.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=this.frameState.size.slice(),s=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,a=this.wrappedRenderedExtent_,h=this.getLayer(),c=[],u=n[0]*Ft,d=n[1]*Ft;c.push(this.getRenderTransform(s,r,o,Ft,u,d,0).slice());const f=h.getSource(),g=l.getExtent();if(f.getWrapX()&&l.canWrapX()&&!yi(g,a)){let m=a[0];const _=ve(g);let p=0,y;for(;m<g[0];)--p,y=_*p,c.push(this.getRenderTransform(s,r,o,Ft,u,d,y).slice()),m+=_;for(p=0,m=a[2];m>g[2];)++p,y=_*p,c.push(this.getRenderTransform(s,r,o,Ft,u,d,y).slice()),m-=_}this.hitDetectionImageData_=N_(n,c,this.renderedFeatures_,h.getStyleFunction(),a,r,o,Zc(r,this.renderedPixelRatio_),null)}t(G_(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,n,s,r){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,a=this.getLayer(),h={},c=function(d,f,g){const m=de(d),_=h[m];if(_){if(_!==!0&&g<_.distanceSq){if(g===0)return h[m]=!0,r.splice(r.lastIndexOf(_),1),s(d,a,f);_.geometry=f,_.distanceSq=g}}else{if(g===0)return h[m]=!0,s(d,a,f);r.push(h[m]={feature:d,layer:a,geometry:f,distanceSq:g,callback:s})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,n,c,u?t.declutter?.[u]?.all().map(d=>d.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),n=t.getSource();if(!n)return!1;const s=e.viewHints[je.ANIMATING],r=e.viewHints[je.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&s||!l&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=e.extent,h=e.viewState,c=h.projection,u=h.resolution,d=e.pixelRatio,f=t.getRevision(),g=t.getRenderBuffer();let m=t.getRenderOrder();m===void 0&&(m=W1);const _=h.center.slice(),p=oi(a,g*u),y=p.slice(),v=[p.slice()],C=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!yi(C,e.extent)){const O=ve(C),U=Math.max(ve(p)/2,O);p[0]=C[0]-U,p[2]=C[2]+U,Ph(_,c);const N=Tm(v[0],c);N[0]<C[0]&&N[2]<C[2]?v.push([N[0]+O,N[1],N[2]+O,N[3]]):N[0]>C[0]&&N[2]>C[2]&&v.push([N[0]-O,N[1],N[2]-O,N[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==m&&this.renderedFrameDeclutter_===!!e.declutter&&yi(this.wrappedRenderedExtent_,p))return bn(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new F_(j_(u,d),p,u,d);let T;for(let O=0,U=v.length;O<U;++O)n.loadFeatures(v[O],u,c);const I=Zc(u,d);let L=!0;const b=(O,U)=>{let N;const z=O.getStyleFunction()||t.getStyleFunction();if(z&&(N=z(O,u)),N){const V=this.renderFeature(O,I,N,x,T,this.getLayer().getDeclutter(),U);L=L&&!V}},G=Nh(p),W=n.getFeaturesInExtent(G);m&&W.sort(m);for(let O=0,U=W.length;O<U;++O)b(W[O],O);this.renderedFeatures_=W,this.ready=L;const A=x.finish(),S=new D_(p,u,d,n.getOverlaps(),A,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=m,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=p,this.renderedCenter_=_,this.renderedProjection_=c,this.renderedPixelRatio_=d,this.replayGroup_=S,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,n,s,r,o,l){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let h=0,c=n.length;h<c;++h)a=wl(s,e,n[h],t,this.boundHandleStyleImageChange_,r,o,l)||a;else a=wl(s,e,n,t,this.boundHandleStyleImageChange_,r,o,l);return a}}class B_ extends ua{constructor(e){super(e)}createRenderer(){return new Q1(this)}}let eR=!1;function W_(i,e,t,n,s,r,o){const l=new XMLHttpRequest;l.open("GET",typeof i=="function"?i(t,n,s):i,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=eR,l.onload=function(a){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let c;h=="text"||h=="json"?c=l.responseText:h=="xml"?c=l.responseXML||l.responseText:h=="arraybuffer"&&(c=l.response),c?r(e.readFeatures(c,{extent:t,featureProjection:s}),e.readProjection(c)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function Sf(i,e){return function(t,n,s,r,o){W_(i,e,t,n,s,(l,a)=>{this.addFeatures(l),r!==void 0&&r(l)},()=>{this.changed(),o!==void 0&&o()})}}function tR(i,e){return[[-1/0,-1/0,1/0,1/0]]}class yo extends di{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new yo(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ne(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Ee(e,le.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?iR(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function iR(i){if(typeof i=="function")return i;let e;return Array.isArray(i)?e=i:(we(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[i]),function(){return e}}function U_(i,e,t,n){const s=[];let r=wt();for(let o=0,l=t.length;o<l;++o){const a=t[o];r=bh(i,e,a[0],n),s.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=a[a.length-1]}return s}function Rl(i,e,t,n,s,r,o){let l,a;const h=(t-e)/n;if(h===1)l=e;else if(h===2)l=e,a=s;else if(h!==0){let c=i[e],u=i[e+1],d=0;const f=[0];for(let _=e+n;_<t;_+=n){const p=i[_],y=i[_+1];d+=Math.sqrt((p-c)*(p-c)+(y-u)*(y-u)),f.push(d),c=p,u=y}const g=s*d,m=Iv(f,g);m<0?(a=(g-f[-m-2])/(f[-m-1]-f[-m-2]),l=e+(-m-2)*n):l=e+m*n}o=o>1?o:2,r=r||new Array(o);for(let c=0;c<o;++c)r[c]=l===void 0?NaN:a===void 0?i[l+c]:Ot(i[l+c],i[l+n+c],a);return r}function $c(i,e,t,n,s,r){if(t==e)return null;let o;if(s<i[e+n-1])return r?(o=i.slice(e,e+n),o[n-1]=s,o):null;if(i[t-1]<s)return r?(o=i.slice(t-n,t),o[n-1]=s,o):null;if(s==i[e+n-1])return i.slice(e,e+n);let l=e/n,a=t/n;for(;l<a;){const d=l+a>>1;s<i[(d+1)*n-1]?a=d:l=d+1}const h=i[l*n-1];if(s==h)return i.slice((l-1)*n,(l-1)*n+n);const c=i[(l+1)*n-1],u=(s-h)/(c-h);o=[];for(let d=0;d<n-1;++d)o.push(Ot(i[(l-1)*n+d],i[l*n+d],u));return o.push(s),o}function nR(i,e,t,n,s,r,o){if(o)return $c(i,e,t[t.length-1],n,s,r);let l;if(s<i[n-1])return r?(l=i.slice(0,n),l[n-1]=s,l):null;if(i[i.length-1]<s)return r?(l=i.slice(i.length-n),l[n-1]=s,l):null;for(let a=0,h=t.length;a<h;++a){const c=t[a];if(e!=c){if(s<i[e+n-1])return null;if(s<=i[c-1])return $c(i,e,c,n,s,!1);e=c}}return null}class Hs extends Ln{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){ri(this.flatCoordinates,e),this.changed()}clone(){const e=new Hs(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,s){return s<Zs(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Bh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,n,s))}forEachSegment(e){return Km(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,$c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return Rl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return pu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=ia(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Hs(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return na(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ta(this.flatCoordinates,0,e,this.stride),this.changed()}}class Tl extends Ln{constructor(e,t,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&n)this.setFlatCoordinates(t,e),this.ends_=n;else{const s=e,r=[],o=[];for(let a=0,h=s.length;a<h;++a){const c=s[a];ri(r,c.getFlatCoordinates()),o.push(r.length)}const l=s.length===0?this.getLayout():s[0].getLayout();this.setFlatCoordinates(l,r),this.ends_=o}}appendLineString(e){ri(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Tl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,n,s){return s<Zs(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(zh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Wh(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,n,s))}getCoordinateAtM(e,t,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,n=n!==void 0?n:!1,nR(this.flatCoordinates,0,this.ends_,this.stride,e,t,n))}getCoordinates(){return Ur(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new Hs(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,n=this.layout,s=[];let r=0;for(let o=0,l=t.length;o<l;++o){const a=t[o],h=new Hs(e.slice(r,a),n);s.push(h),r=a}return s}getLength(){const e=this.ends_;let t=0,n=0;for(let s=0,r=e.length;s<r;++s)n+=pu(this.flatCoordinates,t,e[s],this.stride),t=e[s];return n}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let n=0;const s=this.ends_,r=this.stride;for(let o=0,l=s.length;o<l;++o){const a=s[o],h=Rl(t,n,a,r,.5);ri(e,h),n=a}return e}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=Wm(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,n),new Tl(t,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(e){return HE(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Uh(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}class ma extends Ln{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){ri(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new ma(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,s){if(s<Zs(this.getExtent(),e,t))return s;const r=this.flatCoordinates,o=this.stride;for(let l=0,a=r.length;l<a;l+=o){const h=qn(e,t,r[l],r[l+1]);if(h<s){s=h;for(let c=0;c<o;++c)n[c]=r[l+c];n.length=o}}return s}getCoordinates(){return yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new Ii(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,n=this.stride,s=[];for(let r=0,o=e.length;r<o;r+=n){const l=new Ii(e.slice(r,r+n),t);s.push(l)}return s}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,n=this.stride;for(let s=0,r=t.length;s<r;s+=n){const o=t[s],l=t[s+1];if(Sh(e,o,l))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ta(this.flatCoordinates,0,e,this.stride),this.changed()}}class Sl extends Ln{constructor(e,t,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){const s=e,r=[],o=[];for(let l=0,a=s.length;l<a;++l){const h=s[l],c=r.length,u=h.getEnds();for(let d=0,f=u.length;d<f;++d)u[d]+=c;ri(r,h.getFlatCoordinates()),o.push(u)}t=s.length===0?this.getLayout():s[0].getLayout(),e=r,n=o}t!==void 0&&n?(this.setFlatCoordinates(t,e),this.endss_=n):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;ri(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let s=0,r=t.length;s<r;++s)t[s]+=n}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let s=0;s<e;++s)t[s]=this.endss_[s].slice();const n=new Sl(this.flatCoordinates.slice(),this.layout,t);return n.applyProperties(this),n}closestPointXY(e,t,n,s){return s<Zs(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(VE(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),jE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,n,s))}containsXY(e,t){return XE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return GE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Kd(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,Vc(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=U_(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Um(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ma(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;$E(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Kd(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=UE(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,n),new Sl(t,"XY",n)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const r=this.endss_[e-1];t=r[r.length-1]}const n=this.endss_[e].slice(),s=n[n.length-1];if(t!==0)for(let r=0,o=n.length;r<o;++r)n[r]-=t;return new qi(this.flatCoordinates.slice(t,s),this.layout,n)}getPolygons(){const e=this.layout,t=this.flatCoordinates,n=this.endss_,s=[];let r=0;for(let o=0,l=n.length;o<l;++o){const a=n[o].slice(),h=a[a.length-1];if(r!==0)for(let u=0,d=a.length;u<d;++u)a[u]-=r;const c=new qi(t.slice(r,h),e,a);s.push(c),r=h}return s}getType(){return"MultiPolygon"}intersectsExtent(e){return YE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=BE(this.flatCoordinates,0,e,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const s=n[n.length-1];this.flatCoordinates.length=s.length===0?0:s[s.length-1]}this.changed()}}const If=kt();class Lt{constructor(e,t,n,s,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=r,this.squaredTolerance_,this.stride_=s,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Ih(this.flatCoordinates_):bh(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=$t(this.getExtent());this.flatInteriorPoints_=Hh(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Zm(this.flatCoordinates_,this.ends_),t=U_(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Um(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Rl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const n=this.ends_;for(let s=0,r=n.length;s<r;++s){const o=n[s],l=Rl(e,t,o,2,.5);ri(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Oe(e);const t=e.getExtent(),n=e.getWorldExtent();if(t&&n){const s=Ye(n)/Ye(t);Si(If,n[0],n[3],s,-s,0,0,0),Rn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,If,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Lt(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=gm((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const n=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":n.length=ia(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,n,0),s=[n.length];break;case"MultiLineString":s=[],n.length=Wm(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,n,0,s);break;case"Polygon":s=[],n.length=Kh(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),n,0,s);break}return s&&(this.simplifiedGeometry_=new Lt(this.type_,n,s,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Lt.prototype.getFlatCoordinates=Lt.prototype.getOrientedFlatCoordinates;class bf{constructor(e){this.rbush_=new r_(e),this.items_={}}insert(e,t){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[de(t)]=n}load(e,t){const n=new Array(t.length);for(let s=0,r=t.length;s<r;s++){const o=e[s],l=t[s],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};n[s]=a,this.items_[de(l)]=a}this.rbush_.load(n)}remove(e){const t=de(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null}update(e,t){const n=this.items_[de(t)],s=[n.minX,n.minY,n.maxX,n.maxY];ns(s,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(s){return s.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let n;for(let s=0,r=e.length;s<r;s++)if(n=t(e[s]),n)return n;return n}isEmpty(){return es(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return $i(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}const Bt={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class hn extends bi{constructor(e,t,n){super(e),this.feature=t,this.features=n}}class eo extends mu{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=zr,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(we(this.format_,"`format` must be set when `url` is set"),this.loader_=Sf(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:tR;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new bf:null,this.loadedExtentsRtree_=new bf,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,s;Array.isArray(e.features)?s=e.features:e.features&&(n=e.features,s=n.getArray()),!t&&n===void 0&&(n=new Wt(s)),s!==void 0&&this.addFeaturesInternal(s),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=de(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const n=e.getGeometry();if(n){const s=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new hn(Bt.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Lt||(this.featureChangeKeys_[e]=[Ee(t,le.CHANGE,this.handleFeatureChange_,this),Ee(t,Bs.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let n=!0;if(t.getId()!==void 0){const s=String(t.getId());if(!(s in this.idIndex_))this.idIndex_[s]=t;else if(t instanceof Lt){const r=this.idIndex_[s];r instanceof Lt?Array.isArray(r)?r.push(t):this.idIndex_[s]=[r,t]:n=!1}else n=!1}return n&&(we(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),n}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],n=[],s=[];for(let r=0,o=e.length;r<o;r++){const l=e[r],a=de(l);this.addToIndex_(a,l)&&n.push(l)}for(let r=0,o=n.length;r<o;r++){const l=n[r],a=de(l);this.setupChangeEvents_(a,l);const h=l.getGeometry();if(h){const c=h.getExtent();t.push(c),s.push(l)}else this.nullGeometryFeatures_[a]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,s),this.hasListener(Bt.ADDFEATURE))for(let r=0,o=n.length;r<o;r++)this.dispatchEvent(new hn(Bt.ADDFEATURE,n[r]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Bt.ADDFEATURE,function(n){t||(t=!0,e.push(n.feature),t=!1)}),this.addEventListener(Bt.REMOVEFEATURE,function(n){t||(t=!0,e.remove(n.feature),t=!1)}),e.addEventListener(It.ADD,n=>{t||(t=!0,this.addFeature(n.element),t=!1)}),e.addEventListener(It.REMOVE,n=>{t||(t=!0,this.removeFeature(n.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(Ne);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(n=>{this.removeFeatureInternal(n)});for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new hn(Bt.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const n=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(n,function(s){const r=s.getGeometry();if(r instanceof Lt||r.intersectsCoordinate(e))return t(s)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(n){const s=n.getGeometry();if(s instanceof Lt||s.intersectsExtent(e)){const r=t(n);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),es(this.nullGeometryFeatures_)||ri(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(n){t.push(n)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const s=Sm(e,t);return[].concat(...s.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const n=e[0],s=e[1];let r=null;const o=[NaN,NaN];let l=1/0;const a=[-1/0,-1/0,1/0,1/0];return t=t||jr,this.featuresRtree_.forEachInExtent(a,function(h){if(t(h)){const c=h.getGeometry(),u=l;if(l=c instanceof Lt?0:c.closestPointXY(n,s,o,l),l<u){r=h;const d=Math.sqrt(l);a[0]=n-d,a[1]=s-d,a[2]=n+d,a[3]=s+d}}}),r}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,n=de(t),s=t.getGeometry();if(!s)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[n]=t);else{const o=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const r=t.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[n]=t;this.changed(),this.dispatchEvent(new hn(Bt.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:de(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&es(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,n){const s=this.loadedExtentsRtree_,r=this.strategy_(e,t,n);for(let o=0,l=r.length;o<l;++o){const a=r[o];s.forEachInExtent(a,function(c){return yi(c.extent,a)})||(++this.loadingExtentsCount_,this.dispatchEvent(new hn(Bt.FEATURESLOADSTART)),this.loader_.call(this,a,t,n,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new hn(Bt.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new hn(Bt.FEATURESLOADERROR))}),s.insert(a,{extent:a.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,n=t.forEachInExtent(e,function(s){if(ns(s.extent,e))return s});n&&t.remove(n)}removeFeatures(e){let t=!1;for(let n=0,s=e.length;n<s;++n)t=this.removeFeatureInternal(e[n])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=de(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Ne),delete this.featureChangeKeys_[t];const s=e.getId();if(s!==void 0){const r=s.toString(),o=this.idIndex_[r];o===e?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Bt.REMOVEFEATURE)&&this.dispatchEvent(new hn(Bt.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){we(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(Sf(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class yu extends eo{constructor(e){e=e||{},super({attributions:e.attributions,wrapX:e.wrapX}),this.resolution=void 0,this.distance=e.distance!==void 0?e.distance:20,this.minDistance=e.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=e.geometryFunction||function(t){const n=t.getGeometry();return we(!n||n.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),n},this.createCustomCluster_=e.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(e.source||null)}clear(e){this.features.length=0,super.clear(e)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(e,t,n){this.source?.loadFeatures(e,t,n),t!==this.resolution&&(this.resolution=t,this.refresh())}setDistance(e){this.updateDistance(e,this.minDistance)}setMinDistance(e){this.updateDistance(this.distance,e)}getMinDistance(){return this.minDistance}setSource(e){this.source&&this.source.removeEventListener(le.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(le.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(e,t){const n=e===0?0:Math.min(t,e)/e,s=e!==this.distance||this.interpolationRatio!==n;this.distance=e,this.minDistance=t,this.interpolationRatio=n,s&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const e=wt(),t=this.distance*this.resolution,n=this.source.getFeatures(),s={};for(let r=0,o=n.length;r<o;r++){const l=n[r];if(!(de(l)in s)){const a=this.geometryFunction(l);if(a){const h=a.getCoordinates();Ih(h,e),oi(e,t,e);const c=this.source.getFeaturesInExtent(e).filter(function(u){const d=de(u);return d in s?!1:(s[d]=!0,!0)});this.features.push(this.createCluster(c,e))}}}}createCluster(e,t){const n=[0,0];for(let l=e.length-1;l>=0;--l){const a=this.geometryFunction(e[l]);a?Im(n,a.getCoordinates()):e.splice(l,1)}bm(n,1/e.length);const s=$t(t),r=this.interpolationRatio,o=new Ii([n[0]*(1-r)+s[0]*r,n[1]*(1-r)+s[1]*r]);return this.createCustomCluster_?this.createCustomCluster_(o,e):new yo({geometry:o,features:e})}}function qc(i){return Array.isArray(i)?Math.min(...i):i}class sR extends au{constructor(e,t,n,s,r,o,l){let a=e.getExtent();a&&e.canWrapX()&&(a=a.slice(),a[0]=-1/0,a[2]=1/0);let h=t.getExtent();h&&t.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const c=h?li(n,h):n,u=$t(c),d=Qr(e,t,u,s),f=S_,g=new T_(e,t,c,a,d*f,s),m=g.calculateSourceExtent(),_=ls(m)?null:o(m,d,r),p=_?te.IDLE:te.EMPTY,y=_?_.getPixelRatio():1;super(n,s,y,p),this.targetProj_=t,this.maxSourceExtent_=a,this.triangulation_=g,this.targetResolution_=s,this.targetExtent_=n,this.sourceImage_=_,this.sourcePixelRatio_=y,this.interpolate_=l,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==te.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==te.LOADED){const t=ve(this.targetExtent_)/this.targetResolution_,n=Ye(this.targetExtent_)/this.targetResolution_;this.canvas_=R_(t,n,this.sourcePixelRatio_,qc(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==te.IDLE){this.state=te.LOADING,this.changed();const e=this.sourceImage_.getState();e==te.LOADED||e==te.ERROR?this.reproject_():(this.sourceListenerKey_=Ee(this.sourceImage_,le.CHANGE,t=>{const n=this.sourceImage_.getState();(n==te.LOADED||n==te.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Ne(this.sourceListenerKey_),this.sourceListenerKey_=null}}const xn=4,lc={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class rR extends bi{constructor(e,t){super(e),this.image=t}}class K_ extends mu{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const n=Xl(t,e,0);e=t[n]}return e}getImage(e,t,n,s){const r=this.getProjection();if(!r||!s||vt(r,s))return r&&(s=r),this.getImageInternal(e,t,n,s);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&vt(this.reprojectedImage_.getProjection(),s)&&this.reprojectedImage_.getResolution()==t&&ns(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new sR(r,s,e,t,n,(o,l,a)=>this.getImageInternal(o,l,a,r),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,n,s){if(this.loader){const r=H_(e,t,n,1),o=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===s&&(this.wantedExtent_&&yi(this.wantedExtent_,r)||yi(this.image.getExtent(),r))&&(this.wantedResolution_&&qc(this.wantedResolution_)===o||qc(this.image.getResolution())===o)))return this.image;this.wantedProjection_=s,this.wantedExtent_=r,this.wantedResolution_=o,this.image=new au(r,o,n,this.loader),this.image.addEventListener(le.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let n;switch(t.getState()){case te.LOADING:this.loading=!0,n=lc.IMAGELOADSTART;break;case te.LOADED:this.loading=!1,n=lc.IMAGELOADEND;break;case te.ERROR:this.loading=!1,n=lc.IMAGELOADERROR;break;default:return}this.hasListener(n)&&this.dispatchEvent(new rR(n,t))}}function X_(i,e){i.getImage().src=e}function H_(i,e,t,n){const s=e/t,r=$t(i),o=pn(ve(i)/s,xn),l=pn(Ye(i)/s,xn),a=pn((n-1)*o/2,xn),h=o+2*a,c=pn((n-1)*l/2,xn),u=l+2*c;return Br(r,s,0,[h,u])}function oR(i){const e=i.load||ra,t=i.imageExtent,n=i.crossOrigin??null;return()=>{const s=new Image;return s.crossOrigin=n,e(s,i.url).then(r=>{const o=ve(t)/r.width,l=Ye(t)/r.height;return{image:r,extent:t,resolution:o!==l?[o,l]:l,pixelRatio:1}})}}class lR extends K_{constructor(e){const t=e.crossOrigin!==void 0?e.crossOrigin:null,n=e.imageLoadFunction!==void 0?e.imageLoadFunction:X_;super({attributions:e.attributions,interpolate:e.interpolate,projection:Oe(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image=null,this.image=new au(this.imageExtent_,void 0,1,oR({url:e.url,imageExtent:e.imageExtent,crossOrigin:t,load:(s,r)=>(this.image.setImage(s),n(this.image,r),ra(s))})),this.image.addEventListener(le.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(e,t,n,s){return Ke(e,this.image.getExtent())?this.image:null}getUrl(){return this.url_}}const Il="1.3.0",Af=[101,101];function Y_(i,e,t,n,s){s.WIDTH=t[0],s.HEIGHT=t[1];const r=n.getAxisOrientation(),o=Ah(s.VERSION,"1.3")>=0;s[o?"CRS":"SRS"]=n.getCode();const l=o&&r.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return s.BBOX=l.join(","),gu(i,s)}function Z_(i,e,t,n,s,r,o){r=Object.assign({REQUEST:"GetMap"},r);const l=e/t,a=[Ad(ve(i)/l,xn),Ad(Ye(i)/l,xn)];if(t!=1)switch(o){case"geoserver":const c=90*t+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+c:r.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":r.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":r.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return Y_(s,i,a,n,r)}function bl(i,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Il,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},i)}function aR(i){const e=i.hidpi===void 0?!0:i.hidpi,t=Oe(i.projection||"EPSG:3857"),n=i.ratio||1.5,s=i.load||ra,r=i.crossOrigin??null;return(o,l,a)=>{o=H_(o,l,a,n),a!=1&&(!e||i.serverType===void 0)&&(a=1);const h=Z_(o,l,a,t,i.url,bl(i.params,"GetMap"),i.serverType),c=new Image;return c.crossOrigin=r,s(c,h).then(u=>({image:u,extent:o,pixelRatio:a}))}}function cR(i,e,t){if(i.url===void 0)return;const n=Oe(i.projection||"EPSG:3857"),s=Br(e,t,0,Af),r={QUERY_LAYERS:i.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(r,bl(i.params,"GetFeatureInfo"),i.params);const o=Ts((e[0]-s[0])/t,xn),l=Ts((s[3]-e[1])/t,xn),a=Ah(r.VERSION,"1.3")>=0;return r[a?"I":"X"]=o,r[a?"J":"Y"]=l,Y_(i.url,s,Af,n,r)}function hR(i,e){if(i.url===void 0)return;const t={SERVICE:"WMS",VERSION:Il,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e!==void 0){const n=Oe(i.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;t.SCALE=e*n/s}if(Object.assign(t,i.params),i.params!==void 0&&t.LAYER===void 0){const n=t.LAYERS;if(!(!Array.isArray(n)||n.length!==1))return;t.LAYER=n}return gu(i.url,t)}class uR extends K_{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:X_,this.params_=Object.assign({},e.params),this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,t,n,s){const r=Oe(n),o=this.getProjection();o&&o!==r&&(t=Qr(o,r,e,t),e=qs(e,r,o));const l={url:this.url_,params:{...this.params_,...s},projection:o||r};return cR(l,e,t)}getLegendUrl(e,t){return hR({url:this.url_,params:{...this.params_,...t}},e)}getParams(){return this.params_}getImageInternal(e,t,n,s){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==s)&&(this.loaderProjection_=s,this.loader=aR({crossOrigin:this.crossOrigin_,params:this.params_,projection:s,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(r,o)=>(this.image.setImage(r),this.imageLoadFunction_(this.image,o),ra(r))})),super.getImageInternal(e,t,n,s))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const Lf=[];class dR extends _o{constructor(e,t,n,s,r){super(e,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=s.bind(void 0,this),this.removeSourceTiles_=r,this.wrappedTileCoord=n}getContext(){return this.context_||(this.context_=qe(1,1,Lf)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){const t=de(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&(uo(this.context_),Lf.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}let fR=class extends _o{constructor(e,t,n,s,r,o){super(e,t,o),this.extent=null,this.format_=s,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=r,this.url_=n,this.key=n}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==$.IDLE&&(this.setState($.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState($.ERROR)}setFeatures(e){this.features_=e,this.setState($.LOADED)}setLoader(e){this.loader_=e}};class gR extends ga{constructor(e){const t=e.projection||"EPSG:3857",n=e.extent||fa(t),s=e.tileGrid||L_({extent:n,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:t,state:e.state,tileGrid:s,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:mR,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:fR,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,t,n){if(n.getState()===$.IDLE){n.setState($.LOADING);const s=n.wrappedTileCoord,r=this.getTileGridForProjection(t);let o=r.getTileCoordExtent(s);const l=s[0],a=r.getResolution(l);oi(o,-a,o);const h=this.projection;t&&this.projection&&!vt(t,h)&&(o=Lr(o,t,h));const c=this.tileGrid,u=c.getExtent();u&&li(o,u,o);let d=a;t&&h&&!vt(t,h)&&(d=a/h.getMetersPerUnit()/t.getMetersPerUnit());const f=c.getZForResolution(d,this.zDirection);c.forEachTileCoord(o,f,g=>{const m=this.tileUrlFunction(g,e,t);this.sourceTiles_[m]||(this.sourceTiles_[m]=new this.tileClass(g,m?$.IDLE:$.EMPTY,m,this.format_,this.tileLoadFunction));const _=this.sourceTiles_[m];n.sourceTiles.push(_),this.tileKeysBySourceTileUrl_[m]||(this.tileKeysBySourceTileUrl_[m]=[]),this.tileKeysBySourceTileUrl_[m].push(n.getKey());const p=_.getState();if(p<$.LOADED){const y=v=>{this.handleTileChange(v);const C=_.getState();if(C===$.LOADED||C===$.ERROR){const x=_.getKey();x in n.errorTileKeys?_.getState()===$.LOADED&&delete n.errorTileKeys[x]:n.loadingSourceTiles--,C===$.ERROR?n.errorTileKeys[x]=!0:_.removeEventListener(le.CHANGE,y),n.loadingSourceTiles===0&&n.setState(es(n.errorTileKeys)?$.LOADED:$.ERROR)}};_.addEventListener(le.CHANGE,y),n.loadingSourceTiles++}p===$.IDLE&&(_.extent=c.getTileCoordExtent(g),_.projection=this.projection,_.resolution=c.getResolution(g[0]),_.load())}),n.loadingSourceTiles||n.setState(n.sourceTiles.some(g=>g.getState()===$.ERROR)?$.ERROR:$.LOADED)}return n.sourceTiles}removeSourceTiles(e){const t=e.getKey(),n=e.sourceTiles;for(let s=0,r=n.length;s<r;++s){const o=n[s].getTileUrl();if(!this.tileKeysBySourceTileUrl_[o])return;const l=this.tileKeysBySourceTileUrl_[o].indexOf(t);l!==-1&&(this.tileKeysBySourceTileUrl_[o].splice(l,1),this.tileKeysBySourceTileUrl_[o].length===0&&(delete this.tileKeysBySourceTileUrl_[o],delete this.sourceTiles_[o]))}}getTile(e,t,n,s,r){const o=[e,t,n];let l=this.getTileCoordForTileUrlFunction(o,r);const a=this.getTileGrid().getExtent(),h=this.projection,c=this.getTileGridForProjection(r);if(l&&a){const f=c.getTileCoordExtent(l);oi(f,-c.getResolution(e),f),Ke(a,!r||!h||vt(r,h)?f:Lr(f,r,h))||(l=null)}let u=!0;if(l!==null){const f=this.tileGrid,g=c.getResolution(e);let m=g;r&&h&&!vt(r,h)&&(m=g/h.getMetersPerUnit()/r.getMetersPerUnit());const _=f.getZForResolution(m,1),p=c.getTileCoordExtent(l);oi(p,-g,p),f.forEachTileCoord(!r||!h||vt(r,h)?p:Lr(p,r,h),_,y=>{u=u&&!this.tileUrlFunction(y,s,h)})}const d=new dR(o,u?$.EMPTY:$.IDLE,l,this.getSourceTiles.bind(this,s,r),this.removeSourceTiles.bind(this));return d.key=this.getKey(),d}getTileGridForProjection(e){const t=e.getCode();let n=this.tileGrids_[t];if(!n){const s=this.projection;if(s!==null&&!vt(s,e))return da(e);const r=this.tileGrid,o=r.getResolutions().slice(),l=o.map(function(c,u){return r.getOrigin(u)}),a=o.map(function(c,u){return r.getTileSize(u)}),h=$m+1;for(let c=o.length;c<h;++c)o.push(o[c-1]/2),l.push(l[c-1]),a.push(a[c-1]);n=new fu({extent:r.getExtent(),origins:l,resolutions:o,tileSizes:a}),this.tileGrids_[t]=n}return n}getTilePixelRatio(e){return e}getTilePixelSize(e,t,n){const s=this.getTileGridForProjection(n),r=gt(s.getTileSize(e),this.tmpSize);return[Math.round(r[0]*t),Math.round(r[1]*t)]}setOverlaps(e){this.overlaps_=e,this.changed()}}function mR(i,e){i.setLoader(function(t,n,s){W_(e,i.getFormat(),t,n,s,i.onLoad.bind(i),i.onError.bind(i))})}class _R extends du{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],n=e.pixelRatio,s=e.viewState,r=s.resolution,o=this.getLayer().getSource(),l=e.viewHints;let a=e.extent;if(t.extent!==void 0&&(a=li(a,Ci(t.extent,s.projection))),!l[je.ANIMATING]&&!l[je.INTERACTING]&&!ls(a))if(o){const h=s.projection,c=o.getImage(a,r,n,h);c&&(this.loadImage(c)?this.image=c:c.getState()===te.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const n=this.getLayer(),s=$e(t.pixelToCoordinateTransform,e.slice()),r=n.getExtent();if(r&&!is(r,s))return null;const o=this.image.getExtent(),l=this.image.getImage(),a=ve(o),h=Math.floor(l.width*((s[0]-o[0])/a));if(h<0||h>=l.width)return null;const c=Ye(o),u=Math.floor(l.height*((o[3]-s[1])/c));return u<0||u>=l.height?null:this.getImageData(l,h,u)}renderFrame(e,t){const n=this.image,s=n.getExtent(),r=n.getResolution(),[o,l]=Array.isArray(r)?r:[r,r],a=n.getPixelRatio(),h=e.layerStatesArray[e.layerIndex],c=e.pixelRatio,u=e.viewState,d=u.center,f=u.resolution,g=c*o/(f*a),m=c*l/(f*a);this.prepareContainer(e,t);const _=this.context.canvas.width,p=this.context.canvas.height,y=this.getRenderContext(e);let v=!1,C=!0;if(h.extent){const b=Ci(h.extent,u.projection);C=Ke(b,e.extent),v=C&&!yi(b,e.extent),v&&this.clipUnrotated(y,e,b)}const x=n.getImage(),T=Si(this.tempTransform,_/2,p/2,g,m,0,a*(s[0]-d[0])/o,a*(d[1]-s[3])/l);this.renderedResolution=l*c/a;const I=x.width*T[0],L=x.height*T[3];if(this.getLayer().getSource().getInterpolate()||(y.imageSmoothingEnabled=!1),this.preRender(y,e),C&&I>=.5&&L>=.5){const b=T[4],G=T[5],W=h.opacity;W!==1&&(y.save(),y.globalAlpha=W),y.drawImage(x,0,0,+x.width,+x.height,b,G,I,L),W!==1&&y.restore()}return this.postRender(this.context,e),v&&y.restore(),y.imageSmoothingEnabled=!0,this.container}}class pR extends Js{constructor(e){e=e||{},super(e)}}class yR extends pR{constructor(e){super(e)}createRenderer(){return new _R(this)}getData(e){return super.getData(e)}}class CR extends _u{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=wt(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,n,s){const r=Oe(n),o=this.getProjection()||r;let l=this.getTileGrid();l||(l=this.getTileGridForProjection(o));const a=qs(e,r,o),h=Qr(o,r,e,t),c=l.getZForResolution(h,this.zDirection),u=l.getResolution(c),d=l.getTileCoordForCoordAndZ(a,c);if(l.getResolutions().length<=d[0])return;let f=l.getTileCoordExtent(d,this.tmpExtent_);const g=this.gutter_;g!==0&&(f=oi(f,u*g,f));const m={QUERY_LAYERS:this.params_.LAYERS};Object.assign(m,bl(this.params_,"GetFeatureInfo"),s);const _=Math.floor((a[0]-f[0])/u),p=Math.floor((f[3]-a[1])/u);return m[this.v13_?"I":"X"]=_,m[this.v13_?"J":"Y"]=p,this.getRequestUrl_(d,f,1,o||r,m)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const n={SERVICE:"WMS",VERSION:Il,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const s=this.params_.LAYERS;if(!(!Array.isArray(s)||s.length===1))return;n.LAYER=s}if(e!==void 0){const s=this.getProjection()?this.getProjection().getMetersPerUnit():1,r=28e-5;n.SCALE=e*s/r}return Object.assign(n,t),gu(this.urls[0],n)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,n,s,r){const o=this.urls;if(!o)return;let l;if(o.length==1)l=o[0];else{const a=Jn(b_(e),o.length);l=o[a]}return Z_(t,(this.tileGrid||this.getTileGridForProjection(s)).getResolution(e[0]),n,s,l,r,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const n in this.params_)t[e++]=n+"-"+this.params_[n];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||Il;this.v13_=Ah(e,"1.3")>=0}tileUrlFunction(e,t,n){let s=this.getTileGrid();if(s||(s=this.getTileGridForProjection(n)),s.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const r=s.getResolution(e[0]);let o=s.getTileCoordExtent(e,this.tmpExtent_);const l=this.gutter_;l!==0&&(o=oi(o,r*l,o));const a=Object.assign({},bl(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,n,a)}}const ac=[{title:"-6",date:"2026-01-23T00:00:00.000Z",location:{address:"",lng:116.3,lat:39.3},tags:["demo","markdown"],id:"hello-world",filename:"hello-world.md",toc:[{level:1,title:"Hello World",id:"hello-world"},{level:2,title:"Introduction",id:"introduction"},{level:2,title:"Features",id:"features"},{level:3,title:"Sub-feature",id:"sub-feature"}],excerpt:"This is a sample post."},{title:"-9",date:"2026-01-22T00:00:00.000Z",location:{address:"",lng:116.9,lat:39.9},tags:["vue","javascript","frontend"],id:"vue3-features",filename:"vue3-features.md",toc:[{level:1,title:" Vue 3 ",id:"-vue-3-"},{level:2,title:"Composition API",id:"composition-api"},{level:3,title:"setup() ",id:"setup-"},{level:3,title:"script setup",id:"script-setup"},{level:2,title:"Teleport",id:"teleport"},{level:2,title:"Fragments",id:"fragments"},{level:2,title:"",id:""},{level:2,title:"",id:""}],excerpt:"Vue 3  Composition API"},{title:"-2",date:"2026-01-20T00:00:00.000Z",location:{address:"",lng:116.1,lat:39.1},tags:["cesium","webgl","3d"],id:"cesium-guide",filename:"cesium-guide.md",toc:[{level:1,title:"Cesium ",id:"cesium-"},{level:2,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"Viewer",id:"viewer"},{level:3,title:"Entity API",id:"entity-api"},{level:2,title:"",id:""},{level:3,title:"flyTo",id:"flyto"},{level:3,title:"setView",id:"setview"},{level:2,title:"",id:""},{level:2,title:"",id:""}],excerpt:"CesiumJS  JavaScript  3D "},{title:"-5",date:"2026-01-18T00:00:00.000Z",location:{address:"",lng:121.47,lat:31.23},tags:["performance","frontend","optimization"],id:"frontend-performance",filename:"frontend-performance.md",toc:[{level:1,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"CDN ",id:"cdn-"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:" requestAnimationFrame",id:"-requestanimationframe"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:" WeakMap  WeakSet",id:"-weakmap--weakset"},{level:2,title:"",id:""},{level:3,title:" Performance API",id:"-performance-api"},{level:3,title:"Lighthouse ",id:"lighthouse-"},{level:2,title:"",id:""}],excerpt:""},{title:"-8",date:"2026-01-17T00:00:00.000Z",location:{address:"",lng:114.05,lat:22.52},tags:["typescript","javascript","programming"],id:"typescript-guide",filename:"typescript-guide.md",toc:[{level:1,title:"TypeScript ",id:"typescript-"},{level:2,title:" TypeScript",id:"-typescript"},{level:3,title:"",id:""},{level:3,title:" IDE ",id:"-ide-"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"Partial",id:"partial"},{level:3,title:"Pick",id:"pick"},{level:3,title:"Omit",id:"omit"},{level:2,title:"",id:""},{level:3,title:"tsconfig.json",id:"tsconfigjson"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2.  any",id:"2--any"},{level:3,title:"3. ",id:"3-"},{level:3,title:"4.  readonly ",id:"4--readonly-"},{level:2,title:"",id:""}],excerpt:"TypeScript  JavaScript  JavaScript  TypeScript"},{title:"-10",date:"2026-01-16T00:00:00.000Z",location:{address:"",lng:120.15,lat:30.28},tags:["webassembly","rust","performance"],id:"webassembly-guide",filename:"webassembly-guide.md",toc:[{level:1,title:"WebAssembly ",id:"webassembly-"},{level:2,title:" WebAssembly",id:"-webassembly"},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:" Rust ",id:"-rust-"},{level:3,title:" Wasm ",id:"-wasm-"},{level:3,title:" Cargo.toml",id:"-cargotoml"},{level:3,title:" Rust ",id:"-rust-"},{level:3,title:" Wasm",id:"-wasm"},{level:2,title:" JavaScript  Wasm",id:"-javascript--wasm"},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"JavaScript vs WebAssembly",id:"javascript-vs-webassembly"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3. ",id:"3-"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3.  SIMD ",id:"3--simd-"},{level:2,title:"",id:""},{level:3,title:"1.  console.log",id:"1--consolelog"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3. ",id:"3-"},{level:2,title:"",id:""},{level:3,title:"1.  Wasm",id:"1--wasm"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3. ",id:"3-"},{level:2,title:"",id:""}],excerpt:"WebAssembly Wasm Web  Web "},{title:"-1",date:"2026-01-16T00:00:00.000Z",location:{address:"",lng:127.15,lat:32.28},tags:["webassembly","rust","performance"],id:"",filename:".md",toc:[{level:1,title:"",id:""},{level:2,title:"",id:""},{level:1,title:"",id:""},{level:1,title:"",id:""}],excerpt:"	..."},{title:"-4",date:"2026-01-15T00:00:00.000Z",location:{address:"",lng:116.2,lat:39.2},tags:["life","cyberpunk","thoughts"],id:"cyberpunk-thoughts",filename:"cyberpunk-thoughts.md",toc:[{level:1,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:2,title:"",id:""},{level:2,title:"",id:""}],excerpt:"2049"},{title:"-7",date:"2026-01-14T00:00:00.000Z",location:{address:"",lng:113.26,lat:23.13},tags:["nodejs","backend","best-practices"],id:"nodejs-best-practices",filename:"nodejs-best-practices.md",toc:[{level:1,title:"Node.js ",id:"nodejs-"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"1.  Helmet",id:"1--helmet"},{level:3,title:"2. CORS ",id:"2-cors-"},{level:3,title:"3. ",id:"3-"},{level:3,title:"4. ",id:"4-"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3. ",id:"3-"},{level:3,title:"4. ",id:"4-"},{level:2,title:"",id:""},{level:3,title:" Winston",id:"-winston"},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"1.  PM2",id:"1--pm2"},{level:3,title:"2. Docker ",id:"2-docker-"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""}],excerpt:"Node.js  Chrome V8  JavaScript  JavaScript  Node.js "},{title:"-3",date:"2026-01-13T00:00:00.000Z",location:{address:"",lng:104.06,lat:30.67},tags:["css","layout","frontend"],id:"css-grid-guide",filename:"css-grid-guide.md",toc:[{level:1,title:"CSS Grid ",id:"css-grid-"},{level:2,title:" CSS Grid",id:"-css-grid"},{level:3,title:"Grid vs Flexbox",id:"grid-vs-flexbox"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:"",id:""},{level:2,title:"",id:""},{level:3,title:"grid-template-columns  grid-template-rows",id:"grid-template-columns--grid-template-rows"},{level:3,title:" fr ",id:"-fr-"},{level:3,title:"repeat() ",id:"repeat-"},{level:3,title:"auto-fill  auto-fit",id:"auto-fill--auto-fit"},{level:2,title:"",id:""},{level:3,title:"gap ",id:"gap-"},{level:2,title:"",id:""},{level:3,title:"grid-column  grid-row",id:"grid-column--grid-row"},{level:3,title:"grid-area",id:"grid-area"},{level:2,title:"",id:""},{level:3,title:"justify-items  align-items",id:"justify-items--align-items"},{level:3,title:"justify-content  align-content",id:"justify-content--align-content"},{level:3,title:"place-items  place-content",id:"place-items--place-content"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3. ",id:"3-"},{level:3,title:"4. ",id:"4-"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2. minmax() ",id:"2-minmax-"},{level:3,title:"3. Subgrid",id:"3-subgrid"},{level:3,title:"4. ",id:"4-"},{level:2,title:"",id:""},{level:3,title:"",id:""},{level:3,title:" auto-fit",id:"-auto-fit"},{level:2,title:"",id:""},{level:3,title:"1.  @supports",id:"1--supports"},{level:3,title:"2. ",id:"2-"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2.  will-change",id:"2--will-change"},{level:3,title:"3. ",id:"3-"},{level:2,title:"",id:""},{level:3,title:"1. ",id:"1-"},{level:3,title:"2. ",id:"2-"},{level:3,title:"3. ",id:"3-"},{level:2,title:"",id:""},{level:3,title:"1.  HTML",id:"1--html"},{level:3,title:"2.  CSS ",id:"2--css-"},{level:3,title:"3. ",id:"3-"},{level:2,title:"",id:""}],excerpt:"CSS Grid  CSS Grid"}],No="data:image/svg+xml,%3csvg%20t='1769265490681'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='4195'%20width='50'%20height='50'%3e%3cpath%20d='M788.551%20292.895c-74.801%200-135.633-60.832-135.633-135.605v-156.171h-487.636c-45.595%200-82.548%2036.982-82.548%2082.549v856.719c0%2045.567%2036.955%2082.493%2082.548%2082.493h693.46c45.571%200%2082.523-36.926%2082.523-82.493v-647.493h-152.714zM805.084%20839.116h-586.199v-55.301h586.199v55.301zM805.084%20662.15h-586.199v-55.301h586.199v55.301zM805.084%20485.184h-586.199v-55.301h586.199v55.301z'%20fill='%23E0F2F1'%20p-id='4196'%3e%3c/path%3e%3cpath%20d='M706.002%201.119v156.171c0%2045.567%2036.955%2082.493%2082.549%2082.493h152.714l-235.263-238.662z'%20fill='%23E0F2F1'%20p-id='4197'%3e%3c/path%3e%3c/svg%3e";let Go,$_;function Jc(){if(Go===void 0){const i=document.createElement("canvas");i.setAttribute("style","image-rendering: -moz-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;");const e=i.style.imageRendering;Go=!!e,Go&&($_=e)}return Go}function vR(){return Jc(),$_||""}function qo(i){return i.get("olcs_projection")||i.getProjection()}let ER=0;function et(i){return i.olcs_uid||(i.olcs_uid=++ER)}function cc(i){const e=i,t=e.readyPromise;return t||(e.ready!==void 0?e.ready?Promise.resolve(i):new Promise((n,s)=>{const r=setInterval(()=>{e.ready&&(clearInterval(r),n(i))},20)}):Promise.reject("Not a readyable object"))}function q_(){const i=document.createElement("canvas");return i.width=1,i.height=1,i}class xR{source_;projection_;fallbackProj_;map_;shouldRequestNextLevel;emptyCanvas_=q_();emptyCanvasPromise_=Promise.resolve(this.emptyCanvas_);tilingScheme_;ready_;rectangle_;get ready(){return this.ready_}get rectangle(){return this.rectangle_}get tilingScheme(){return this.tilingScheme_}errorEvent=new Cesium.Event;credit;proxy;get _ready(){return this.ready_}get tileWidth(){const e=this.source_.getTileGrid();if(e){const t=e.getTileSize(0);return Array.isArray(t)?t[0]:t}return 256}get tileHeight(){const e=this.source_.getTileGrid();if(e){const t=e.getTileSize(0);return Array.isArray(t)?t[1]:t}return 256}get maximumLevel(){const e=this.source_.getTileGrid();return e?e.getMaxZoom():18}get minimumLevel(){return 0}get tileDiscardPolicy(){}get hasAlphaChannel(){return!0}pickFeatures(e,t,n,s,r){}constructor(e,t,n){this.source_=t,this.projection_=null,this.ready_=!1,this.fallbackProj_=n||null,this.tilingScheme_=new Cesium.WebMercatorTilingScheme,this.rectangle_=null,this.map_=e,this.shouldRequestNextLevel=!1;const s=this.source_.get("olcs_proxy");s&&(typeof s=="function"?this.proxy={getURL:s}:typeof s=="string"&&(this.proxy=new Cesium.DefaultProxy(s))),this.source_.on("change",r=>{this.handleSourceChanged_()}),this.handleSourceChanged_()}handleSourceChanged_(){if(!this.ready_&&this.source_.getState()=="ready"){this.projection_=qo(this.source_)||this.fallbackProj_;const e={numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1};if(this.source_.getTileGrid()!==null&&this.source_.getTileGrid().forEachTileCoord(this.projection_.getExtent(),0,([t,n,s])=>{e.numberOfLevelZeroTilesX=n+1,e.numberOfLevelZeroTilesY=s+1}),this.projection_.getCode()==="EPSG:4326")this.shouldRequestNextLevel=e.numberOfLevelZeroTilesX===1&&e.numberOfLevelZeroTilesY===1,this.tilingScheme_=new Cesium.GeographicTilingScheme(e);else if(this.projection_.getCode()==="EPSG:3857")this.shouldRequestNextLevel=!1,this.tilingScheme_=new Cesium.WebMercatorTilingScheme(e);else return;this.rectangle_=this.tilingScheme_.rectangle,this.ready_=!0}}getTileCredits(e,t,n){const s=this.source_.getAttributions();if(!s)return[];const r=this.map_.getView().calculateExtent(this.map_.getSize()),o=this.map_.getView().getCenter(),l=this.shouldRequestNextLevel?n+1:n;return Q_(s,l,o,r)}requestImage(e,t,n,s){const r=this.source_.getTileUrlFunction();if(r&&this.projection_){const o=this.shouldRequestNextLevel?n+1:n;let l=r.call(this.source_,[o,e,t],1,this.projection_);return this.proxy&&(l=this.proxy.getURL(l)),l?Cesium.ImageryProvider.loadImage(this,l):this.emptyCanvasPromise_}else return this.emptyCanvasPromise_}}const Qc=65536*65536,Pf=1/Qc,wR=12,Mf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),hc=0,Vo=1,fr=2,jo=5;class RR{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,n=this.length){for(;this.pos<n;){const s=this.readVarint(),r=s>>3,o=this.pos;this.type=s&7,e(r,t,this),this.pos===o&&this.skip(s)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Qc;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Qc;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let n,s;return s=t[this.pos++],n=s&127,s<128||(s=t[this.pos++],n|=(s&127)<<7,s<128)||(s=t[this.pos++],n|=(s&127)<<14,s<128)||(s=t[this.pos++],n|=(s&127)<<21,s<128)?n:(s=t[this.pos],n|=(s&15)<<28,TR(n,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=wR&&Mf?Mf.decode(this.buf.subarray(t,e)):GR(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===fr?this.readVarint()+this.pos:this.pos+1}skip(e){const t=e&7;if(t===hc)for(;this.buf[this.pos++]>127;);else if(t===fr)this.pos=this.readVarint()+this.pos;else if(t===jo)this.pos+=4;else if(t===Vo)this.pos+=8;else throw new Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.dataView=new DataView(n.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Pf),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Pf),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){SR(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const t=this.pos;this.pos=VR(this.buf,e,this.pos);const n=this.pos-t;n>=128&&Of(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let n=0;n<t;n++)this.buf[this.pos++]=e[n]}writeRawMessage(e,t){this.pos++;const n=this.pos;e(t,this);const s=this.pos-n;s>=128&&Of(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s}writeMessage(e,t,n){this.writeTag(e,fr),this.writeRawMessage(t,n)}writePackedVarint(e,t){t.length&&this.writeMessage(e,AR,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,LR,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,OR,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,PR,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,MR,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,FR,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,DR,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,kR,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,NR,t)}writeBytesField(e,t){this.writeTag(e,fr),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,jo),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,jo),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,Vo),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,Vo),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,hc),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,hc),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,fr),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,jo),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,Vo),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function TR(i,e,t){const n=t.buf;let s,r;if(r=n[t.pos++],s=(r&112)>>4,r<128||(r=n[t.pos++],s|=(r&127)<<3,r<128)||(r=n[t.pos++],s|=(r&127)<<10,r<128)||(r=n[t.pos++],s|=(r&127)<<17,r<128)||(r=n[t.pos++],s|=(r&127)<<24,r<128)||(r=n[t.pos++],s|=(r&1)<<31,r<128))return ps(i,s,e);throw new Error("Expected varint not more than 10 bytes")}function ps(i,e,t){return t?e*4294967296+(i>>>0):(e>>>0)*4294967296+(i>>>0)}function SR(i,e){let t,n;if(i>=0?(t=i%4294967296|0,n=i/4294967296|0):(t=~(-i%4294967296),n=~(-i/4294967296),t^4294967295?t=t+1|0:(t=0,n=n+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),IR(t,n,e),bR(n,e)}function IR(i,e,t){t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos]=i&127}function bR(i,e){const t=(i&7)<<4;e.buf[e.pos++]|=t|((i>>>=3)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127)))))}function Of(i,e,t){const n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(n);for(let s=t.pos-1;s>=i;s--)t.buf[s+n]=t.buf[s]}function AR(i,e){for(let t=0;t<i.length;t++)e.writeVarint(i[t])}function LR(i,e){for(let t=0;t<i.length;t++)e.writeSVarint(i[t])}function PR(i,e){for(let t=0;t<i.length;t++)e.writeFloat(i[t])}function MR(i,e){for(let t=0;t<i.length;t++)e.writeDouble(i[t])}function OR(i,e){for(let t=0;t<i.length;t++)e.writeBoolean(i[t])}function FR(i,e){for(let t=0;t<i.length;t++)e.writeFixed32(i[t])}function DR(i,e){for(let t=0;t<i.length;t++)e.writeSFixed32(i[t])}function kR(i,e){for(let t=0;t<i.length;t++)e.writeFixed64(i[t])}function NR(i,e){for(let t=0;t<i.length;t++)e.writeSFixed64(i[t])}function GR(i,e,t){let n="",s=e;for(;s<t;){const r=i[s];let o=null,l=r>239?4:r>223?3:r>191?2:1;if(s+l>t)break;let a,h,c;l===1?r<128&&(o=r):l===2?(a=i[s+1],(a&192)===128&&(o=(r&31)<<6|a&63,o<=127&&(o=null))):l===3?(a=i[s+1],h=i[s+2],(a&192)===128&&(h&192)===128&&(o=(r&15)<<12|(a&63)<<6|h&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):l===4&&(a=i[s+1],h=i[s+2],c=i[s+3],(a&192)===128&&(h&192)===128&&(c&192)===128&&(o=(r&15)<<18|(a&63)<<12|(h&63)<<6|c&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,l=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),s+=l}return n}function VR(i,e,t){for(let n=0,s,r;n<e.length;n++){if(s=e.charCodeAt(n),s>55295&&s<57344)if(r)if(s<56320){i[t++]=239,i[t++]=191,i[t++]=189,r=s;continue}else s=r-55296<<10|s-56320|65536,r=null;else{s>56319||n+1===e.length?(i[t++]=239,i[t++]=191,i[t++]=189):r=s;continue}else r&&(i[t++]=239,i[t++]=191,i[t++]=189,r=null);s<128?i[t++]=s:(s<2048?i[t++]=s>>6|192:(s<65536?i[t++]=s>>12|224:(i[t++]=s>>18|240,i[t++]=s>>12&63|128),i[t++]=s>>6&63|128),i[t++]=s&63|128)}return t}class jR{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=yo,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let n=t.dataProjection?Oe(t.dataProjection):this.readProjection(e);t.extent&&n&&n.getUnits()==="tile-pixels"&&(n=Oe(n),n.setWorldExtent(t.extent)),t={dataProjection:n,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return ge()}readFeature(e,t){return ge()}readFeatures(e,t){return ge()}readGeometry(e,t){return ge()}readProjection(e){return ge()}writeFeature(e,t){return ge()}writeFeatures(e,t){return ge()}writeGeometry(e,t){return ge()}}function zR(i,e,t){const n=t?Oe(t.featureProjection):null,s=t?Oe(t.dataProjection):null;let r=i;if(n&&s&&!vt(n,s)){const o=s,l=n;o.getUnits()==="tile-pixels"?r.transform(o,l):r.applyTransform(Ti(o,l))}return r}class BR extends jR{constructor(e){super(),e=e||{},this.dataProjection=new ql({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:Lt,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,n,s){e.pos=t.geometry;const r=e.readVarint()+e.pos;let o=1,l=0,a=0,h=0,c=0,u=0;for(;e.pos<r;){if(!l){const d=e.readVarint();o=d&7,l=d>>3}if(l--,o===1||o===2)a+=e.readSVarint(),h+=e.readSVarint(),o===1&&c>u&&(s.push(c),u=c),n.push(a,h),c+=2;else if(o===7)c>u&&(n.push(n[u],n[u+1]),c+=2);else throw new Error("Invalid command found in the PBF")}c>u&&(s.push(c),u=c)}createFeature_(e,t,n){const s=t.type;if(s===0)return null;let r;const o=t.properties;let l;this.idProperty_?(l=o[this.idProperty_],delete o[this.idProperty_]):l=t.id,o[this.layerName_]=t.layer.name;const a=[],h=[];this.readRawGeometry_(e,t,a,h);const c=HR(s,h.length);if(this.featureClass===Lt)r=new this.featureClass(c,a,h,2,o,l),r.transform(n.dataProjection);else{let u;if(c=="Polygon"){const g=Zm(a,h);u=g.length>1?new Sl(a,"XY",g):new qi(a,"XY",h)}else u=c==="Point"?new Ii(a,"XY"):c==="LineString"?new Hs(a,"XY"):c==="MultiPoint"?new ma(a,"XY"):c==="MultiLineString"?new Tl(a,"XY",h):null;const d=this.featureClass;r=new d,this.geometryName_&&r.setGeometryName(this.geometryName_);const f=zR(u,!1,n);r.setGeometry(f),l!==void 0&&r.setId(l),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(e,t){const n=this.layers_;t=this.adaptOptions(t);const s=Oe(t.dataProjection);s.setWorldExtent(t.extent),t.dataProjection=s;const r=new RR(e),o=r.readFields(WR,{}),l=[];for(const a in o){if(n&&!n.includes(a))continue;const h=o[a],c=h?[0,0,h.extent,h.extent]:null;s.setExtent(c);for(let u=0,d=h.length;u<d;++u){const f=XR(r,h,u),g=this.createFeature_(r,f,t);g!==null&&l.push(g)}}return l}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function WR(i,e,t){if(i===3){const n={keys:[],values:[],features:[]},s=t.readVarint()+t.pos;t.readFields(UR,n,s),n.length=n.features.length,n.length&&(e[n.name]=n)}}function UR(i,e,t){if(i===15)e.version=t.readVarint();else if(i===1)e.name=t.readString();else if(i===5)e.extent=t.readVarint();else if(i===2)e.features.push(t.pos);else if(i===3)e.keys.push(t.readString());else if(i===4){let n=null;const s=t.readVarint()+t.pos;for(;t.pos<s;)i=t.readVarint()>>3,n=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null;e.values.push(n)}}function KR(i,e,t){if(i==1)e.id=t.readVarint();else if(i==2){const n=t.readVarint()+t.pos;for(;t.pos<n;){const s=e.layer.keys[t.readVarint()],r=e.layer.values[t.readVarint()];e.properties[s]=r}}else i==3?e.type=t.readVarint():i==4&&(e.geometry=t.pos)}function XR(i,e,t){i.pos=e.features[t];const n=i.readVarint()+i.pos,s={layer:e,type:0,properties:{}};return i.readFields(KR,s,n),s}function HR(i,e){let t;return i===1?t=e===1?"Point":"MultiPoint":i===2?t=e===1?"LineString":"MultiLineString":i===3&&(t="Polygon"),t}function YR(i,e){const t=i.canvas;e=e||{};const n=e.pixelRatio||pm,s=e.size;s&&(t.width=s[0]*n,t.height=s[1]*n,t.style.width=s[0]+"px",t.style.height=s[1]+"px");const r=[0,0,t.width,t.height],o=Zo(kt(),n,n);return new k_(i,n,r,o,0)}const ZR=new BR({featureClass:Lt}),$R=[new Ri({stroke:new rs({color:"blue",width:2})})];class qR{urls;emptyCanvas_=q_();emptyCanvasPromise_=Promise.resolve(this.emptyCanvas_);tilingScheme_=new Cesium.WebMercatorTilingScheme;ready_=!0;rectangle_;tileRectangle_;tileWidth=256;tileHeight=256;maximumLevel=20;minimumLevel_=0;get minimumLevel(){return this.minimumLevel_}featureCache;tileCache;tileFunction_;styleFunction_;projection_=Oe("EPSG:3857");get ready(){return this.ready_}get rectangle(){return this.rectangle_}get tilingScheme(){return this.tilingScheme_}errorEvent=new Cesium.Event;credit;getTileCredits(e,t,n){return[]}proxy;get _ready(){return this.ready_}get tileDiscardPolicy(){}get hasAlphaChannel(){return!0}pickFeatures(e,t,n,s,r){}constructor(e){this.urls=e.urls,this.rectangle_=e.rectangle||this.tilingScheme.rectangle,this.credit=e.credit,this.styleFunction_=e.styleFunction||(()=>$R),this.tileRectangle_=new Cesium.Rectangle;const t=e.cacheSize!==void 0?e.cacheSize:50;this.tileCache=new Cl(t),this.featureCache=e.featureCache||new Cl(t),this.minimumLevel_=e.minimumLevel||0;const n=da(this.projection_);this.tileFunction_=M_(this.urls,n)}getTileFeatures(e,t,n){const s=this.getCacheKey_(e,t,n);let r;if(this.featureCache.containsKey(s)&&(r=this.featureCache.get(s)),!r){const o=this.getUrl_(e,t,n);if(r=fetch(o).then(l=>l.ok?l:Promise.reject(l)).then(l=>l.arrayBuffer()).then(l=>this.readFeaturesFromBuffer(l)),this.featureCache.set(s,r),this.featureCache.getCount()>2*this.featureCache.highWaterMark)for(;this.featureCache.canExpireCache();)this.featureCache.pop()}return r}readFeaturesFromBuffer(e){const t=ZR.readFeatures(e),n=this.tileWidth/4096;return t.forEach(s=>{const r=s.getFlatCoordinates();for(let o=0;o<r.length;++o)r[o]*=n}),t}getUrl_(e,t,n){return this.tileFunction_([e,t,n],1,this.projection_)}getCacheKey_(e,t,n){return`${e}_${t}_${n}`}requestImage(e,t,n,s){if(n<this.minimumLevel_)return this.emptyCanvasPromise_;try{const r=this.getCacheKey_(n,e,t);let o;if(this.tileCache.containsKey(r)&&(o=this.tileCache.get(r)),!o&&(o=this.getTileFeatures(n,e,t).then(l=>{this.tilingScheme.tileXYToNativeRectangle(e,t,n,this.tileRectangle_);const a=(this.tileRectangle_.east-this.tileRectangle_.west)/this.tileWidth;return this.rasterizeFeatures(l,this.styleFunction_,a)}),this.tileCache.set(r,o),this.tileCache.getCount()>2*this.tileCache.highWaterMark))for(;this.tileCache.canExpireCache();)this.tileCache.pop();return o}catch(r){console.trace(r),this.errorEvent.raiseEvent("could not render pbf to tile",r)}}rasterizeFeatures(e,t,n){const s=document.createElement("canvas"),r=YR(s.getContext("2d"),{size:[this.tileWidth,this.tileHeight]});return e.forEach(o=>{const l=t(o,n);l&&(Array.isArray(l)?l.forEach(a=>{r.setStyle(a),r.drawGeometry(o)}):(r.setStyle(l),r.drawGeometry(o)))}),s}}const JR={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},Ff={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class QR extends A_{constructor(e,t){super(e,t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=kt(),this.tileClipContexts_=null}enqueueTilesForNextExtent(){return this.getLayer().getRenderMode()!=="vector"}drawTile(e,t,n,s,r,o,l,a){this.updateExecutorGroup_(e,t.pixelRatio,t.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,t),super.drawTile(e,t,n,s,r,o,l,a)}getTile(e,t,n,s){const r=this.getOrCreateTile(e,t,n,s);if(!r)return null;const o=s.viewState,l=o.resolution,a=s.viewHints,h=this.getLayer().getSource(),c=h.getTileGridForProjection(o.projection),u=!(a[je.ANIMATING]||a[je.INTERACTING]),d=c.getZForResolution(l,h.zDirection)===e;return u&&d?r.wantedResolution=l:r.wantedResolution||(r.wantedResolution=c.getResolution(e)),r}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,n){const s=this.getLayer(),r=s.getRevision(),o=s.getRenderOrder()||null,l=e.wantedResolution,a=e.getReplayState(s);if(!a.dirty&&a.renderedResolution===l&&a.renderedRevision==r&&a.renderedRenderOrder==o)return;const h=s.getSource(),c=!!s.getDeclutter(),u=h.getTileGrid(),f=h.getTileGridForProjection(n).getTileCoordExtent(e.wrappedTileCoord),g=h.getSourceTiles(t,n,e),m=de(s);delete e.hitDetectionImageData[m],e.executorGroups[m]=[],a.dirty=!1;for(let _=0,p=g.length;_<p;++_){const y=g[_];if(y.getState()!=$.LOADED)continue;const v=h.getProjection(),C=y.tileCoord;let x=u.getTileCoordExtent(C);n&&v&&!vt(n,v)&&(x=Lr(x,v,n,32));const T=li(f,x),I=oi(T,s.getRenderBuffer()*l,this.tempExtent),L=ns(x,T)?null:I,b=new F_(0,T,l,t),G=Zc(l,t),W=function(N,z){let V;const J=N.getStyleFunction()||s.getStyleFunction();if(J&&(V=J(N,l)),V){const se=this.renderFeature(N,G,V,b,c,z);a.dirty=a.dirty||se}},A=y.getFeatures();o&&o!==a.renderedRenderOrder&&A.sort(o);for(let N=0,z=A.length;N<z;++N){let V=A[N];n&&y.projection&&!vt(n,y.projection)&&(V=V.clone(),V.getGeometry().applyTransform(Ti(y.projection,n))),(!L||Ke(L,V.getGeometry().getExtent()))&&W.call(this,V,N)}const S=b.finish(),O=s.getRenderMode()!=="vector"&&c&&g.length===1?null:T,U=new D_(O,l,t,h.getOverlaps(),S,s.getRenderBuffer(),!0);e.executorGroups[m].push(U)}a.renderedRevision=r,a.renderedRenderOrder=o,a.renderedResolution=l}forEachFeatureAtCoordinate(e,t,n,s,r){const o=t.viewState.resolution,l=t.viewState.rotation;n=n??0;const a=this.getLayer(),c=a.getSource().getTileGridForProjection(t.viewState.projection),u=hl([e]);oi(u,o*n,u);const d={},f=function(v,C,x){let T=v.getId();T===void 0&&(T=de(v));const I=d[T];if(I){if(I!==!0&&x<I.distanceSq){if(x===0)return d[T]=!0,r.splice(r.lastIndexOf(I),1),s(v,a,C);I.geometry=C,I.distanceSq=x}}else{if(x===0)return d[T]=!0,s(v,a,C);r.push(d[T]={feature:v,layer:a,geometry:C,distanceSq:x,callback:s})}},g=this.renderedTiles,m=de(a),_=a.getDeclutter(),p=_?t.declutter?.[_]?.all().map(v=>v.value):null;let y;e:for(let v=0,C=g.length;v<C;++v){const x=g[v],T=c.getTileCoordExtent(x.wrappedTileCoord);if(!Ke(T,u))continue;const I=x.executorGroups[m];for(let L=0,b=I.length;L<b;++L)if(y=I[L].forEachFeatureAtCoordinate(e,o,l,n,f,p),y)break e}return y}getFeatures(e){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((t,n)=>{const s=this.getLayer(),r=s.getSource(),o=this.renderedProjection,l=o.getExtent(),a=this.renderedResolution,h=r.getTileGridForProjection(o),c=$e(this.renderedPixelToCoordinateTransform_,e.slice()),u=h.getTileCoordForCoordAndResolution(c,a).toString(),d=this.renderedTiles.find(v=>v.tileCoord.toString()===u&&v.getState()===$.LOADED);if(!d||d.loadingSourceTiles>0){t([]);return}r.getWrapX()&&o.canWrapX()&&!yi(l,h.getTileCoordExtent(d.tileCoord))&&Ph(c,o);const f=de(s),g=h.getTileCoordExtent(d.wrappedTileCoord),m=An(g),_=[(c[0]-m[0])/a,(m[1]-c[1])/a],p=d.getSourceTiles().reduce((v,C)=>v.concat(C.getFeatures()),[]);let y=d.hitDetectionImageData[f];if(!y){const v=gt(h.getTileSize(h.getZForResolution(a,r.zDirection))),C=this.renderedRotation_,x=[this.getRenderTransform(h.getTileCoordCenter(d.wrappedTileCoord),a,0,Ft,v[0]*Ft,v[1]*Ft,0)];y=N_(v,x,p,s.getStyleFunction(),h.getTileCoordExtent(d.wrappedTileCoord),d.getReplayState(s).renderedResolution,C),d.hitDetectionImageData[f]=y}t(G_(_,p,y))})}getFeaturesInExtent(e){const t=[],n=this.getTileCache();if(n.getCount()===0)return t;const r=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),o=r.getZForResolution(this.renderedResolution),l={};return n.forEach(a=>{if(a.tileCoord[0]!==o||a.getState()!==$.LOADED)return;const h=a.getSourceTiles();for(let c=0,u=h.length;c<u;++c){const d=h[c],f=d.getKey();if(f in l)continue;l[f]=!0;const g=d.tileCoord;if(Ke(e,r.getTileCoordExtent(g))){const m=d.getFeatures();if(m)for(let _=0,p=m.length;_<p;++_){const y=m[_],v=y.getGeometry();Ke(e,v.getExtent())&&t.push(y)}}}}),t}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,t){const n=this.context,s=n.globalAlpha;n.globalAlpha=t.opacity;const r=e.viewHints,o=!(r[je.ANIMATING]||r[je.INTERACTING]),l=[this.context.canvas.width,this.context.canvas.height],a=this.getLayer().getDeclutter(),h=a?e.declutter?.[a]:void 0,c=de(this.getLayer()),u=this.renderedTiles;for(let d=0,f=u.length;d<f;++d){const g=u[d],m=g.executorGroups[c];if(m)for(let _=m.length-1;_>=0;--_)m[_].execute(this.context,l,this.getTileRenderTransform(g,e),e.viewState.rotation,o,xl,h)}n.globalAlpha=s}renderDeferredInternal(e){const t=this.renderedTiles,n=de(this.getLayer()),s=t.reduce((a,h,c)=>(h.executorGroups[n].forEach(u=>a.push({executorGroup:u,index:c})),a),[]),r=s.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),o={};for(let a=0,h=s.length;a<h;++a){const c=s[a].executorGroup.getDeferredZIndexContexts();for(const u in c)o[u]=!0}Object.keys(o).map(Number).sort(xi).forEach(a=>{r.forEach((h,c)=>{h[a]&&(h[a].forEach(u=>{const{executorGroup:d,index:f}=s[c],g=d.getRenderedContext(),m=g.globalAlpha;g.globalAlpha=this.renderedOpacity_;const _=this.tileClipContexts_[f];_&&_.draw(g),u.draw(g),_&&g.restore(),g.globalAlpha=m,u.clear()}),h[a].length=0)})})}getTileRenderTransform(e,t){const n=t.pixelRatio,s=t.viewState,r=s.center,o=s.resolution,l=s.rotation,a=t.size,h=Math.round(a[0]*n),c=Math.round(a[1]*n),d=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),f=e.tileCoord,g=d.getTileCoordExtent(e.wrappedTileCoord),m=d.getTileCoordExtent(f,this.tempExtent)[0]-g[0];return Gh(Zo(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(r,o,l,n,h,c,m))}postRender(e,t){const n=t.viewHints,s=!(n[je.ANIMATING]||n[je.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.renderedOpacity_=t.layerStatesArray[t.layerIndex].opacity;const r=this.getLayer(),o=r.getRenderMode(),l=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;const a=r.getDeclutter(),h=a?Ff[o].filter(x=>!xl.includes(x)):Ff[o],c=t.viewState,u=c.rotation,d=r.getSource(),g=d.getTileGridForProjection(c.projection).getZForResolution(c.resolution,d.zDirection),m=this.renderedTiles,_=[],p=[],y=[],v=de(r);let C=!0;for(let x=m.length-1;x>=0;--x){const T=m[x];C=C&&!T.getReplayState(r).dirty;const I=T.executorGroups[v].filter(O=>O.hasExecutors(h));if(I.length===0)continue;const L=this.getTileRenderTransform(T,t),b=T.tileCoord[0];let G=!1;const W=I[0].getClipCoords(L);let A=e,S;if(W){S=new uu,A=S.getContext();for(let O=0,U=_.length;O<U;++O)if(g!==b&&b<p[O]){const N=_[O];Ke([W[0],W[3],W[4],W[7]],[N[0],N[3],N[4],N[7]])&&(G||(A.save(),G=!0),A.beginPath(),A.moveTo(W[0],W[1]),A.lineTo(W[2],W[3]),A.lineTo(W[4],W[5]),A.lineTo(W[6],W[7]),A.moveTo(N[6],N[7]),A.lineTo(N[4],N[5]),A.lineTo(N[2],N[3]),A.lineTo(N[0],N[1]),A.clip())}_.push(W),p.push(b)}for(let O=0,U=I.length;O<U;++O)I[O].execute(e,[e.canvas.width,e.canvas.height],L,u,s,h,t.declutter?.[a]);G&&(A===e?A.restore():y[x]=S)}e.globalAlpha=l,this.ready=C,this.tileClipContexts_=y,t.declutter||this.renderDeferredInternal(t),super.postRender(e,t)}renderFeature(e,t,n,s,r,o){if(!n)return!1;let l=!1;if(Array.isArray(n))for(let a=0,h=n.length;a<h;++a)l=wl(s,e,n[a],t,this.boundHandleStyleImageChange_,void 0,r,o)||l;else l=wl(s,e,n,t,this.boundHandleStyleImageChange_,void 0,r,o);return l}tileImageNeedsRender_(e){const t=this.getLayer();if(t.getRenderMode()==="vector")return!1;const n=e.getReplayState(t),s=t.getRevision(),r=e.wantedResolution;return n.renderedTileResolution!==r||n.renderedTileRevision!==s}renderTileImage_(e,t){const n=this.getLayer(),s=e.getReplayState(n),r=n.getRevision(),o=e.executorGroups[de(n)];s.renderedTileRevision=r;const l=e.wrappedTileCoord,a=l[0],h=n.getSource();let c=t.pixelRatio;const d=t.viewState.projection,f=h.getTileGridForProjection(d),g=f.getResolution(e.tileCoord[0]),m=t.pixelRatio/e.wantedResolution*g,_=f.getResolution(a),p=e.getContext();c=Math.round(Math.max(c,m/c));const y=h.getTilePixelSize(a,c,d);p.canvas.width=y[0],p.canvas.height=y[1];const v=c/m;if(v!==1){const I=zd(this.tmpTransform_);Zo(I,v,v),p.setTransform.apply(p,I)}const C=f.getTileCoordExtent(l,this.tempExtent),x=m/_,T=zd(this.tmpTransform_);Zo(T,x,-x),bE(T,-C[0],-C[3]);for(let I=0,L=o.length;I<L;++I)o[I].execute(p,[p.canvas.width*v,p.canvas.height*v],T,0,!0,JR[n.getRenderMode()],null);s.renderedTileResolution=e.wantedResolution}}class Cu extends ua{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload;const n=e.cacheSize===void 0?0:e.cacheSize;delete e.cacheSize,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=n;const s=e.renderMode||"hybrid";we(s=="hybrid"||s=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=s,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new QR(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(vn.PRELOAD)}getUseInterimTilesOnError(){return this.get(vn.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(vn.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(vn.USE_INTERIM_TILES_ON_ERROR,e)}}function eT(i,e){const t=i.camera.getPickRay(e);return i.globe.pick(t,i)||i.camera.pickEllipsoid(e)}function tT(i){const e=i.canvas,t=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2);return eT(i,t)}function J_(i,e){if(i&&e){const t=Lr(i,e,"EPSG:4326");return Cesium.Rectangle.fromDegrees(t[0],t[1],t[2],t[3])}else return null}function iT(i,e,t,n){const s=e.get("olcs_skip");if(s)return null;let r=null;if(e instanceof uR&&e.getUrl()){const o={olcs_proxy:e.get("olcs_proxy"),olcs_extent:e.get("olcs_extent"),olcs_projection:e.get("olcs_projection"),"olcs.imagesource":e},l=e.getImageLoadFunction(),a=e.get("olcs_tileLoadFunction")||function(c,u){l(c,u)};e=new CR({url:e.getUrl(),attributions:e.getAttributions(),projection:e.getProjection(),tileLoadFunction:a,params:e.getParams()}),e.setProperties(o)}if(e instanceof _u){let o=qo(e);if(o||(o=t),Nf(o))r=new xR(i,e,t);else return null}else if(e instanceof lR){let o=qo(e);if(o||(o=t),Nf(o)){const l=Cesium.Rectangle.fromDegrees(e.getImageExtent()[0],e.getImageExtent()[1],e.getImageExtent()[2],e.getImageExtent()[3],new Cesium.Rectangle);r=new Cesium.SingleTileImageryProvider({url:e.getUrl(),rectangle:l})}else return null}else if(e instanceof gR&&n instanceof Cu){let o=qo(e);if(o||(o=t),s===!1){const l=o.getCode().split(":")[1],a=e.urls.map(m=>m.replace(l,"3857")),h=n.getExtent(),c=J_(h,o),u=e.get("olcs_minimumLevel"),d=e.getAttributions(),f=n.getStyleFunction();let g;if(h&&d){const m=$t(h);g=Q_(d,0,m,h)[0]}return r=new qR({credit:g,rectangle:c,minimumLevel:u,styleFunction:f,urls:a}),r}return null}else return null;return r}function nT(i,e,t){if(!(e instanceof Yc)&&!(e instanceof yR)&&!(e instanceof Cu))return null;const n=e.getSource();if(!n)return null;let s=n.get("olcs_provider");if(s||(s=iT(i,n,t,e)),!s)return null;const r={},l=e.get("olcs_extent")||e.getExtent();return l&&(r.rectangle=J_(l,t)),new Cesium.ImageryLayer(s,r)}function Df(i,e){let t=1,n=!0;[i.layer].concat(i.parents).forEach(s=>{const r=s.getOpacity();r!==void 0&&(t*=r);const o=s.getVisible();o!==void 0&&(n=n&&o)}),e.alpha=t,e.show=n}function Is(i){const e=i;return e.length>2?Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]):Cesium.Cartesian3.fromDegrees(e[0],e[1])}function uc(i){console.assert(i!==null);const e=Is,t=[];for(let n=0;n<i.length;++n)t.push(e(i[n]));return t}function zo(i,e){console.assert(e);const t=Oe("EPSG:4326"),n=Oe(e);if(n.getCode()!==t.getCode()){const s=i.getProperties();i=i.clone(),i.transform(n,t),i.setProperties(s)}return i}function kf(i){if(i=i||"black",Array.isArray(i))return new Cesium.Color(Cesium.Color.byteToFloat(i[0]),Cesium.Color.byteToFloat(i[1]),Cesium.Color.byteToFloat(i[2]),i[3]);if(typeof i=="string")return Cesium.Color.fromCssColorString(i);if(i instanceof CanvasPattern||i instanceof CanvasGradient){const e=document.createElement("canvas"),t=e.getContext("2d");return e.width=e.height=256,t.fillStyle=i,t.fillRect(0,0,e.width,e.height),new Cesium.ImageMaterialProperty({image:e})}console.assert(!1,"impossible")}function Nf(i){const e=i.getCode()==="EPSG:3857",t=i.getCode()==="EPSG:4326";return e||t}function Q_(i,e,t,n){if(!i)return[];let s=i({viewState:{zoom:e,center:t,projection:void 0,resolution:void 0,rotation:void 0},extent:n});return Array.isArray(s)||(s=[s]),s.map(r=>new Cesium.Credit(r,!0))}function sT(i,e,t,n){const s=t.canvas,o=t.camera.frustum.fovy;console.assert(!isNaN(o));const l=n.getMetersPerUnit(),a=i*s.clientHeight,h=Math.cos(Math.abs(e));return a*l*h/2/Math.tan(o/2)}function rT(i,e,t,n){const s=t.canvas,o=t.camera.frustum.fovy;console.assert(!isNaN(o));const l=n.getMetersPerUnit(),a=2*i*Math.tan(o/2),h=Math.cos(Math.abs(e));return a/l/h/s.clientHeight}class oT{ol3d;scene_;canvas_;_boundNotifyRepaintRequired;repaintEventNames_=["mousemove","mousedown","mouseup","touchstart","touchend","touchmove","pointerdown","pointerup","pointermove","wheel"];constructor(e){this.ol3d=e,this.scene_=e.getCesiumScene(),this.canvas_=this.scene_.canvas,this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this),this.enable()}enable(){this.scene_.requestRenderMode=!0,this.scene_.maximumRenderTimeChange=1e3;for(const e of this.repaintEventNames_)this.canvas_.addEventListener(e,this._boundNotifyRepaintRequired,!1);window.addEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().on("change",this._boundNotifyRepaintRequired)}disable(){for(const e of this.repaintEventNames_)this.canvas_.removeEventListener(e,this._boundNotifyRepaintRequired,!1);window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().un("change",this._boundNotifyRepaintRequired),this.scene_.requestRenderMode=!1}restartRenderLoop(){this.notifyRepaintRequired()}notifyRepaintRequired(){this.scene_.isDestroyed()||this.scene_.requestRender()}}function Bo(i){return i*180/Math.PI}function gr(i){return i*Math.PI/180}function Wo(i,e,t){const n=t||i.length;if(e)for(let s=0;s<n;++s)e[s]=i[s];return i}class lT{scene_;cam_;map_;view_;viewListenKey_=null;toLonLat_=Wo;fromLonLat_=Wo;tilt_=0;distance_=0;lastCameraViewMatrix_=null;viewUpdateInProgress_=!1;constructor(e,t){this.scene_=e,this.cam_=e.camera,this.map_=t,this.map_.on("change:view",n=>{this.setView_(this.map_.getView())}),this.setView_(this.map_.getView())}destroy(){Qt(this.viewListenKey_),this.viewListenKey_=null}setView_(e){if(Qt(this.viewListenKey_),this.viewListenKey_=null,this.view_=e,e){const t=Ti(e.getProjection(),"EPSG:4326"),n=Ti("EPSG:4326",e.getProjection());console.assert(t&&n),this.toLonLat_=t,this.fromLonLat_=n,this.viewListenKey_=e.on("propertychange",s=>this.handleViewChangedEvent_()),this.readFromView()}else this.toLonLat_=Wo,this.fromLonLat_=Wo}handleViewChangedEvent_(){this.viewUpdateInProgress_||this.readFromView()}setHeading(e){this.view_&&this.view_.setRotation(e)}getHeading(){return this.view_?this.view_.getRotation()||0:void 0}setTilt(e){this.tilt_=e,this.updateCamera_()}getTilt(){return this.tilt_}setDistance(e){this.distance_=e,this.updateCamera_(),this.updateView()}getDistance(){return this.distance_}setCenter(e){this.view_&&this.view_.setCenter(e)}getCenter(){if(this.view_)return this.view_.getCenter()}setPosition(e){if(!this.toLonLat_)return;const t=this.toLonLat_(e);console.assert(t);const n=new Cesium.Cartographic(gr(t[0]),gr(t[1]),this.getAltitude());this.cam_.setView({destination:Cesium.Ellipsoid.WGS84.cartographicToCartesian(n)}),this.updateView()}getPosition(){if(!this.fromLonLat_)return;const e=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position),t=this.fromLonLat_([Bo(e.longitude),Bo(e.latitude)]);return console.assert(t),t}setAltitude(e){const t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);t.height=e,this.cam_.position=Cesium.Ellipsoid.WGS84.cartographicToCartesian(t),this.updateView()}getAltitude(){return Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position).height}updateCamera_(){if(!this.view_||!this.toLonLat_)return;const e=this.view_.getCenter();if(!e)return;const t=this.toLonLat_(e);console.assert(t);const n=new Cesium.Cartographic(gr(t[0]),gr(t[1]));if(this.scene_.globe){const o=this.scene_.globe.getHeight(n);n.height=o||0}const s=Cesium.Ellipsoid.WGS84.cartographicToCartesian(n),r={pitch:this.tilt_-Cesium.Math.PI_OVER_TWO,heading:-this.view_.getRotation(),roll:void 0};this.cam_.setView({destination:s,orientation:r}),this.cam_.moveBackward(this.distance_),this.checkCameraChange(!0)}readFromView(){if(!this.view_||!this.toLonLat_)return;const e=this.view_.getCenter();if(e==null)return;const t=this.toLonLat_(e);console.assert(t);const n=this.view_.getResolution();this.distance_=this.calcDistanceForResolution(n||0,gr(t[1])),this.updateCamera_()}updateView(){if(!this.view_||!this.fromLonLat_)return;this.viewUpdateInProgress_=!0;const e=Cesium.Ellipsoid.WGS84,t=this.scene_,n=tT(t);let s=n;if(!s){const o=t.globe,l=this.cam_.positionCartographic.clone(),a=o.getHeight(l);l.height=a||0,s=Cesium.Ellipsoid.WGS84.cartographicToCartesian(l)}this.distance_=Cesium.Cartesian3.distance(s,this.cam_.position);const r=e.cartesianToCartographic(s);if(this.view_.setCenter(this.fromLonLat_([Bo(r.longitude),Bo(r.latitude)])),this.view_.setResolution(this.calcResolutionForDistance(this.distance_,r?r.latitude:0)),n){const o=this.cam_.position,l=new Cesium.Cartesian3;e.geocentricSurfaceNormal(n,l);const a=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(o,n,a),Cesium.Cartesian3.normalize(a,a);const h=this.cam_.up,c=this.cam_.right,u=new Cesium.Cartesian3(-n.y,n.x,0),d=Cesium.Cartesian3.angleBetween(c,u),g=Cesium.Cartesian3.cross(n,h,new Cesium.Cartesian3).z;this.view_.setRotation(g<0?d:-d);const m=Math.acos(Cesium.Cartesian3.dot(l,a));this.tilt_=isNaN(m)?0:m}else this.view_.setRotation(this.cam_.heading),this.tilt_=-this.cam_.pitch+Math.PI/2;setTimeout(()=>this.viewUpdateInProgress_=!1,1e3)}checkCameraChange(e){const t=this.lastCameraViewMatrix_,n=this.cam_.viewMatrix;(!t||!Cesium.Matrix4.equalsEpsilon(t,n,1e-7))&&(this.lastCameraViewMatrix_=n.clone(),e!==!0&&this.updateView())}calcDistanceForResolution(e,t){return sT(e,t,this.scene_,this.view_.getProjection())}calcResolutionForDistance(e,t){return rT(e,t,this.scene_,this.view_.getProjection())}}class ep{map;view;scene;olLayers;mapLayerGroup;layerMap={};olLayerListenKeys={};olGroupListenKeys_={};constructor(e,t){this.map=e,this.view=e.getView(),this.scene=t,this.olLayers=e.getLayerGroup().getLayers(),this.mapLayerGroup=e.getLayerGroup()}synchronize(){this.destroyAll(),this.addLayers_(this.mapLayerGroup)}orderLayers(){}addLayers_(e){const t=[{layer:e,parents:[]}];for(;t.length>0;){const n=t.splice(0,1)[0],s=n.layer,r=et(s).toString();this.olLayerListenKeys[r]=[],console.assert(!this.layerMap[r]);let o=null;if(s instanceof Ji)this.listenForGroupChanges_(s),s!==this.mapLayerGroup&&(o=this.createSingleLayerCounterparts(n)),o||s.getLayers().forEach(l=>{if(l){const a={layer:l,parents:s===this.mapLayerGroup?[]:[n.layer].concat(n.parents)};t.push(a)}});else if(o=this.createSingleLayerCounterparts(n),!o){const l=r,a=n,h=()=>{const c=this.createSingleLayerCounterparts(a);c&&(a.layer.un("change",h),this.addCesiumObjects_(c,l,a.layer),this.orderLayers())};this.olLayerListenKeys[r].push(a.layer.on("change",h))}o&&this.addCesiumObjects_(o,r,s)}this.orderLayers()}addCesiumObjects_(e,t,n){this.layerMap[t]=e,this.olLayerListenKeys[t].push(n.on("change:zIndex",()=>this.orderLayers())),e.forEach(s=>{this.addCesiumObject(s)})}removeAndDestroySingleLayer_(e){const t=et(e).toString(),n=this.layerMap[t];return n&&(n.forEach(s=>{this.removeSingleCesiumObject(s,!1),this.destroyCesiumObject(s)}),this.olLayerListenKeys[t].forEach(Qt),delete this.olLayerListenKeys[t]),delete this.layerMap[t],!!n}unlistenSingleGroup_(e){if(e===this.mapLayerGroup)return;const t=et(e).toString();this.olGroupListenKeys_[t].forEach(s=>{Qt(s)}),delete this.olGroupListenKeys_[t],delete this.layerMap[t]}removeLayer_(e){if(e){const t=[e];for(;t.length>0;){const n=t.splice(0,1)[0],s=this.removeAndDestroySingleLayer_(n);n instanceof Ji&&(this.unlistenSingleGroup_(n),s||n.getLayers().forEach(r=>{t.push(r)}))}}}listenForGroupChanges_(e){const t=et(e).toString();console.assert(this.olGroupListenKeys_[t]===void 0);const n=[];this.olGroupListenKeys_[t]=n;let s=[];const r=(function(){const o=e.getLayers();o&&(s=[o.on("add",l=>{this.addLayers_(l.element)}),o.on("remove",l=>{this.removeLayer_(l.element)})],n.push(...s))}).bind(this);r(),n.push(e.on("change:layers",o=>{s.forEach(l=>{const a=n.indexOf(l);a>=0&&n.splice(a,1),Qt(l)}),r()}))}destroyAll(){this.removeAllCesiumObjects(!0);let e;for(e in this.olGroupListenKeys_)this.olGroupListenKeys_[e].forEach(Qt);for(e in this.olLayerListenKeys)this.olLayerListenKeys[e].forEach(Qt);this.olGroupListenKeys_={},this.olLayerListenKeys={},this.layerMap={}}}class tp extends ep{cesiumLayers_;ourLayers_;constructor(e,t){super(e,t),this.cesiumLayers_=t.imageryLayers,this.ourLayers_=new Cesium.ImageryLayerCollection}addCesiumObject(e){this.cesiumLayers_.add(e),this.ourLayers_.add(e)}destroyCesiumObject(e){e.destroy()}removeSingleCesiumObject(e,t){this.cesiumLayers_.remove(e,t),this.ourLayers_.remove(e,!1)}removeAllCesiumObjects(e){for(let t=0;t<this.ourLayers_.length;++t)this.cesiumLayers_.remove(this.ourLayers_.get(t),e);this.ourLayers_.removeAll(!1)}convertLayerToCesiumImageries(e,t){const n=nT(this.map,e,t);return n?[n]:null}createSingleLayerCounterparts(e){const t=e.layer,n=et(t).toString(),s=this.view.getProjection();console.assert(s);const r=this.convertLayerToCesiumImageries(t,s);if(r){const o=[];if([e.layer].concat(e.parents).forEach(l=>{o.push(l.on(["change:opacity","change:visible"],()=>{console.assert(r);for(let a=0;a<r.length;++a)Df(e,r[a])}))}),t instanceof ua){let l=t.getStyleFunction();o.push(t.on("change",()=>{const a=t.getStyleFunction();if(l!==a){l=a;for(let h=0;h<r.length;++h){const c=r[h];c._imageryCache&&(c._imageryCache={});const u=c.imageryProvider;u&&(u.tileCache?.clear(),u.styleFunction_=a)}this.scene.requestRender()}}))}for(let l=0;l<r.length;++l)Df(e,r[l]);o.push(t.on("change:extent",l=>{for(let a=0;a<r.length;++a)this.cesiumLayers_.remove(r[a],!0),this.ourLayers_.remove(r[a],!1);delete this.layerMap[et(t)],this.synchronize()})),o.push(t.on("change",l=>{for(let a=0;a<r.length;++a){const h=this.cesiumLayers_.indexOf(r[a]);h>=0&&(this.cesiumLayers_.remove(r[a],!1),this.cesiumLayers_.add(r[a],h))}})),this.olLayerListenKeys[n].push(...o)}return Array.isArray(r)?r:null}orderLayers(){const e=[],t={},n=[this.mapLayerGroup];for(;n.length>0;){const s=n.splice(0,1)[0];if(e.push(s),t[et(s)]=s.getZIndex()||0,s instanceof Ji){const r=s.getLayers();r&&n.unshift(...r.getArray())}}e.sort((s,r)=>t[et(s)]-t[et(r)]),e.forEach(s=>{const r=et(s).toString(),o=this.layerMap[r];o&&o.forEach(l=>{this.raiseToTop(l)})})}raiseToTop(e){this.cesiumLayers_.raiseToTop(e)}}class aT{olListenKeys=[];context;rootCollection_;constructor(e,t){const n=new Cesium.BillboardCollection({scene:t}),s=new Cesium.PrimitiveCollection;this.rootCollection_=new Cesium.PrimitiveCollection,this.context={projection:e,billboards:n,featureToCesiumMap:{},primitives:s},this.rootCollection_.add(n),this.rootCollection_.add(s)}destroy(){this.olListenKeys.forEach(Qt),this.olListenKeys.length=0}getRootPrimitive(){return this.rootCollection_}}class cT{scene;boundOnRemoveOrClearFeatureListener_=this.onRemoveOrClearFeature_.bind(this);defaultBillboardEyeOffset_=new Cesium.Cartesian3(0,0,10);constructor(e){this.scene=e,this.scene=e}onRemoveOrClearFeature_(e){const t=e.target;console.assert(t instanceof eo);const n=t.olcs_cancellers;if(n){const s=e.feature;if(s){const r=et(s),o=n[r];o&&(o(),delete n[r])}else{for(const r in n)n.hasOwnProperty(r)&&n[r]();t.olcs_cancellers={}}}}setReferenceForPicking(e,t,n){n.olLayer=e,n.olFeature=t}createColoredPrimitive(e,t,n,s,r,o){const l=function(d,f){const g=new Cesium.GeometryInstance({geometry:d});return f&&!(f instanceof Cesium.ImageMaterialProperty)&&(g.attributes={color:Cesium.ColorGeometryInstanceAttribute.fromColor(f)}),g},a={flat:!0,renderState:{depthTest:{enabled:!0}}};o!==void 0&&(a.renderState.lineWidth=o);const h=l(s,r),c=this.getHeightReference(e,t,n);let u;if(c===Cesium.HeightReference.CLAMP_TO_GROUND){if(!("createShadowVolume"in h.geometry.constructor))return null;u=new Cesium.GroundPrimitive({geometryInstances:h})}else u=new Cesium.Primitive({geometryInstances:h});if(r instanceof Cesium.ImageMaterialProperty){const d=r.image.getValue().toDataURL();u.appearance=new Cesium.MaterialAppearance({flat:!0,renderState:{depthTest:{enabled:!0}},material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:d}}})})}else u.appearance=new Cesium.MaterialAppearance({...a,material:new Cesium.Material({translucent:r.alpha!==1,fabric:{type:"Color",uniforms:{color:r}}})}),u instanceof Cesium.Primitive&&(t.get("olcs_shadows")||e.get("olcs_shadows"))&&(u.shadows=1);return this.setReferenceForPicking(e,t,u),u}extractColorFromOlStyle(e,t){const n=e.getFill()?.getColor(),s=e.getStroke()?e.getStroke().getColor():null;let r="black";s&&t?r=s:n&&(r=n);const o=kf(r);return"red"in o?o:Cesium.Color.BLACK}extractLineWidthFromOlStyle(e){const t=e.getStroke()?e.getStroke().getWidth():void 0;return t!==void 0?t:1}wrapFillAndOutlineGeometries(e,t,n,s,r,o){const l=this.extractColorFromOlStyle(o,!1),a=this.extractColorFromOlStyle(o,!0),h=new Cesium.PrimitiveCollection;if(o.getFill()){const c=this.createColoredPrimitive(e,t,n,s,l);console.assert(!!c),h.add(c)}if(o.getStroke()&&r){const c=this.extractLineWidthFromOlStyle(o),u=this.createColoredPrimitive(e,t,n,r,a,c);u&&h.add(u)}return h}addTextStyle(e,t,n,s,r){let o;if(r instanceof Cesium.PrimitiveCollection?o=r:(o=new Cesium.PrimitiveCollection,o.add(r)),!s.getText())return o;const l=s.getText(),a=this.olGeometry4326TextPartToCesium(e,t,n,l);return a&&o.add(a),o}csAddBillboard(e,t,n,s,r,o){t.eyeOffset||(t.eyeOffset=this.defaultBillboardEyeOffset_);const l=e.add(t);return this.setReferenceForPicking(n,s,l),l}olCircleGeometryToCesium(e,t,n,s,r){n=zo(n,s),console.assert(n.getType()=="Circle");const o=n.getCenter(),l=o.length==3?o[2]:0,a=o.slice();a[0]+=n.getRadius();const h=Is(o),c=Is(a),u=Cesium.Cartesian3.distance(h,c),d=new Cesium.CircleGeometry({center:h,radius:u,height:l});let f,g;if(this.getHeightReference(e,t,n)===Cesium.HeightReference.CLAMP_TO_GROUND){const _=this.extractLineWidthFromOlStyle(r);if(_){const p=qE(n.getCenter(),u),y=uc(p.getLinearRing(0).getCoordinates()),v=f=new Cesium.GroundPolylinePrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.GroundPolylineGeometry({positions:y,width:_})}),appearance:new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(t,r,!0)}),classificationType:Cesium.ClassificationType.TERRAIN});cc(f).then(()=>{this.setReferenceForPicking(e,t,v._primitive)})}}else g=new Cesium.CircleOutlineGeometry({center:h,radius:u,extrudedHeight:l,height:l});const m=this.wrapFillAndOutlineGeometries(e,t,n,d,g,r);return f&&m.add(f),this.addTextStyle(e,t,n,r,m)}olLineStringGeometryToCesium(e,t,n,s,r){n=zo(n,s),console.assert(n.getType()=="LineString");const o=uc(n.getCoordinates()),l=this.extractLineWidthFromOlStyle(r);let a;const h=this.getHeightReference(e,t,n),c=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(t,r,!0)});if(h===Cesium.HeightReference.CLAMP_TO_GROUND){const u=new Cesium.GroundPolylineGeometry({positions:o,width:l}),d=a=new Cesium.GroundPolylinePrimitive({appearance:c,geometryInstances:new Cesium.GeometryInstance({geometry:u})});cc(a).then(()=>{this.setReferenceForPicking(e,t,d._primitive)})}else{const u=new Cesium.PolylineGeometry({positions:o,width:l,vertexFormat:c.vertexFormat});a=new Cesium.Primitive({appearance:c,geometryInstances:new Cesium.GeometryInstance({geometry:u})})}return this.setReferenceForPicking(e,t,a),this.addTextStyle(e,t,n,r,a)}olPolygonGeometryToCesium(e,t,n,s,r){n=zo(n,s),console.assert(n.getType()=="Polygon");const o=this.getHeightReference(e,t,n);let l,a,h;if(n.getCoordinates()[0].length==5&&t.get("olcs_polygon_kind")==="rectangle"){const u=n.getCoordinates()[0],d=hl(u),f=Cesium.Rectangle.fromDegrees(d[0],d[1],d[2],d[3]);let g=0;if(u[0].length==3)for(let _=0;_<u.length;_++)g=Math.max(g,u[_][2]);const m=t.get("olcs_extruded_height");l=new Cesium.RectangleGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:f,height:g,extrudedHeight:m}),a=new Cesium.RectangleOutlineGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:f,height:g,extrudedHeight:m})}else{const u=n.getLinearRings(),d={positions:[],holes:[]},f=d;console.assert(u.length>0);for(let m=0;m<u.length;++m){const _=u[m].getCoordinates(),p=uc(_);console.assert(p&&p.length>0),m===0?d.positions=p:d.holes.push({positions:p,holes:[]})}const g=t.get("olcs_extruded_height");if(l=new Cesium.PolygonGeometry({polygonHierarchy:f,perPositionHeight:!0,extrudedHeight:g}),o===Cesium.HeightReference.CLAMP_TO_GROUND){const m=this.extractLineWidthFromOlStyle(r);if(m>0){const _=[d.positions];if(d.holes)for(let v=0;v<d.holes.length;++v)_.push(d.holes[v].positions);const p=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(t,r,!0)}),y=[];for(const v of _){const C=new Cesium.GroundPolylineGeometry({positions:v,width:m});y.push(new Cesium.GeometryInstance({geometry:C}))}h=new Cesium.GroundPolylinePrimitive({appearance:p,geometryInstances:y}),cc(h).then(()=>{this.setReferenceForPicking(e,t,h._primitive)})}}else a=new Cesium.PolygonOutlineGeometry({polygonHierarchy:d,perPositionHeight:!0,extrudedHeight:g})}const c=this.wrapFillAndOutlineGeometries(e,t,n,l,a,r);return h&&c.add(h),this.addTextStyle(e,t,n,r,c)}getHeightReference(e,t,n){let s=n.get("altitudeMode");s===void 0&&(s=t.get("altitudeMode")),s===void 0&&(s=e.get("altitudeMode"));let r=Cesium.HeightReference.NONE;return s==="clampToGround"?r=Cesium.HeightReference.CLAMP_TO_GROUND:s==="relativeToGround"&&(r=Cesium.HeightReference.RELATIVE_TO_GROUND),r}createBillboardFromImage(e,t,n,s,r,o,l,a){o instanceof In&&o.load();const h=o.getImage(1),c=function(d){return d.src!=""&&d.naturalHeight!=0&&d.naturalWidth!=0&&d.complete},u=(function(){if(!h||!(h instanceof HTMLCanvasElement||h instanceof Image||h instanceof HTMLImageElement))return;const d=n.getCoordinates(),f=Is(d);let g;const m=o.getOpacity();m!==void 0&&(g=new Cesium.Color(1,1,1,m));const _=o.getScale(),p=this.getHeightReference(e,t,n),y={image:h,color:g,scale:Array.isArray(_)?(_[0]+_[1])/2:_,heightReference:p,position:f};if(Object.assign(y,t.get("cesiumOptions")),o instanceof In){const C=o.getAnchor();if(C){const x=Array.isArray(_)?_[0]:_,T=Array.isArray(_)?_[1]:_;y.pixelOffset=new Cesium.Cartesian2((h.width/2-C[0])*x,(h.height/2-C[1])*T)}}const v=this.csAddBillboard(l,y,e,t,n,r);a&&a(v)}).bind(this);if(h instanceof Image&&!c(h)){let d=!1;const f=e.getSource(),g=function(){d=!0};f.on(["removefeature","clear"],this.boundOnRemoveOrClearFeatureListener_);let m=f.olcs_cancellers;m||(m=f.olcs_cancellers={});const _=et(t);m[_]&&m[_](),m[_]=g;const p=function(){h.removeEventListener("load",p),!l.isDestroyed()&&!d&&u()};h.addEventListener("load",p)}else u()}olPointGeometryToCesium(e,t,n,s,r,o,l){console.assert(n.getType()=="Point"),n=zo(n,s);let a=null;const h=r.getImage();if(h){const c=n.get("olcs_model")||t.get("olcs_model");if(c){a=new Cesium.PrimitiveCollection;const u=c(),d=Object.assign({},{scene:this.scene},u.cesiumOptions);if("fromGltf"in Cesium.Model){const f=Cesium.Model.fromGltf(d);a.add(f)}else Cesium.Model.fromGltfAsync(d).then(f=>{a.add(f)});u.debugModelMatrix&&a.add(new Cesium.DebugModelMatrixPrimitive({modelMatrix:u.debugModelMatrix}))}else this.createBillboardFromImage(e,t,n,s,r,h,o,l)}return r.getText()?this.addTextStyle(e,t,n,r,a||new Cesium.Primitive):a}olMultiGeometryToCesium(e,t,n,s,r,o,l){switch(n.getType()){case"MultiPoint":{const a=n.getPoints();if(r.getText()){const h=new Cesium.PrimitiveCollection;return a.forEach(c=>{console.assert(c);const u=this.olPointGeometryToCesium(e,t,c,s,r,o,l);u&&h.add(u)}),h}else return a.forEach(h=>{console.assert(h),this.olPointGeometryToCesium(e,t,h,s,r,o,l)}),null}case"MultiLineString":{const a=n.getLineStrings(),h=new Cesium.PrimitiveCollection;return a.forEach(c=>{const u=this.olLineStringGeometryToCesium(e,t,c,s,r);h.add(u)}),h}case"MultiPolygon":{const a=n.getPolygons(),h=new Cesium.PrimitiveCollection;return a.forEach(c=>{const u=this.olPolygonGeometryToCesium(e,t,c,s,r);h.add(u)}),h}default:console.assert(!1,`Unhandled multi geometry type${n.getType()}`)}}olGeometry4326TextPartToCesium(e,t,n,s){const r=s.getText();if(!r)return null;const o=new Cesium.LabelCollection({scene:this.scene}),l=$t(n.getExtent());if(n instanceof Ln){const g=n.getFirstCoordinate();l[2]=g.length==3?g[2]:0}const a={position:Is(l)};a.text=Array.isArray(r)?r.join(" "):r,a.heightReference=this.getHeightReference(e,t,n);const h=s.getOffsetX(),c=s.getOffsetY();if(h!=0||c!=0){const g=new Cesium.Cartesian2(h,c);a.pixelOffset=g}a.font=s.getFont()||"10px sans-serif";let u;s.getFill()&&(a.fillColor=this.extractColorFromOlStyle(s,!1),u=Cesium.LabelStyle.FILL),s.getStroke()&&(a.outlineWidth=this.extractLineWidthFromOlStyle(s),a.outlineColor=this.extractColorFromOlStyle(s,!0),u=Cesium.LabelStyle.OUTLINE),s.getFill()&&s.getStroke()&&(u=Cesium.LabelStyle.FILL_AND_OUTLINE),a.style=u;let d;switch(s.getTextAlign()){case"left":d=Cesium.HorizontalOrigin.LEFT;break;case"right":d=Cesium.HorizontalOrigin.RIGHT;break;default:d=Cesium.HorizontalOrigin.CENTER}if(a.horizontalOrigin=d,s.getTextBaseline()){let g;switch(s.getTextBaseline()){case"top":g=Cesium.VerticalOrigin.TOP;break;case"middle":g=Cesium.VerticalOrigin.CENTER;break;case"bottom":g=Cesium.VerticalOrigin.BOTTOM;break;case"alphabetic":g=Cesium.VerticalOrigin.TOP;break;case"hanging":g=Cesium.VerticalOrigin.BOTTOM;break;default:console.assert(!1,`unhandled baseline ${s.getTextBaseline()}`)}a.verticalOrigin=g}const f=o.add(a);return this.setReferenceForPicking(e,t,f),o}olStyleToCesium(e,t,n){const s=t.getFill(),r=t.getStroke();if(n&&!r||!n&&!s)return null;const o=n?r.getColor():s.getColor(),l=kf(o),a=r.getLineDash();return n&&a?Cesium.Material.fromType("PolylineDash",{dashPattern:hT(a),color:l}):Cesium.Material.fromType("Color",{color:l})}computePlainStyle(e,t,n,s){const r=t.getStyleFunction();let o=null;return r&&(o=r(t,s)),!o&&n&&(o=n(t,s)),o?Array.isArray(o)?o:[o]:null}getGeometryFromFeature(e,t,n){if(n)return n;const s=e.get("olcs_3d_geometry");if(s&&s instanceof Gc)return s;if(t){const r=t.getGeometryFunction()(e);if(r instanceof Gc)return r}return e.getGeometry()}olFeatureToCesium(e,t,n,s,r){const o=this.getGeometryFromFeature(t,n,r);if(!o)return null;const l=s.projection,a=function(h){const c=s.featureToCesiumMap[et(t)];c instanceof Array?c.push(h):s.featureToCesiumMap[et(t)]=[h]};switch(o.getType()){case"GeometryCollection":const h=new Cesium.PrimitiveCollection;return o.getGeometriesArray().forEach(d=>{if(d){const f=this.olFeatureToCesium(e,t,n,s,d);f&&h.add(f)}}),h;case"Point":const c=s.billboards,u=this.olPointGeometryToCesium(e,t,o,l,n,c,a);return u||null;case"Circle":return this.olCircleGeometryToCesium(e,t,o,l,n);case"LineString":return this.olLineStringGeometryToCesium(e,t,o,l,n);case"Polygon":return this.olPolygonGeometryToCesium(e,t,o,l,n);case"MultiPoint":return this.olMultiGeometryToCesium(e,t,o,l,n,s.billboards,a)||null;case"MultiLineString":return this.olMultiGeometryToCesium(e,t,o,l,n,s.billboards,a)||null;case"MultiPolygon":return this.olMultiGeometryToCesium(e,t,o,l,n,s.billboards,a)||null;case"LinearRing":throw new Error("LinearRing should only be part of polygon.");default:throw new Error(`Ol geom type not handled : ${o.getType()}`)}}olVectorLayerToCesium(e,t,n){const s=t.getProjection(),r=t.getResolution();if(r===void 0||!s)throw console.assert(!1,"View not ready"),new Error("View not ready");let o=e.getSource();o instanceof yu&&(o=o.getSource()),console.assert(o instanceof eo);const l=o.getFeatures(),a=new aT(s,this.scene),h=a.context;for(let c=0;c<l.length;++c){const u=l[c];if(!u)continue;const d=e.getStyleFunction(),f=this.computePlainStyle(e,u,d,r);if(!f||!f.length)continue;let g=null;for(let m=0;m<f.length;m++){const _=this.olFeatureToCesium(e,u,f[m],h);if(_){if(!g)g=_;else if(_){let p=0,y;for(;y=_.get(p);)g.add(y),p++}}}g&&(n[et(u)]=g,a.getRootPrimitive().add(g))}return a}convert(e,t,n,s){const r=t.getProjection(),o=t.getResolution();if(o==null||!r)return null;const l=e.getStyleFunction(),a=this.computePlainStyle(e,n,l,o);if(!a||!a.length)return null;s.projection=r;let h=null;for(let c=0;c<a.length;c++){const u=this.olFeatureToCesium(e,n,a[c],s);if(!h)h=u;else if(u){let d=0,f;for(;f=u.get(d);)h.add(f),d++}}return h}}function hT(i){i.length<2&&(i=[1,1]);const e=i.length%2===0?i:[...i,...i],n=e.reduce((r,o)=>r+o,0)/16;let s=e.map((r,o)=>{const l=o%2===0?"1":"0";let a=Math.round(r/n);return o===0&&a===0&&(a=1),l.repeat(a)}).join("");return s.length<16?s=s.padEnd(16,"0"):s.length>16&&(s=s.substring(0,16)),s[15]==="1"&&(s=s.substring(0,15)+"0"),console.assert(s.length===16),parseInt(s,2)}class uT extends ep{converter;csAllPrimitives_;constructor(e,t,n){super(e,t),this.converter=n||new cT(t),this.csAllPrimitives_=new Cesium.PrimitiveCollection,t.primitives.add(this.csAllPrimitives_),this.csAllPrimitives_.destroyPrimitives=!1}addCesiumObject(e){console.assert(e);const t=e.getRootPrimitive();t.counterpart=e,this.csAllPrimitives_.add(e.getRootPrimitive())}destroyCesiumObject(e){e.getRootPrimitive().destroy()}removeSingleCesiumObject(e,t){e.destroy(),this.csAllPrimitives_.destroyPrimitives=t,this.csAllPrimitives_.remove(e.getRootPrimitive()),this.csAllPrimitives_.destroyPrimitives=!1}removeAllCesiumObjects(e){if(this.csAllPrimitives_.destroyPrimitives=e,e)for(let t=0;t<this.csAllPrimitives_.length;++t)this.csAllPrimitives_.get(t).counterpart.destroy();this.csAllPrimitives_.removeAll(),this.csAllPrimitives_.destroyPrimitives=!1}updateLayerVisibility(e,t){let n=!0;[e.layer].concat(e.parents).forEach(s=>{const r=s.getVisible();r!==void 0?n=n&&r:n=!1}),t.show=n}createSingleLayerCounterparts(e){const t=e.layer;if(!(t instanceof B_)||t instanceof Cu)return null;console.assert(t instanceof Js);let n=t.getSource();if(n instanceof yu&&(n=n.getSource()),!n)return null;console.assert(n instanceof eo),console.assert(this.view);const s=this.view,r={},o=this.converter.olVectorLayerToCesium(t,s,r),l=o.getRootPrimitive(),a=o.olListenKeys;[e.layer].concat(e.parents).forEach(u=>{a.push(u.on("change:visible",()=>{this.updateLayerVisibility(e,l)}))}),this.updateLayerVisibility(e,l);const h=u=>{const d=o.context,f=this.converter.convert(t,s,u,d);f&&(r[et(u)]=f,l.add(f))},c=u=>{const d=et(u),f=o.context,g=f.featureToCesiumMap[d];g&&(delete f.featureToCesiumMap[d],g.forEach(_=>{_ instanceof Cesium.Billboard&&f.billboards.remove(_)}));const m=r[d];delete r[d],m&&l.remove(m)};return a.push(n.on("addfeature",u=>{console.assert(u.feature),h(u.feature)})),a.push(n.on("removefeature",u=>{console.assert(u.feature),c(u.feature)})),a.push(n.on("changefeature",u=>{const d=u.feature;console.assert(d),c(d),h(d)})),o?[o]:null}}const ht={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class dT extends di{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+ox,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(ht.ELEMENT,this.handleElementChanged),this.addChangeListener(ht.MAP,this.handleMapChanged),this.addChangeListener(ht.OFFSET,this.handleOffsetChanged),this.addChangeListener(ht.POSITION,this.handlePositionChanged),this.addChangeListener(ht.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(ht.ELEMENT)}getId(){return this.id}getMap(){return this.get(ht.MAP)||null}getOffset(){return this.get(ht.OFFSET)}getPosition(){return this.get(ht.POSITION)}getPositioning(){return this.get(ht.POSITIONING)}handleElementChanged(){qm(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),Ne(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Ee(e,Vi.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(ht.ELEMENT,e)}setMap(e){this.set(ht.MAP,e)}setOffset(e){this.set(ht.OFFSET,e)}setPosition(e){this.set(ht.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(ht.POSITION))return;const n=this.getRect(t.getTargetElement(),t.getSize()),s=this.getElement(),r=this.getRect(s,[ax(s),cx(s)]);e=e||{};const o=e.margin===void 0?20:e.margin;if(!yi(n,r)){const l=r[0]-n[0],a=n[2]-r[2],h=r[1]-n[1],c=n[3]-r[3],u=[0,0];if(l<0?u[0]=l-o:a<0&&(u[0]=Math.abs(a)+o),h<0?u[1]=h-o:c<0&&(u[1]=Math.abs(c)+o),u[0]!==0||u[1]!==0){const d=t.getView().getCenterInternal(),f=t.getPixelFromCoordinateInternal(d);if(!f)return;const g=[f[0]+u[0],f[1]+u[1]],m=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(g),duration:m.duration,easing:m.easing})}}}getRect(e,t){const n=e.getBoundingClientRect(),s=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[s,r,s+t[0],r+t[1]]}setPositioning(e){this.set(ht.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const n=e.getPixelFromCoordinate(t),s=e.getSize();this.updateRenderedPosition(n,s)}updateRenderedPosition(e,t){const n=this.element.style,s=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const o=`${e[0]+s[0]}px`,l=`${e[1]+s[1]}px`;let a="0%",h="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?a="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(a="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?h="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(h="-50%");const c=`translate(${a}, ${h}) translate(${o}, ${l})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,n.transform=c)}getOptions(){return this.options}}function fT(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function gT(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function ip(i,e){const t=i.cloneNode();i.nodeName==="CANVAS"&&t.getContext("2d").drawImage(i,0,0),e&&e.appendChild(t),i.nodeType!==Node.TEXT_NODE&&t.addEventListener("click",s=>{i.dispatchEvent(new MouseEvent("click",s)),s.stopPropagation()});const n=i.childNodes;for(let s=0;s<n.length;s++)n[s]&&ip(n[s],t);return t}class mT extends dT{scenePostRenderListenerRemover_=null;scene_;synchronizer_;parent_;positionWGS84_;observer_;attributeObserver_=[];listenerKeys_;constructor(e){const t=e.parent;super(t.getOptions()),this.scene_=e.scene,this.synchronizer_=e.synchronizer,this.parent_=t,this.positionWGS84_=void 0,this.observer_=new MutationObserver(this.handleElementChanged.bind(this)),this.attributeObserver_=[],this.listenerKeys_=[];const n=s=>this.setPropertyFromEvent_(s);this.listenerKeys_.push(this.parent_.on("change:element",n)),this.listenerKeys_.push(this.parent_.on("change:offset",n)),this.listenerKeys_.push(this.parent_.on("change:position",n)),this.listenerKeys_.push(this.parent_.on("change:positioning",n)),this.setProperties(this.parent_.getProperties()),this.handleMapChanged(),this.handleElementChanged(),this.handlePositionChanged()}observeTarget_(e){if(this.observer_){this.observer_.disconnect(),this.observer_.observe(e,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),this.attributeObserver_.forEach(t=>{t.disconnect()}),this.attributeObserver_.length=0;for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if(n.nodeType===1){const s=new MutationObserver(this.handleElementChanged.bind(this));s.observe(n,{attributes:!0,subtree:!0}),this.attributeObserver_.push(s)}}}}setPropertyFromEvent_(e){e.target&&e.key&&this.set(e.key,e.target.get(e.key))}getScene(){return this.scene_}handleMapChanged(){this.scenePostRenderListenerRemover_&&(this.scenePostRenderListenerRemover_(),fT(this.element)),this.scenePostRenderListenerRemover_=null;const e=this.getScene();if(e){this.scenePostRenderListenerRemover_=e.postRender.addEventListener(this.updatePixelPosition.bind(this)),this.updatePixelPosition();const t=this.stopEvent?this.synchronizer_.getOverlayContainerStopEvent():this.synchronizer_.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element)}}handlePositionChanged(){if(!this.parent_)return;const e=this.getPosition();if(e){const t=this.parent_.getMap().getView().getProjection();this.positionWGS84_=qs(e,t,"EPSG:4326")}else this.positionWGS84_=void 0;this.updatePixelPosition()}handleElementChanged(){gT(this.element);const e=this.getElement();if(e&&e.parentNode&&e.parentNode.childNodes)for(const t of Array.from(e.parentNode.childNodes)){const n=ip(t,null);this.element.appendChild(n)}e.parentNode&&this.observeTarget_(e.parentNode)}updatePixelPosition(){const e=this.positionWGS84_;if(!this.scene_||!e){this.setVisible(!1);return}let t=0;if(e.length===2){const u=this.scene_.globe.getHeight(Cesium.Cartographic.fromDegrees(e[0],e[1]));u&&this.scene_.globe.tilesLoaded&&(e[2]=u),u&&(t=u)}else t=e[2];const n=Cesium.Cartesian3.fromDegrees(e[0],e[1],t),s=this.scene_.camera,r=new Cesium.BoundingSphere(new Cesium.Cartesian3,6356752);if(!new Cesium.Occluder(r,s.position).isPointVisible(n)){this.setVisible(!1);return}if(s.frustum.computeCullingVolume(s.position,s.direction,s.up).computeVisibility(new Cesium.BoundingSphere(n))!==1){this.setVisible(!1);return}this.setVisible(!0);const a=this.scene_.cartesianToCanvasCoordinates(n),h=[a.x,a.y],c=[this.scene_.canvas.width,this.scene_.canvas.height];this.updateRenderedPosition(h,c)}destroy(){this.scenePostRenderListenerRemover_&&this.scenePostRenderListenerRemover_(),this.observer_&&this.observer_.disconnect(),Qt(this.listenerKeys_),this.listenerKeys_.splice(0),"removeNode"in this.element?this.element.removeNode(!0):this.element.remove(),this.element=null}}class _T{map;scene;overlayCollection_;overlayContainerStopEvent_;overlayContainer_;overlayMap_=new Map;overlayEvents=["click","dblclick","mousedown","touchstart","pointerdown","mousewheel","wheel"];listenerKeys_=[];constructor(e,t){this.map=e,this.scene=t,this.map=e,this.overlayCollection_=this.map.getOverlays(),this.scene=t,this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.overlayEvents.forEach(n=>{this.overlayContainerStopEvent_.addEventListener(n,s=>s.stopPropagation())}),this.scene.canvas.parentElement.appendChild(this.overlayContainerStopEvent_),this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.scene.canvas.parentElement.appendChild(this.overlayContainer_)}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOverlayContainer(){return this.overlayContainer_}synchronize(){this.destroyAll(),this.overlayCollection_.forEach(e=>{this.addOverlay(e)}),this.listenerKeys_.push(this.overlayCollection_.on("add",e=>this.addOverlay(e.element))),this.listenerKeys_.push(this.overlayCollection_.on("remove",e=>this.removeOverlay(e.element)))}addOverlay(e){if(!e)return;const t=new mT({scene:this.scene,synchronizer:this,parent:e});this.overlayMap_.set(et(e),t)}removeOverlay(e){const t=et(e),n=this.overlayMap_.get(t);n&&(n.destroy(),this.overlayMap_.delete(t))}destroyAll(){this.overlayMap_.forEach(e=>{e.destroy()}),this.overlayMap_.clear(),Qt(this.listenerKeys_),this.listenerKeys_.length=0}}const dc={DONE:0,PENDING:1,FAILED:2};class vu{autoRenderLoop_=null;map_;time_;to4326Transform_;resolutionScale_=1;canvasClientWidth_=0;canvasClientHeight_=0;resolutionScaleChanged_=!0;container_;isOverMap_;canvas_;enabled_=!1;pausedInteractions_=[];hiddenRootGroup_=null;scene_;camera_;globe_;dataSourceCollection_;dataSourceDisplay_;lastFrameTime_=0;renderId_;targetFrameRate_=Number.POSITIVE_INFINITY;blockCesiumRendering_=!1;warmingUp_=!1;trackedFeature_=null;trackedEntity_=null;entityView_=null;needTrackedEntityUpdate_=!1;boundingSphereScratch_=new Cesium.BoundingSphere;synchronizers_;refresh2DAfterCameraMoveEndOnly=!1;moveEndRemoveCallback_;constructor(e){this.map_=e.map,this.time_=e.time||function(){return Cesium.JulianDate.now()},this.to4326Transform_=Ti(this.map_.getView().getProjection(),"EPSG:4326");const t="position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none;";this.container_=document.createElement("DIV");const n=document.createAttribute("style");n.value=`${t}visibility:hidden;`,this.container_.setAttributeNode(n);let s=e.target||this.map_.getViewport();if(typeof s=="string"&&(s=document.getElementById(s)),s.appendChild(this.container_),this.isOverMap_=!e.target,this.isOverMap_&&e.stopOpenLayersEventsPropagation){const c=["click","dblclick","mousedown","touchstart","pointerdown","mousewheel","wheel"];for(let u=0,d=c.length;u<d;++u)this.container_.addEventListener(c[u],f=>f.stopPropagation())}this.canvas_=document.createElement("canvas");const r=document.createAttribute("style");r.value=t,this.canvas_.setAttributeNode(r),Jc()&&(this.canvas_.style.imageRendering=vR()),this.canvas_.oncontextmenu=function(){return!1},this.canvas_.onselectstart=function(){return!1},this.container_.appendChild(this.canvas_);const o=e.sceneOptions!==void 0?{...e.sceneOptions,canvas:this.canvas_,scene3DOnly:!0}:{canvas:this.canvas_,scene3DOnly:!0};this.scene_=new Cesium.Scene(o);const l=this.scene_.screenSpaceCameraController;Array.isArray(l.tiltEventTypes)?(l.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.SHIFT}),l.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.ALT})):console.log("sscc is not an array"),l.enableLook=!1,this.scene_.camera.constrainedAxis=Cesium.Cartesian3.UNIT_Z,this.camera_=new lT(this.scene_,this.map_),this.globe_=new Cesium.Globe(Cesium.Ellipsoid.WGS84),this.globe_.baseColor=Cesium.Color.WHITE,this.scene_.globe=this.globe_,this.scene_.skyAtmosphere=new Cesium.SkyAtmosphere;const a=new Cesium.SingleTileImageryProvider({tileHeight:1,tileWidth:1,url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",rectangle:Cesium.Rectangle.fromDegrees(0,0,1,1)});this.globe_.imageryLayers.addImageryProvider(a,0),this.dataSourceCollection_=new Cesium.DataSourceCollection,this.dataSourceDisplay_=new Cesium.DataSourceDisplay({scene:this.scene_,dataSourceCollection:this.dataSourceCollection_}),this.synchronizers_=e.createSynchronizers?e.createSynchronizers(this.map_,this.scene_,this.dataSourceCollection_):[new tp(this.map_,this.scene_),new uT(this.map_,this.scene_),new _T(this.map_,this.scene_)],this.handleResize_();for(let c=this.synchronizers_.length-1;c>=0;--c)this.synchronizers_[c].synchronize();new Cesium.EventHelper().add(this.scene_.postRender,vu.prototype.updateTrackedEntity_,this),this.moveEndRemoveCallback_=this.scene_.camera.moveEnd.addEventListener(()=>{this.refresh2DAfterCameraMoveEndOnly&&this.camera_.checkCameraChange()})}destroy(){cancelAnimationFrame(this.renderId_),this.renderId_=void 0,this.synchronizers_.forEach(e=>e.destroyAll()),this.camera_.destroy(),this.scene_.destroy(),this.scene_._postRender=null,this.moveEndRemoveCallback_(),this.container_.remove()}render_(){this.renderId_!==void 0&&(cancelAnimationFrame(this.renderId_),this.renderId_=void 0),(this.enabled_||this.warmingUp_)&&!this.blockCesiumRendering_&&(this.renderId_=requestAnimationFrame(this.onAnimationFrame_.bind(this)))}onAnimationFrame_(e){this.renderId_=void 0;const t=1e3/this.targetFrameRate_;if(e-this.lastFrameTime_<t){this.render_();return}this.lastFrameTime_=e;const s=this.time_();if(this.scene_.initializeFrame(),this.handleResize_(),this.dataSourceDisplay_.update(s),this.entityView_){const r=this.trackedEntity_;this.dataSourceDisplay_.getBoundingSphere(r,!1,this.boundingSphereScratch_)===dc.DONE&&(this.boundingSphereScratch_.radius=1,this.entityView_.update(s,this.boundingSphereScratch_))}this.scene_.render(s),this.refresh2DAfterCameraMoveEndOnly||this.camera_.checkCameraChange(),this.render_()}updateTrackedEntity_(){if(!this.needTrackedEntityUpdate_)return;const e=this.trackedEntity_,t=this.scene_,n=this.dataSourceDisplay_.getBoundingSphere(e,!1,this.boundingSphereScratch_);if(n===dc.PENDING)return;t.screenSpaceCameraController.enableTilt=!1;const s=n!==dc.FAILED?this.boundingSphereScratch_:void 0;s&&(s.radius=1),this.entityView_=new Cesium.EntityView(e,t,t.mapProjection.ellipsoid),this.entityView_.update(this.time_(),s),this.needTrackedEntityUpdate_=!1}handleResize_(){let e=this.canvas_.clientWidth,t=this.canvas_.clientHeight;if(e===0||t===0||e===this.canvasClientWidth_&&t===this.canvasClientHeight_&&!this.resolutionScaleChanged_)return;let n=this.resolutionScale_;Jc()||(n*=window.devicePixelRatio||1),this.resolutionScaleChanged_=!1,this.canvasClientWidth_=e,this.canvasClientHeight_=t,e*=n,t*=n,this.canvas_.width=e,this.canvas_.height=t,this.scene_.camera.frustum.aspectRatio=e/t}getCamera(){return this.camera_}getOlMap(){return this.map_}getOlView(){const e=this.map_.getView();return console.assert(e),e}getCesiumScene(){return this.scene_}getDataSources(){return this.dataSourceCollection_}getDataSourceDisplay(){return this.dataSourceDisplay_}getEnabled(){return this.enabled_}setEnabled(e){if(this.enabled_===e)return;this.enabled_=e,this.container_.style.visibility=this.enabled_?"visible":"hidden";let t;if(this.enabled_){if(this.throwOnUnitializedMap_(),this.isOverMap_){t=this.map_.getInteractions(),t.forEach((s,r,o)=>{this.pausedInteractions_.push(s)}),t.clear(),this.map_.addInteraction=s=>this.pausedInteractions_.push(s),this.map_.removeInteraction=s=>{let r=!1;return this.pausedInteractions_=this.pausedInteractions_.filter(o=>{const l=o!==s;return r||(r=l),l}),r?s:void 0};const n=this.map_.getLayerGroup();n.getVisible()&&(this.hiddenRootGroup_=n,this.hiddenRootGroup_.setVisible(!1)),this.map_.getOverlayContainer().classList.add("olcs-hideoverlay")}this.camera_.readFromView(),this.render_()}else this.isOverMap_&&(t=this.map_.getInteractions(),this.pausedInteractions_.forEach(n=>{t.push(n)}),this.pausedInteractions_.length=0,this.map_.addInteraction=n=>this.map_.getInteractions().push(n),this.map_.removeInteraction=n=>this.map_.getInteractions().remove(n),this.map_.getOverlayContainer().classList.remove("olcs-hideoverlay"),this.hiddenRootGroup_&&(this.hiddenRootGroup_.setVisible(!0),this.hiddenRootGroup_=null)),this.camera_.updateView()}warmUp(e,t){if(this.enabled_)return;this.throwOnUnitializedMap_(),this.camera_.readFromView();const n=this.globe_.ellipsoid,s=this.scene_.camera,r=n.cartesianToCartographic(s.position);r.height<e&&(r.height=e,s.position=n.cartographicToCartesian(r)),this.warmingUp_=!0,this.render_(),setTimeout(()=>{this.warmingUp_=!1},t)}setBlockCesiumRendering(e){this.blockCesiumRendering_!==e&&(this.blockCesiumRendering_=e,this.render_())}enableAutoRenderLoop(){this.autoRenderLoop_||(this.autoRenderLoop_=new oT(this))}getAutoRenderLoop(){return this.autoRenderLoop_}setResolutionScale(e){e=Math.max(0,e),e!==this.resolutionScale_&&(this.resolutionScale_=Math.max(0,e),this.resolutionScaleChanged_=!0,this.autoRenderLoop_&&this.autoRenderLoop_.restartRenderLoop())}setTargetFrameRate(e){this.targetFrameRate_!==e&&(this.targetFrameRate_=e,this.render_())}setRefresh2DAfterCameraMoveEndOnly(e){this.refresh2DAfterCameraMoveEndOnly=e}throwOnUnitializedMap_(){const t=this.map_.getView(),n=t.getCenter();if(!t.isDef()||isNaN(n[0])||isNaN(n[1]))throw new Error(`The OpenLayers map is not properly initialized: ${n} / ${t.getResolution()}`)}get trackedFeature(){return this.trackedFeature_}set trackedFeature(e){if(this.trackedFeature_!==e){const t=this.scene_;if(!e||!e.getGeometry()){this.needTrackedEntityUpdate_=!1,t.screenSpaceCameraController.enableTilt=!0,this.trackedEntity_&&this.dataSourceDisplay_.defaultDataSource.entities.remove(this.trackedEntity_),this.trackedEntity_=null,this.trackedFeature_=null,this.entityView_=null,t.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);return}this.trackedFeature_=e,this.needTrackedEntityUpdate_=!0;const n=this.to4326Transform_,s=function(){const o=e.getGeometry();console.assert(o instanceof Ii);const l=o instanceof Ii?o.getCoordinates():[],a=n(l,void 0,l.length);return Is(a)},r={position:new Cesium.CallbackProperty((o,l)=>s(),!1),point:{pixelSize:1,color:Cesium.Color.TRANSPARENT}};this.trackedEntity_=this.dataSourceDisplay_.defaultDataSource.entities.add(r)}}}const pT=15e3,yT=16,CT={__name:"Map",setup(i){const{isDark:e}=xh(),t={minLon:70,minLat:15,maxLon:140,maxLat:60};(()=>{const S=Ao([t.minLon,t.minLat]),O=Ao([t.maxLon,t.maxLat]);return[S[0],S[1],O[0],O[1]]})();const{showLoading:n,hideLoading:s}=wh(),r=BC(),o=rt(!1),l=rt("");rt(0);const a=rt(null),h=rt(null);let c=null,u=null,d=!1,f=null,g=null,m=null,_=null,p=null,y=null,v=null,C=[50,50];const x=()=>new Promise(S=>{const O=new Image;O.onload=()=>{v=O,C=[O.naturalWidth||50,O.naturalHeight||50],S()},O.onerror=()=>{S()},O.src=No}),T=Cesium.Color.WHITE.withAlpha(.55),I=S=>{if(!S||!u)return;y||(y=new Cesium.CustomDataSource("posts-3d-markers"),u.getDataSources().add(y));const O=new Set;for(let N=0;N<ac.length;N+=1){const z=ac[N];if(!z||!z.location||z.location.lng==null||z.location.lat==null)continue;const V=String(z.id||"");if(!V)continue;const J=`post-${V}`;O.add(J);const se=Number(z.location.lng),ae=Number(z.location.lat),j=Cesium.Cartesian3.fromDegrees(se,ae,pT),xe=Cesium.Cartesian3.fromDegrees(se,ae,0);let ye=y.entities.getById(J);ye||(ye=y.entities.add({id:J})),ye.position=new Cesium.ConstantPositionProperty(j),ye.billboard=new Cesium.BillboardGraphics({image:No,scale:.5,verticalOrigin:Cesium.VerticalOrigin.CENTER,heightReference:Cesium.HeightReference.NONE,color:e.value?Cesium.Color.WHITE:Cesium.Color.BLACK}),ye.label=new Cesium.LabelGraphics({text:String(z.title||""),font:'bold 12px "PingFang SC", "Microsoft YaHei", sans-serif',fillColor:e.value?Cesium.Color.WHITE:Cesium.Color.BLACK,outlineColor:e.value?Cesium.Color.BLACK:Cesium.Color.WHITE,outlineWidth:4,style:Cesium.LabelStyle.FILL_AND_OUTLINE,verticalOrigin:Cesium.VerticalOrigin.TOP,heightReference:Cesium.HeightReference.NONE,pixelOffset:new Cesium.Cartesian2(0,28)}),ye.polyline=new Cesium.PolylineGraphics({positions:[j,xe],width:1.2,material:new Cesium.PolylineDashMaterialProperty({color:e.value?T:Cesium.Color.BLACK.withAlpha(.55),dashLength:yT}),arcType:Cesium.ArcType.NONE}),ye.properties=new Cesium.PropertyBag({postId:V})}const U=y.entities.values.slice();for(let N=0;N<U.length;N+=1){const z=U[N];z&&typeof z.id=="string"&&!O.has(z.id)&&y.entities.remove(z)}S.requestRender()};let L={};const b=S=>{const O=S.get("features").length;let U=L[O];if(!U){if(O>1)U=new Ri({image:new In({...v?{img:v,imgSize:C}:{src:No},scale:.6,anchor:[.5,.5],color:e.value?void 0:"#000000"}),text:new $r({text:O.toString(),fill:new Sn({color:e.value?"#272636":"#ffffff"}),stroke:new rs({color:e.value?"#fff":"#000000",width:2}),font:"bold 15px sans-serif",offsetY:2})});else{const z=S.get("features")[0].get("name");U=new Ri({image:new In({...v?{img:v,imgSize:C}:{src:No},scale:.5,anchor:[.5,.5],color:e.value?void 0:"#000000"}),text:new $r({text:z,font:'bold 12px "PingFang SC", "Microsoft YaHei", sans-serif',offsetY:24,fill:new Sn({color:e.value?"#fff":"#000"}),stroke:new rs({color:e.value?"rgba(0,0,0,1)":"rgba(255,255,255,1)",width:4})})})}L[O]=U}return U},G=S=>{if(m&&_&&(m.setVisible(S),_.setVisible(!S),L={},g&&g.changed()),u){const O=u.getCesiumScene?.();if(O){const U=S?Cesium.Color.BLACK:Cesium.Color.WHITE;O.backgroundColor=U,O.globe&&(O.globe.baseColor=U),O.requestRender?.()}}y&&y.entities.values.forEach(U=>{U.billboard&&(U.billboard.color=S?Cesium.Color.WHITE:Cesium.Color.BLACK),U.label&&(S?(U.label.fillColor=Cesium.Color.WHITE,U.label.outlineColor=Cesium.Color.BLACK):(U.label.fillColor=Cesium.Color.BLACK,U.label.outlineColor=Cesium.Color.WHITE)),U.polyline&&(U.polyline.material.color=S?T:Cesium.Color.BLACK.withAlpha(.55))})};ni(e,S=>{G(S)}),Gl(()=>{sessionStorage.getItem("hasShownMapTip")||setTimeout(()=>{o.value=!0,l.value="...",sessionStorage.setItem("hasShownMapTip","true")},500),n("..."),f=()=>{d||(d=!0,requestAnimationFrame(()=>{d=!1;try{c?.updateSize()}catch{}try{u?.getCesiumScene?.()?.requestRender?.()}catch{}}))},window.addEventListener("resize",f),window.addEventListener("orientationchange",f),setTimeout(async()=>{await x(),W(),A()},100)}),Vl(()=>{if(f&&(window.removeEventListener("resize",f),window.removeEventListener("orientationchange",f),f=null),p){try{p.destroy()}catch(S){console.warn("Cesium handler cleanup warning:",S)}p=null}if(u&&y){try{u.getDataSources().remove(y,!0)}catch(S){console.warn("Cesium posts datasource cleanup warning:",S)}y=null}if(u){try{u.setEnabled(!1)}catch(S){console.warn("OLCesium cleanup warning:",S)}u=null}if(c){try{c.setTarget(null)}catch(S){console.warn("OLMap cleanup warning:",S)}c=null}});const W=()=>{m=new Yc({source:new Ef({url:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",crossOrigin:"anonymous"}),visible:e.value,zIndex:0}),_=new Yc({source:new Ef({url:"https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",crossOrigin:"anonymous"}),visible:!e.value,zIndex:0});const S=new eo;ac.forEach(U=>{if(U.location&&U.location.lng&&U.location.lat){const N=new yo({geometry:new Ii(Ao([U.location.lng,U.location.lat])),name:U.title,id:U.id});S.addFeature(N)}});const O=new yu({distance:40,source:S});g=new B_({source:O,style:b,zIndex:10}),g.set("olcs_skip",!0),c=new e1({target:a.value,layers:[m,_,g],view:new pi({center:Ao([105,35]),zoom:4}),controls:[]}),c.on("click",U=>{const N=c.forEachFeatureAtPixel(U.pixel,z=>z);if(N){const z=N.get("features");if(z&&z.length>0)if(z.length>1){const V=wt();z.forEach(J=>Em(V,J.getGeometry().getExtent())),c.getView().fit(V,{duration:500,padding:[100,100,100,100]})}else{const J=z[0].get("id");J&&r.push(`/blog/${J}`)}}}),c.on("pointermove",U=>{const N=c.hasFeatureAtPixel(U.pixel),z=c.getTargetElement();z&&(z.style.cursor=N?"pointer":"")}),c.renderSync()},A=()=>{window.Cesium=Cesium,u=new vu({map:c,target:h.value,stopOpenLayersRendering:!1,createSynchronizers:(V,J)=>[new tp(V,J)]});const S=u.getCesiumScene();p=new Cesium.ScreenSpaceEventHandler(S.canvas),p.setInputAction(V=>{const J=S.drillPick(V.endPosition,10);let se=!1;for(let ae=0;ae<J.length;ae+=1){const xe=J[ae]?.id;if(xe&&xe.properties&&xe.properties.postId){se=!0;break}}h.value.style.cursor=se?"pointer":""},Cesium.ScreenSpaceEventType.MOUSE_MOVE),p.setInputAction(V=>{const J=S.drillPick(V.position,10);let se=null;for(let xe=0;xe<J.length;xe+=1){const ye=J[xe]?.id;if(ye&&ye.properties&&ye.properties.postId){se=ye;break}}if(!se)return;const ae=Cesium.JulianDate.now(),j=se.properties.postId.getValue(ae);j&&r.push(`/blog/${j}`)},Cesium.ScreenSpaceEventType.LEFT_CLICK),S.globe.baseColor=e.value?Cesium.Color.BLACK:Cesium.Color.WHITE,S.backgroundColor=e.value?Cesium.Color.BLACK:Cesium.Color.WHITE,S.highDynamicRangeSupported&&(S.highDynamicRange=!1),S.postProcessStages.fxaa.enabled=!0,S.skyAtmosphere&&(S.skyAtmosphere.show=!1),S.moon&&(S.moon.show=!1),S.fog&&(S.fog.enabled=!1),S.globe.enableLighting=!1,S.globe.showGroundAtmosphere=!1,S.imageryLayers,S.frameState&&S.frameState.creditDisplay&&S.frameState.creditDisplay.container&&(S.frameState.creditDisplay.container.style.display="none"),u.setEnabled(!0);const O=Cesium.Cartesian3.fromDegrees(105,35),U=Cesium.Math.toRadians(0),N=Cesium.Math.toRadians(-30),z=6e6;S.camera.lookAt(O,new Cesium.HeadingPitchRange(U,N,z)),S.camera.lookAtTransform(Cesium.Matrix4.IDENTITY),u.setTargetFrameRate(30),setTimeout(()=>{let V=0;const J=()=>{V+=1,S.requestRender(),I(S),V<8&&setTimeout(J,250)};J()},500),s()};return(S,O)=>(pe(),Me("div",{class:Qn(["digital-twin-home",{"dark-mode":Xe(e)}])},[ee("div",{id:"cesium-container",ref_key:"cesiumContainer",ref:h},null,512),ee("div",{id:"ol-container",ref_key:"olContainer",ref:a},null,512),O[1]||(O[1]=Kg('<svg class="split-line-svg" data-v-095edc51><defs data-v-095edc51><linearGradient id="simple-gradient" gradientUnits="userSpaceOnUse" x1="55%" y1="0%" x2="45%" y2="100%" data-v-095edc51><stop offset="0%" style="stop-color:#fff;stop-opacity:0;" data-v-095edc51></stop><stop offset="30%" style="stop-color:var(--accent);stop-opacity:0.1;" data-v-095edc51></stop><stop offset="50%" style="stop-color:var(--accent);stop-opacity:0.5;" data-v-095edc51></stop><stop offset="70%" style="stop-color:var(--accent);stop-opacity:0.1;" data-v-095edc51></stop><stop offset="100%" style="stop-color:#fff;stop-opacity:0;" data-v-095edc51></stop></linearGradient><linearGradient id="simple-gradient-horizontal" gradientUnits="userSpaceOnUse" x1="0%" y1="50%" x2="100%" y2="50%" data-v-095edc51><stop offset="0%" style="stop-color:#fff;stop-opacity:0;" data-v-095edc51></stop><stop offset="30%" style="stop-color:var(--accent);stop-opacity:0.1;" data-v-095edc51></stop><stop offset="50%" style="stop-color:var(--accent);stop-opacity:0.5;" data-v-095edc51></stop><stop offset="70%" style="stop-color:var(--accent);stop-opacity:0.1;" data-v-095edc51></stop><stop offset="100%" style="stop-color:#fff;stop-opacity:0;" data-v-095edc51></stop></linearGradient></defs><line x1="55%" y1="0%" x2="45%" y2="100%" class="split-path-diagonal" data-v-095edc51></line><line x1="0%" y1="50%" x2="100%" y2="50%" class="split-path-horizontal" data-v-095edc51></line></svg>',1)),Ve(Sv,{visible:o.value,"onUpdate:visible":O[0]||(O[0]=U=>o.value=U),message:l.value,position:"center",duration:8e3,type:"info"},null,8,["visible","message"])],2))}},vT=Ys(CT,[["__scopeId","data-v-095edc51"]]),ET=[{path:"/",name:"Map",component:vT},{path:"/blog",name:"BlogList",component:()=>vo(()=>import("./BlogList-JSHCovhm.js"),__vite__mapDeps([0,1,2]))},{path:"/blog/:id",name:"BlogPost",component:()=>vo(()=>import("./BlogPost-pkj7PhA8.js"),__vite__mapDeps([3,1,4]))},{path:"/about",name:"About",component:()=>vo(()=>import("./About-fMsidJYd.js"),__vite__mapDeps([5,1,6]))},{path:"/:pathMatch(.*)*",name:"NotFound",component:()=>vo(()=>Promise.resolve().then(()=>yv),void 0)}],_a=zC({history:CC(),routes:ET}),{showLoading:xT,hideLoading:wT}=wh();_a.beforeEach((i,e,t)=>{i.name!=="Map"&&i.path!==e.path&&xT(),t()});_a.afterEach(i=>{i.name!=="Map"&&setTimeout(()=>{wT()},300)});const RT=["innerHTML"],TT={__name:"Mermaid",props:{code:{type:String,required:!0}},setup(i){const e=i,t=rt(""),{isDark:n}=xh(),s=o=>{Ru.initialize({startOnLoad:!1,theme:o?"dark":"default",securityLevel:"loose"})};Gl(async()=>{s(n.value),await r()}),ni(()=>e.code,async()=>{await r()}),ni(n,async o=>{s(o),await r()});async function r(){if(e.code)try{const o=decodeURIComponent(e.code),l=`mermaid-${Math.random().toString(36).substr(2,9)}`,{svg:a}=await Ru.render(l,o);t.value=a}catch(o){console.error("Mermaid render error:",o),t.value=`<div class="mermaid-error" style="color: red; padding: 10px; border: 1px solid red;">
      Mermaid render error: ${o.message}
    </div>`}}return(o,l)=>(pe(),Me("div",{class:"mermaid-container",innerHTML:t.value},null,8,RT))}},ST=Ys(TT,[["__scopeId","data-v-b1c9bc81"]]),Eu=P0(Cv);Eu.component("Mermaid",ST);const{setAppError:pa}=Rh();Eu.config.errorHandler=i=>{pa(i)};window.addEventListener("error",i=>{pa(i?.error||new Error("Window error"))});window.addEventListener("unhandledrejection",i=>{pa(i?.reason||new Error("Unhandled promise rejection"))});_a.onError(i=>{pa(i)});Eu.use(_a).mount("#app");export{He as F,rl as T,Ys as _,Kg as a,Ve as b,Me as c,ee as d,Bn as e,rt as f,xt as g,Gl as h,Vl as i,Jt as j,So as k,Gs as l,ug as m,Qn as n,pe as o,ac as p,Xe as q,mh as r,bT as s,ji as t,hm as u,AT as v,Xp as w,u0 as x,b0 as y,Sv as z};
